<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 16
<br>
Библиотеки классов и ActiveX-компоненты</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl16.html#1">Использование библиотек классов </a>
  <li><a href="gl16.html#2">Панель инструментов Form Controls </a>
  <li><a href="gl16.html#3">Галерея компонентов</a>
  <li><a href="gl16.html#4">Class Browser</a>
  <li><a href="gl16.html#5">Использование ActiveX-компонентов в форме</a>
  <li><a href="gl16.html#6">Отображение ActiveX-компонентов на панели инструментов Form Controls </a>
  <li><a href="gl16.html#7">Размещение ActiveX-компонентов в форме </a>
  <li><a href="gl16.html#8">Связь ActiveX-компонентов с базой данных</a>
  <li><a href="gl16.html#9">Использование календаря в форме </a>
  <li><a href="gl16.html#10">Использование браузера объектов </a>
</ul>


<P>
В предыдущих главах мы рассмотрели использование стандартных элементов управления, которые представляют лишь небольшую часть доступных элементов управления. Множество разнообразных элементов управления находится в библиотеках классов, объединенных общим названием Visual FoxPro Foundation Classes, которые входят в комплект поставки Visual FoxPro. Кроме библиотеки Foundation Classes, вы можете также использовать библиотеки классов, которые разрабатывают сторонние фирмы. 
</P>
<P>
В последнее время широкое распространение получают ActiveX-компоненты, которые представляют собой полнофункциональные элементы управления. Вы можете размещать их так же, как и обычные элементы управления, задавать свойства и обрабатывать события. 
</P>
<P>
В процессе разработки приложения вы можете создавать свои библиотеки классов и размещать в форме собственные элементы управления. 
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Использование библиотек классов </font> 
</P>
<P>
Применение внешних библиотек классов не только облегчает разработку приложения, но и ускоряет процесс. Для размещения в форме объектов библиотек вы можете использовать панель инструментов Form Controls (Элементы управления формы), Галерею компонентов и Class Browser (Обзор классов). 
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">Панель инструментов Form Controls </font> 
</P>
<P>
Чтобы использовать панель инструментов Form Controls (Элементы управления формы), вы должны разместить на ней объекты внешней библиотеки. Для этого выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку View Classes (Просмотр классов) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Появившееся меню содержит команду Add (Добавить) и список библиотек классов. Для добавления внешней библиотеки нажмите кнопку Add (Добавить). 
  </li>
  <li>На экране открывается диалоговое окно Open (Открыть) (рис. 16.1), позволяющее выбрать необходимую библиотеку классов. 
  </li>
  <li>Используя раскрывающийся список Папка, найдите папку Classes (Классы), содержащую библиотеки классов Visual FoxPro. 
  </li>
  <li>Выберите, например, библиотеку классов buttons (Кнопки), входящую в поставку Visual FoxPro, и нажмите кнопку Open (Открыть) диалогового окна. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Файлы библиотек классов имеют расширение VCX. </font> 
</P>
<IMG src="gl16-1.jpg" alt="gl16-1.jpg" width="431" height="356" ></IMG>
<P>
Рис. 16.1. Диалоговое окно Open для присоединения внешней библиотеки 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">После выбора библиотеки классов нажмите кнопку View Classes (Просмотр классов) на панели инструментов Form Controls (Элементы управления формы). Обратите внимание на то, что в ее меню добавился пункт с выбранной вами библиотекой классов (в данном примере Buttons (Кнопки)).
</font> 
</P>
<ol>
  <li value="6">Выберите пункт меню с наименованием добавленной вами библиотеки. На панели инструментов Form Controls (Элементы управления формы) будут размещены кнопки элементов управления выбранной библиотеки (рис. 16.2). Используя панель инструментов, вы теперь можете размещать эти объекты в форме так же, как и стандартные элементы управления. 
  </li>
</ol>
<IMG src="gl16-2.jpg" alt="gl16-2.jpg" width="461" height="466" ></IMG>
<P>
Рис. 16.2. Меню кнопки View Classes и панель инструментов, содержащая элементы управления внешней библиотеки 
</P>
<P>
Библиотека Buttons (Кнопки) содержит набор кнопок, назначение которых описано в табл. 16.1. 
</P>
<P>
Таблица 16.1. Кнопки библиотеки Buttons 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Наименование 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/133.jpg" width="18" height="16"></TD>
<TD VALIGN="TOP">
mailbtn 
</TD>
<TD VALIGN="TOP">
Размещает в форме кнопку, позволяющую передать данные таблицы по электронной почте 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/134.jpg" width="20" height="21"></TD>
<TD VALIGN="TOP">
vcr 
</TD>
<TD VALIGN="TOP">
Размещает набор кнопок перемещения по записям таблицы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/135.jpg" width="20" height="21"></TD>
<TD VALIGN="TOP">
cmdok 
</TD>
<TD VALIGN="TOP">
Размещает в форме кнопку ОК 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/136.jpg" width="20" height="21"></TD>
<TD VALIGN="TOP">
cmdHelp 
</TD>
<TD VALIGN="TOP">
Размещает в форме кнопку Help 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/137.jpg" width="20" height="21"></TD>
<TD VALIGN="TOP">
cmdCancel 
</TD>
<TD VALIGN="TOP">
Размещает в форме кнопку Cancel 
</TD>
</TR>
</TABLE>
<P>
Рассмотрим размещение этих кнопок в форме: 
</P>
<ol>
  <li>В проекте sales выберите любую из созданных ранее форм и откройте ее в конструкторе. 
  </li>
  <li>Удалите в нижней части формы кнопки перемещения по записям, созданные вами ранее. 
  </li>
  <li>Выберите объект vcr на панели инструментов Form Controls (Элементы управления формы) и поместите его на месте удаленных кнопок (рис. 16.3). 
  </li>
</ol>
<IMG src="gl16-3.jpg" alt="gl16-3.jpg" width="500" height="416" ></IMG>
<P>
Рис. 16.3. Размещение объекта vcr в форме 
</P>
<ol>
  <li value="4">Запустите форму на выполнение. Убедитесь в том, что, используя размещенные для управления таблицей кнопки, можно перемещаться по записям таблицы (рис. 16.4). 
  </li>
</ol>
<IMG src="gl16-4.jpg" alt="gl16-4.jpg" width="500" height="422" ></IMG>
<P>
Рис. 16.4. Форма с размещенным объектом vcr для перемещения по записям 
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Галерея компонентов </font> 
</P>
<P>
Галерея компонентов Visual FoxPro содержит библиотеки классов Foundation Classes (рис. 16.5), которые размещены в одноименном каталоге. Для размещения объекта выбранного класса в форме вы можете выполнить любое из следующих действий. 
</P>
<ul>
  <li>Выделить класс в окне Галереи компонентов и перенести в требуемое место формы, используя механизм &quot;перенести-и-оставить&quot;. 
  </li>
  <li>Щелкнуть правой кнопкой мыши на классе и из контекстного меню выбрать команду Add to Form (Добавить в форму) (рис. 16.6). 
  </li>
  <li>Выделить класс в окне Галереи компонентов, щелкнуть на значке Move (Перенести), расположенном в левом верхнем углу окна, и перенести выбранный класс в требуемое место формы. 
  </li>
</ul>
<IMG src="gl16-5.jpg" alt="gl16-5.jpg" width="500" height="416" ></IMG>
<P>
Рис. 16.5. Каталог Foundation Classes 
</P>
<IMG src="gl16-6.jpg" alt="gl16-6.jpg" width="500" height="447" ></IMG>
<P>
Рис. 16.6. Использование контекстного меню для размещения объекта выбранного класса в форме 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Для некоторых классов определены построители, автоматически запускаемые при размещении их в форме.
</font> 
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Class Browser </font> 
</P>
<P>
Еще одним способом размещения в форме объектов внешней библиотеки классов является применение окна Class Browser (Обзор классов) (рис. 16.7). Для его открытия выполните команду Class Browser (Обзор классов) из меню Tools (Сервис). 
</P>
<IMG src="gl16-7.jpg" alt="gl16-7.jpg" width="500" height="377" ></IMG>
<P>
Рис. 16.7. Окно Class Browser 
</P>
<P>
Для размещения в окне Class Browser (Обзор классов) библиотеки предназначены кнопки Open (Открыть) и View Additional File (Показать дополнительный файл) панели инструментов окна. При их нажатии открывается диалоговое окно Open (Открыть) (см. рис. 16.1), позволяющее открыть и разместить в Class Browser (Обзор классов) существующую библиотеку классов. 
</P>
<P>
Чтобы добавить в форму элемент управления из окна Class Browser (Обзор классов), выполните следующие действия: 
</P>
<ol>
  <li>Откройте в конструкторе форму, в которую хотите добавить объекты из библиотеки классов. 
  </li>
  <li>В окне Class Browser (Обзор классов) откройте библиотеку, содержащую классы объектов, которые вы собираетесь разместить в форме. 
  </li>
  <li>Выберите из списка требуемый класс. Значок Move (Переместить), расположенный в верхнем левом углу окна Class Browser (Обзор классов), изменит свой рисунок в соответствии со значком выбранного вами класса. 
  </li>
  <li>Установите курсор на значок Move (Переместить). </li>
  <li>Нажмите кнопку мыши и, удерживая ее нажатой, перенесите объект в форму. 
  </li>
  <li>Завершив перемещение, отпустите кнопку мыши. Результат перемещения класса кнопки в форму показан на рис. 16.8. 
  </li>
</ol>
<IMG src="gl16-8.jpg" alt="gl16-8.jpg" width="500" height="327" ></IMG>
<P>
Рис. 16.8. Размещение в форме объектов из окна Class Browser 
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Использование ActiveX-компонентов в форме </font> 
</P>
<P>
Компоненты ActiveX представляют собой 32-разрядные объекты, содержащие код и данные. В отличие от библиотек классов Visual FoxPro, ActiveX-компоненты могут создаваться с помощью различных средств разработки, например, Visual C++ или Visual Basic. Вы можете использовать ActiveX-компоненты аналогично базовым компонентам Visual FoxPro. Основным 
</P>
<P>
Преимуществом данных компонентов является их огромное количество, т. к. их разработкой занимаются многие фирмы, а также отдельные программисты. Часть этих компонентов является коммерческой продукцией, часть распространяется бесплатно. Множество компонентов включено в поставку Visual Studio и в приложение Microsoft Office. Для поиска необходимых вам компонентов вы можете использовать Интернет. 
</P>
<P>
Для формирования списка используемых при разработке ActiveX-компонентов необходимо воспользоваться диалоговым окном Options (Параметры), выполнив следующие действия: 
</P>
<ol>
  <li>Выберите в меню Tools (Сервис) команду Options (Параметры). </li>
  <li>В диалоговом окне Options (Параметры) выберите вкладку Controls (Элементы управления) (рис. 16.9). 
  </li>
  <li>Установите опцию ActiveX controls (Элементы управления ActiveX). При этом в списке Selected (Выбранные) будет отображен список всех доступных на вашем компьютере ActiveX-компонентов. 
  </li>
  <li>Установите флажки рядом с теми объектами списка Selected (Выбранные), которые хотите разместить на панели инструментов Form Controls (Элементы управления формы) и использовать для размещения в форме. 
  </li>
  <li>Нажмите кнопку ОК для закрытия диалогового окна Options (Параметры). </li>
</ol>
<IMG src="gl16-9.jpg" alt="gl16-9.jpg" width="478" height="416" ></IMG>
<P>
Рис. 16.9. Вкладка Controls диалогового окна Options 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Кнопка Add (Добавить) вкладки Controls (Элементы управления) диалогового окна Options (Параметры) предназначена для добавления новых объектов в список Selected (Выбранные). При нажатии на данную кнопку открывается диалоговое окно Open (Открыть), используя которое можно выбрать файл с ActiveX-компонентами.
</font> 
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Отображение ActiveX-компонентов на панели инструментов Form Controls
</font> 
</P>
<P>
Для отображения ActiveX-компонентов на панели инструментов Form Controls (Элементы управления формы) при создании форм выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку View Classes (Просмотр классов) на панели инструментов Form Controls (Элементы управления формы), в результате чего на экране появится меню кнопки. 
  </li>
  <li>Выберите команду ActiveX Controls (Элементы управления ActiveX) данного меню. На панели инструментов Form Controls (Элементы управления формы) будут размещены кнопки, содержащие значки выбранных вами ActiveX-компонентов в диалоговом окне Options (Параметры) (рис. 16.10). Теперь вы можете размещать данные объекты в форме обычным образом. 
  </li>
</ol>
<IMG src="gl16-10.jpg" alt="gl16-10.jpg" width="500" height="367" ></IMG>
<P>
Рис. 16.10. Панель инструментов, содержащая ActiveX-компоненты 
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Размещение ActiveX-компонентов в форме </font> 
</P>
<P>
Рассмотрим пример создания формы, содержащей две вкладки, на которых разместим такие ActiveX-компоненты, как электронная таблица и документ Microsoft Word. Для создания формы выполните следующие действия: 
</P>
<ol>
  <li>Откройте проект Sales. </li>
  <li>Выберите вкладку Documents (Документы), перейдите в группу Forms (Формы), а затем нажмите кнопку New (Новый). 
  </li>
  <li>В открывшемся диалоговом окне New Form (Новая форма) выберите опцию New Form (Новая форма). Откроется окно 
  конструктора форм. </li>
  <li>Нажмите кнопку View Classes (Просмотр классов) на панели инструментов Form Controls (Элементы управления формы), в результате чего на экране появится меню данной кнопки, содержащее команды выбора библиотеки из ранее размещенных на панели инструментов ActiveXкомпонентов и добавления новой библиотеки. 
  </li>
  <li>Выберите значение Standard (Стандартная). Это необходимо, чтобы на панели инструментов Form Controls (Элементы управления формы) были размещены стандартные элементы управления. 
  </li>
</ol>
<IMG src="gl16-11.jpg" alt="gl16-11.jpg" width="500" height="369" ></IMG>
<P>
Рис. 16.11. Форма с размещенным в ней объектом Page  Frame 
</P>
<ol>
  <li value="6">Разместите в форме объект Page Frame (Вкладка), используя кнопку Page Frame (Вкладка) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Введите название формы, воспользовавшись свойством caption (Надпись). 
  </li>
  <li>Задайте для объекта Page Frame (Вкладка) две вкладки, используя свойство Pagecount (Количество вкладок). 
  </li>
  <li>Используя свойство caption (Надпись) каждой вкладки, присвойте им названия (рис. 16.11). 
  </li>
  <li>Форма готова. Теперь можно разместить в ней ActiveX-компоненты. Для этого необходимо отобразить на панели инструментов элементов управления формы ActiveX-компоненты: нажмите кнопку View Classes (Просмотр классов) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Выберите из появившегося меню пункт ActiveX Controls (Элементы управления ActiveX). 
  </li>
</ol>
<P>
<b>Электронная таблица </b> 
</P>
<P>
На первую вкладку формы поместим электронную таблицу Excel (рис. 16.12), используя кнопку Лист Microsoft Excel на панели инструментов Form Controls (Элементы управления формы). 
</P>
<IMG src="gl16-12.jpg" alt="gl16-12.jpg" width="500" height="369" ></IMG>
<P>
Рис. 16.12. Электронная таблица, размещенная на первой вкладке формы 
</P>
<P>
Для редактирования электронной таблицы используется конструктор. Чтобы его запустить, необходимо выполнить следующие действия: 
</P>
<ol>
  <li>Выделите в форме электронную таблицу. </li>
  <li>Нажмите правую кнопку мыши. </li>
  <li>В   контекстном   меню   выберите   команду   Лист Object, а затем опцию Изменить или Открыть. 
  </li>
</ol>
<P>
После выбора пункта меню Изменить интерфейс Visual FoxPro изменяется. Вы переходите в режим редактирования по месту электронной таблицы (рис. 16.13), при котором в окно Visual FoxPro добавляются панели инструментов Microsoft Excel. Можете приступить к редактированию таблицы с помощью средств электронной таблицы. 
</P>
<IMG src="gl16-13.jpg" alt="gl16-13.jpg" width="500" height="367" ></IMG>
<P>
Рис. 16.13. Редактирование электронной таблицы в Visual FoxPro 
</P>
<P>
В том случае, если вы выбираете пункт меню Открыть, запускается приложение Microsoft Excel и в нем открывается созданный вами лист электронной таблицы (рис. 16.14). 
</P>
<IMG src="gl16-14.jpg" alt="gl16-14.jpg" width="500" height="367" ></IMG>
<P>
Рис. 16.14. Редактирование электронной таблицы в отдельном приложении 
</P>
<P>
<b>Документ Microsoft Word </b> 
</P>
<P>
На вторую вкладку формы поместим объект для работы с документом Microsoft Word (рис. 16.15), используя кнопку Документ Microsoft Word на панели инструментов Form Controls (Элементы управления формы). 
</P>
<P>
Для редактирования объекта типа Документ Microsoft Word вы также можете использовать команды Изменить и Открыть контекстного меню. На рис. 16.16 приведен режим редактирования по месту. 
</P>
<P>
<b>Работа с ActiveX-компонентами после запуска формы на выполнение </b> 
</P>
<P>
При запуске формы, содержащей ActiveX-компоненты, они активизируются. Поведение ActiveX-компонентов определяется заданными для них алгоритмами управления. Например, для редактирования информации в электронной таблице достаточно дважды щелкнуть на объекте (рис. 16.17). 
</P>
<IMG src="gl16-15.jpg" alt="gl16-15.jpg" width="500" height="369" ></IMG>
<P>
Рис. 16.15. Объект для работы с документом Microsoft Word 
</P>
<IMG src="gl16-16.jpg" alt="gl16-16.jpg" width="500" height="369" ></IMG>
<P>
Рис. 16.16. Редактирование документа Microsoft Word 
</P>
<IMG src="gl16-17.jpg" alt="gl16-17.jpg" width="500" height="370" ></IMG>
<P>
 Рис. 16.17. Редактирование электронной таблицы 
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Связь ActiveX-компонентов с базой данных </font> 
</P>
<P>
В предыдущем разделе мы рассмотрели размещение в форме ActiveX<span lang="ru">-</span>компонентов. Но форма предназначена, в основном, для работы с базой данных. Возникает вопрос, а как же использовать ActiveX-компоненты для работы с таблицами базы данных? Связь ActiveX-компонентов с базой данных рассмотрим на примере RTF-объекта, который используется для ввода в Memo-поля таблицы форматированного текста. Чтобы создать форму с размещенным в ней RTF-объектом, будем использовать таблицу customer, содержащую Memo-поле mnotes с дополнительной информацией о клиенте: 
</P>
<ol>
  <li>Добавьте на панель инструментов Form Controls (Элементы управления формы) кнопку Microsoft Rich TextBox Control (Элемент управления для редактирования текста в формате RTF). Для этого на вкладке Controls (Элементы управления) диалогового окна Options (Параметры) в списке Selected (Выбранные) установите флажок рядом со значением Microsoft Rich TextBox Control (Элемент управления для редактирования текста в формате RTF) и нажмите кнопку ОК. 
  </li>
  <li>Для управления RTF-объектом нам понадобятся элементы управления, которые 
содержатся в библиотеке классов Samples (Образцы), содержащейся в поставке Visual FoxPro. Присоедините данную библиотеку. После этого при нажатии кнопки View Classes (Просмотр классов) появляется меню, содержащее команды для размещения на панели инструментов Form Controls (Элементы управления формы) ActiveX-компонентов и объектов из библиотеки Samples (Образцы). 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Присоединение внешних библиотек мы рассмотрели в начале этой главы.
</font> 
</P>
<ol>
  <li value="3">Откройте проект Sales. </li>
  <li>Откройте в конструкторе форму, позволяющую вводить информацию в
таблицу Customer. </li>
  <li>Удалите из формы поле, которое использовалось вами ранее для ввода информации в поле таблицы mnotes. 
  </li>
  <li>Чтобы отобразить на панели инструментов Form Controls (Элементы управления формы) кнопки для размещения в форме ActiveXкомпонентов, нажмите кнопку View Classes (Просмотр классов) и в появившемся меню выберите команду ActiveX Controls (Элементы управления ActiveX). 
  </li>
  <li>Выберите на панели инструментов Form Controls (Элементы управления формы) кнопку Microsoft Rich TextBox Control (Элемент управления для редактирования текста в формате RTF) и разместите в форме поле, предназначенное для ввода примечания. 
  </li>
  <li>Чтобы можно было управлять созданным полем, необходимо поместить в форму элементы управления RTF-объектом. Для этого на панели инструментов Form Controls (Элементы управления формы) нажмите кнопку View Classes (Просмотр классов) и в появившемся меню кнопки выберите команду Samples (Образцы). 
  </li>
  <li>Нажмите на панели инструментов Form Controls (Элементы управления формы) кнопку rtfcontrols (Элементы управления RTF) из библиотеки samples (Образцы) и разместите в форме элементы управления. В результате форма примет вид, представленный на рис. 16.18. 
  </li>
  <li>Чтобы связать размещенное в форме поле с полем таблицы Customer, откройте окно Properties (Свойства) и для свойства controisource (Источник данных) задайте поле mnotes. 
  </li>
  <li>Для элементов управления RTF-объектом задайте методы, устанавливающие значения свойств объекта. 
  </li>
</ol>
<P>
Результат размещения в форме RTF-объекта приведен на рис. 16.19. 
</P>
<IMG src="gl16-18.jpg" alt="gl16-18.jpg" width="500" height="453" ></IMG>
<P>
Рис. 16.18. Форма с размещенным ActiveX-компонентом и объектом из библиотеки Samples 
</P>
<IMG src="gl16-19.jpg" alt="gl16-19.jpg" width="500" height="453" ></IMG>
<P>
Рис. 16.19. Использование в форме ActiveX-компонента для ввода форматированной информации в Memo-поле таблицы 
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">Использование календаря в форме </font> 
</P>
<P>
Календарь также является одним из ActiveX-компонентов. Вы можете использовать его для ввода информации в поля дат. 
</P>
<P>
Сначала разместим календарь в форме, чтобы посмотреть свойства, которыми обладает данный объект, и возможности их настройки. Затем рассмотрим пример программного использования календаря для ввода даты. 
</P>
<P>
<b>Настройка свойств календаря </b> 
</P>
<P>
Чтобы разместить в форме календарь, который на панели инструментов Form Controls 
(Элементы управления формы), содержащей ActiveX<span lang="ru">-</span>компоненты, отображается в виде кнопки Calendar Control (Элемент управления календарь), нажмите данную кнопку, установите указатель мыши в форму и нарисуйте курсором рамку требуемого размера. Календарь размещен в форме (рис. 16.20). 
</P>
<IMG src="gl16-20.jpg" alt="gl16-20.jpg" width="500" height="434" ></IMG>
<P>
Рис. 16.20. Форма с размещенным в ней календарем 
</P>
<P>
С целью настройки свойств календаря выделите размещенный объект и нажмите правую кнопку мыши. В контекстном меню выберите команду Календарь Свойства. На экране откроется диалоговое окно Свойства: Календарь созданного объекта, содержащее набор параметров, позволяющих настроить календарь (рис. 16.21). 
</P>
<IMG src="gl16-21.jpg" alt="gl16-21.jpg" width="446" height="346" ></IMG>
<P>
Рис. 16.21. Диалоговое окно Свойства: Календарь 
</P>
<P>
Диалоговое   окно   Свойства: Календарь   содержит   три   вкладки:   Общие (General), Шрифт (Font), Цвет (Color). 
</P>
<P>
Вкладка Общие содержит поля, позволяющие настроить параметры, описанные в табл. 16.2. 
</P>
<P>
Таблица 16.2. Назначение полей окна Свойства: Календарь 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Поле 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Значение (Value) 
</TD>
<TD VALIGN="TOP">
Текущая дата 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Первый день недели 
</P>
<P>
(First Day) 
</TD>
<TD VALIGN="TOP">
День, принимаемый за первый день недели 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Формат дня {Day Length) 
</TD>
<TD VALIGN="TOP">
Формат отображения наименования дня недели; может принимать одно из трех значений: короткий, средний, длинный 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Формат месяца (Month Length) 
</TD>
<TD VALIGN="TOP">
Формат отображения наименования месяца; может принимать одно из двух значений: короткий и длинный 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Оформление (Grid Cell Effect) 
</TD>
<TD VALIGN="TOP">
Стиль отображения ячеек таблицы 
</TD>
</TR>
</TABLE>
<P>
Область Отображение (Show) вкладки Общие (General) содержит флажки, описанные в табл. 16.3. 
</P>
<P>
Таблица 16.3. Назначение флажков области Отображение вкладки Общие 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Флажок 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Заголовок месяца и года 
</P>
<P>
(Month/Year Title) 
</TD>
<TD VALIGN="TOP">
Указывает на необходимость отображения заголовка месяца и года 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Выбор месяца и года 
</P>
<P>
(Month/Year Selectors) 
</TD>
<TD VALIGN="TOP">
Указывает на необходимость размещения в заголовке полей для выбора месяца и года 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Дни недели (Days of Week) 
</TD>
<TD VALIGN="TOP">
Указывает на необходимость отображения в заголовке таблицы дней недели 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Сетка по горизонтали 
</P>
<P>
(Horizontal Grid) 
</TD>
<TD VALIGN="TOP">
Указывает на необходимость отображения в таблице горизонтальных линий сетки 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Сетка по вертикали 
</P>
<P>
(Vertical Grid) 
</TD>
<TD VALIGN="TOP">
Указывает на необходимость отображения в таблице вертикальных линий сетки 
</TD>
</TR>
</TABLE>
<P>
При изменении любого из параметров вкладки становится доступной кнопка Применить, при нажатии на которую сохраняются введенные изменения. 
</P>
<P>
Вкладка Шрифт (Font) окна свойств календаря (рис. 16.22) позволяет настроить шрифты объекта. Список Свойства (Properties) вкладки содержит объекты оформления календаря, для которых можно настроить шрифты: 
</P>
<ul>
  <li>DayFont — дни недели, расположенные в заголовке таблицы; </li>
  <li>GridFont — числа, размещенные в таблице календаря; </li>
  <li>Title Font — месяц и год в заголовке календаря. </li>
</ul>
<P>
Списки Шрифт (Font) и Размер (Size) позволяют задать наименование и размер шрифта, выбранного из списка Свойства (Properties) объекта, а флажки области Атрибуты (Effects) — стиль оформления. 
</P>
<P>
Вкладка Цвет (Color) окна свойств календаря (рис. 16.23) позволяет изменить цветовое оформление календаря. Список Свойства (Properties) содержит элементы календаря, для которых можно настроить цвета: 
</P>
<ul>
  <li>Backcoior — фон календаря; </li>
  <li>DayFontcoior — дни недели, расположенные в заголовке таблицы; </li>
  <li>GridFontCoior — числа, размещенные в таблице календаря; </li>
  <li>GridLinesCoior — линии сетки таблицы календаря; </li>
  <li>TitieFontCoior — месяц и год в заголовке календаря. </li>
</ul>
<P>
С помощью списка Набор цветов (Color Set) можно установить используемую цветовую схему, а списка Цветовая палитра (Color Palette) — цвет выбранного из списка Свойства (Properties) элемента. 
</P>
<IMG src="gl16-22.jpg" alt="gl16-22.jpg" width="446" height="346" ></IMG>
<P>
Рис. 16.22. Вкладка Шрифт диалогового окна Свойства: Календарь 
</P>
<IMG src="gl16-23.jpg" alt="gl16-23.jpg" width="446" height="346" ></IMG>
<P>
Рис. 16.23. Вкладка Цвет диалогового окна Свойства: Календарь 
</P>
<P>
При нажатии на кнопку Справка (Help) открывается окно справочной системы, содержащее список всех методов, свойств и событий ActiveXкомпонента (рис. 16.24). 
</P>
<IMG src="gl16-24.jpg" alt="gl16-24.jpg" width="500" height="510" ></IMG>
<P>
Рис. 16.24. Список всех методов, свойств и событий ActiveX-компонента 
</P>
<P>
<b>Использование календаря
для ввода информации в поля дат </b> 
</P>
<P>
Мы описали свойства календаря. Теперь посмотрим, как можно использовать данный ActiveX-компонент для ввода информации в поля таблицы, содержащие даты. В качестве примера создадим форму для ввода информации о сотрудниках фирмы. Исходная таблица Manager содержит поле ddatebirth с информацией о дате рождения сотрудника. Информацию в это поле будем вводить с помощью программно формируемого ActiveX-компонента календарь. 
</P>
<P>
Чтобы создать форму, выполните следующие действия: 
</P>
<ol>
  <li>В проекте sales откройте окно конструктора. </li>
  <li>В окружение формы добавьте таблицу, содержащую список сотрудников. </li>
  <li>Разместите в форме необходимые для ввода информации поля таблицы. </li>
  <li>Откройте окно свойств Properties (Свойства) поля, предназначенного для ввода даты рождения сотрудника. 
  </li>
  <li>Используя   свойство   Name   (Имя),   присвойте   объекту   наименование
 txtbirthday. </li>
  <li>Используя свойство control sour се (Источник данных), задайте в качестве источника данных поля для ввода даты рождения поле ddatebirth таблицы. 
  </li>
</ol>
<ol>
  <li value="7">Рядом с полем, предназначенным для ввода даты рождения, расположите кнопку. 
  </li>
  <li>Используя свойство caption (Надпись), присвойте кнопке название Календарь</li>
  <li>Откройте окно свойств Properties (Свойства) кнопки Календарь. </li>
  <li>В окне процедур свойства click (Нажатие) введите команды, которые программно формируют и задают свойства ActiveX-компонента календарь: 
  </li>
</ol>
<blockquote>
<P>
 #DEFINE C_CALCAPTION_LOC &quot;Календарь&quot; 
</P>
<P>
 oCalForm = Create('form'<span lang="ru">)</span></P>
<P>
 oCalForm.NewObject(&quot;oleCalendar&quot;,&quot;_olecalendar&quot;, &quot;_datetime&quot;) 
</P>
<P>
 WITH oCalForm.oleCalendar 
</P>
<P>
 .date_cclumn = &quot;manager.ddatebirth&quot; 
</P>
<P>
 .RefreshDisplay{) 
</P>
<P>
 .BackColor = THISFORM.BackColor 
</P>
<P>
 .Visible = .T.  
</P>
<P>
 ENDWITH 
</P>
<P>
 WITH OCalForm 
</P>
<P>
 .BorderStyle = 2 
</P>
<P>
 .MaxButton = .F. 
</P>
<P>
 .MinButton = .F. 
</P>
<P>
 .Height = oCalForm.oleCalendar.Height 
</P>
<P>
 .Width = oCalForm. oleCalendar.Width 
</P>
<P>
 .Caption = C_CALCAPTION_LOC 
</P>
<P>
 ENDWITH 
</P>
<P>
 oCalForm.Show(l) 
</P>
<P>
 THISFORM.Refresh 
</P>
</blockquote>
<ol>
  <li value="11">Закройте окно процедур. </li>
</ol>
<P>
Создание формы завершено. Запустите ее на выполнение. Для ввода информации в поле дата рождения нажмите кнопку Календарь. На экране откроется календарь. Выберите необходимое число, месяц и год и закройте календарь. Указанная вами дата будет перенесена в поле день рождения.</P>
<p>&nbsp;
<a NAME="10"></a><font size="4">Использование браузера объектов </font> 
</P>
<P>
В Visual FoxPro 7 появилось новое средство для просмотра списка классов, свойств, методов, событий и констант библиотек СОМ-объектов или ActiveX-компонентов — Object Browser (Браузер объектов). В окне браузера можно выполнять поиск заданного значения в пределах всей библиотеки. 
</P>
<P>
Дня запуска браузера можно воспользоваться одним из следующих способов.  
</P>
<ul>
  <li>Выполнить команду Object Browser (Браузер объектов) из меню Tools (Сервис). 
  </li>
  <li>Нажать кнопку Object Browser на стандартной панели инструментов. </li>
</ul>
<P>
Для открытия библиотеки и просмотра ее структуры в окне браузера объектов предназначена кнопка Open Type Library (Открыть библиотеку) При нажатии   этой   кнопки   открывается   диалоговое   окно   Open   (Открыть), которое содержит три вкладки следующего назначения: 
</P>
<ul>
  <li>Recent History (Хронология) — содержит список открытых ранее библиотек; 
  </li>
  <li>COM Libraries (СОМ-библиотеки) — содержит список СОМ-библиотек, имеющихся на компьютере; 
  </li>
  <li>Current Selection (Выбранные) — содержит список открытых в окне Object Browser (Браузер объектов) библиотек. 
  </li>
</ul>
<P>
При нажатии кнопки Find (Найти) в верхней части окна Object Browser (Браузер объектов) появляется поле Look for (Значение для поиска) и кнопка Go (Начать поиск), предназначенные для текстового поиска. 
</P>
</BODY>
</HTML>