<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 1
<br>
Знакомство с Visual FoxPro</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl1.html#1">Реляционные базы данных</a>
  <li><a href="gl1.html#2">Современные реляционные СУБД</a>
  <li><a href="gl1.html#3">Объекты Visual FoxPro</a>
  <li><a href="gl1.html#4">Что нового появилось в Visual FoxPro 7.0</a>
</ul>


<p>&nbsp;
<a NAME=""></a><font size="4"></font>
</P>

<P>
Перемены, произошедшие в нашей стране в последнее время, не могли не затронуть областей информатики и вычислительной техники. Еще десять лет назад работа с базами данных была уделом профессиональных программистов. Сами системы не были предназначены для простого пользователя. Основным 
потребителем таких систем был военно-промышленный комплекс. С появлением банков, 
акционерных обществ, частных компаний базы данных нашли более широкое применение. Люди понимают, что информация — это деньги. Ее потеря или несвоевременное получение могут дорого стоить. Именно этим можно объяснить столь бурный рост информационных технологий и стремительное развитие систем управления базами данных (СУБД).
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Реляционные базы данных </font>
</P>
<P>
Первые системы управления базами данных появились в середине шестидесятых годов XX века и поддерживали иерархическую модель данных в которой 
между записями существовали отношения предок/потомок. Спустя короткое время, были разработаны сетевые базы данных, в основу которых<span lang="ru">
</span>была заложена значительно более сложная сетевая модель. У каждой из этих<span lang="ru">
</span>моделей имелись свои достоинства и недостатки, которые сыграли ключевую роль в развитии реляционной модели.
</P>
<P>
В 1970 году статья научного сотрудника компании IBM доктора Е. Ф. Коддао реляционной модели данных произвела революцию в подходе к хранению<span lang="ru">
</span>и обработке информации. На основе этой модели в семидесятые годы были<span lang="ru">
</span>разработаны первые реляционные базы данных, а в настоящее время они рассматриваются как стандарт для современных коммерческих СУБД.
</P>
<P>
В реляционных базах данных вся информация сведена в таблицы, строки и<span lang="ru">
</span>столбцы которых называются записями и полями соответственно. Эти таблицы получили название реляций 
[Отношение — математический термин из теории множеств, которая легла в основу реляционной модели данных. В английском языке слову &quot;отношение&quot; соответствует слово relation, отсюда название &quot;реляция&quot;. — Ред. 
], поэтому модель стала называться реляционной. Записи в таблицах не повторяются. Их уникальность обеспечивается первичным ключом, содержащим набор полей, однозначно определяющих запись. Для быстрого поиска информации в базе данных создаются индексы по одному или нескольким полям таблицы. Значения индексов хранятся в упорядоченном виде и содержат ссылки на записи таблицы. Для автоматической поддержки целостности связанных данных, находящихся в разных таблицах, используются первичные и внешние ключи. Для выборки данных из нескольких связанных таблиц используются значения одного или нескольких совпадающих полей. Например, таблица регистрации междугородних телефонных разговоров может содержать следующие сведения:
</P>
<ul>
  <li>Номер заказа </li>
  <li>Код услуги </li>
  <li>Номер телефона </li>
  <li>Дата разговора </li>
  <li>Код города </li>
  <li>Продолжительность разговора </li>
  <li>Стоимость </li>
  <li>Примечание </li>
</ul>
<P>
Записи о междугородних разговорах заносятся в книгу регистрации в табличном виде в хронологическом порядке (рис. 1.1). Каждая строка имеет одинаковую структуру и состоит из восьми полей. В рассматриваемом примере<span lang="ru"> 
это поля</span>: Номер заказа, Код услуги, Номер телефона, Дата разговора, Код города, Продолжительность, Стоимость.
</P>
<IMG src="gl1-1.jpg" alt="gl1-1.jpg"></IMG>
<P>
Рис. 1.1. Книга регистрации междугородних разговоров
</P>
<P>
<b><font color="#008000">Замечание</font></b></P>
<P>
<font color="#008000">В реляционных базах данных поля могут иметь разные типы данных (числовой,<span lang="ru">
</span>строковый, типа даты и т. п.), но для каждой записи тип данных поля остается<span lang="ru">
</span>неизменным. </font>
</P>
<P>
Одним из важных требований к базам данных является быстрая выборка<span lang="ru">
</span>хранимой в ней информации. Используя телефонно-адресную книгу, в которой данные упорядочены по фамилиям, вы можете найти номер телефона<span lang="ru">
</span>по фамилии его владельца. Однако, если записи в книге регистрации междугородних 
разговоров упорядочены в хронологическом порядке, вам придется потратить 
значительное время на получение списка клиентов, заказывавших разговор с определенным городом, или на выяснение того, в каком<span lang="ru">
</span>районе проживают абоненты, приносящие наибольшую прибыль телефонной компании своими продолжительными разговорами.
</P>
<P>
На помощь приходят компьютерные базы данных. Они, несмотря на огромный объем хранящейся в них информации, обеспечивают высокую скорость<span lang="ru">
</span>поиска необходимой информации. В таких базах данных пользователь может 
выполнить поиск по любому интересующему его параметру. Кроме того, компьютерные базы данных очень компактны. База данных, содержащая<span lang="ru">
</span>несколько тысяч записей, может поместиться на одной дискете.
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">Современные<span lang="ru"> </span>реляционные СУБД
</font>
</P>
<P>
Для создания базы данных, изменения ее структуры, редактирования и выборки данных используются системы управления базами данных. Современные реляционные системы управления базами данных содержат:
</P>
<ul>
  <li>набор инструментов для создания таблиц и отношений между связанными таблицами; 
  </li>
  <li>средства администрирования базы данных; </li>
  <li>развитый пользовательский интерфейс, который позволяет получить доступ к информации, хранящейся в базе данных; 
  </li>
  <li>средства разработки приложений, использующих базы данных. </li>
</ul>
<P>
На рис. 1.2 показан пример учета междугородних телефонных разговоров с<span lang="ru">
</span>помощью двух таблиц реляционной базы данных в Visual FoxPro.
</P>
<P>
С помощью средств СУБД вы можете:
</P>
<ul>
  <li>выбрать информацию, представляющую для вас интерес. Например, вы<span lang="ru">
  </span>можете получить сведения обо всех междугородних разговорах определенного клиента за любой интервал времени; 
  </li>
</ul>
<IMG src="gl1-2.jpg" alt="gl1-2.jpg"></IMG>
<P>
Рис. 1.2. Учет заказов с помощью реляционных таблиц
</P>
<IMG src="gl1-3.jpg" alt="gl1-3.jpg"></IMG>
<P>
Рис. 1.3. Отчет в табличном виде, содержащий информацию<span lang="ru"> </span>о клиентах телефонной компании
</P>
<ul>
  <li>вывести на печать всю таблицу или только выбранные записи и поля в<span lang="ru">
  </span>различных форматах. Например, на рис. 1.3 показан табличный отчет,<span lang="ru">
  </span>содержащий адреса клиентов телефонной компании. На рис. 1.4 приведен один из вариантов информационного письма, содержащего имена и<span lang="ru">
  </span>фамилии клиентов из той же самой таблицы; </li>
  <li>отображать информацию базы данных в графическом виде. Например, нарис. 1.5 выведены, в виде диаграммы, данные о количестве клиентов<span lang="ru">
  </span>торговой фирмы по городам; </li>
  <li>осуществлять необходимые вычисления при формировании отчетов и<span lang="ru">
  </span>выборке данных из таблиц. </li>
</ul>
<IMG src="gl1-4.jpg" alt="gl1-4.jpg"></IMG>
<P>
Рис. 1.4. Информационное письмо,<span lang="ru"> </span>использующее сведения из базы данных
</P>
<P>
В настоящее время имеется более десяти популярных СУБД для персональных компьютеров. Традиционно одной из наиболее распространенных в<span lang="ru">
</span>России и странах СНГ является СУБД Visual FoxPro, новая версия которой,<span lang="ru">
</span>Visual FoxPro 7.0, содержит дополнения и улучшения, расширяющие возможности системы.
</P>
<IMG src="gl1-5.jpg" alt="gl1-5.jpg"></IMG>
<P>
Рис. 1.5. Графическое представление информации<span lang="ru"> </span>о количестве клиентов торговой фирмы
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Объекты Visual FoxPro </font>
</P>
<P>
Visual FoxPro состоит из отдельных компонентов, которые используются для<span lang="ru">
</span>хранения информации, ее отображения и редактирования.<span lang="ru">
</span>В Visual FoxPro вся информация хранится в базе данных, которая состоит из<span lang="ru">
</span>таблиц, отношений между таблицами, индексов, триггеров и хранимых процедур. 
Каждая таблица имеет уникальное имя и хранится в отдельном файле, наименование которого совпадает с именем таблицы. Созданный файл<span lang="ru">
</span>имеет расширение DBF.
</P>
<P>
Каждая создаваемая таблица может иметь связанные с ней индексы, используемые для упорядочения данных и быстрого поиска необходимых записей,<span lang="ru">
</span>причем каждая таблица может иметь несколько индексов.<span lang="ru">
</span>Для хранения значений полей типа Memo и General применяются отдельные файлы. Memo-поля таблиц содержат текстовую информацию, а поля типа General используются, как правило, для хранения двоичной информации<span lang="ru">
</span>и данных других приложений, работающих в среде Windows.В Visual FoxPro реализованы триггеры, которые позволяют централизованно<span lang="ru">
</span>обрабатывать события, возникающие при любых изменениях в базе данных.Вы также можете создавать хранимые процедуры, которые являются частью
базы данных и могут использоваться при описании таблиц, для проверки<span lang="ru">
</span>введенных данных, определения значения по умолчанию и т. п.
</P>
<P>
Чрезвычайно удобным и полезным средством доступа к базе данных являются представления данных. Представления данных позволяют объединять<span lang="ru">
</span>данные таблиц и отображать их в более удобном виде. Вы можете выбрать<span lang="ru">
</span>только интересующие вас поля таблиц, объединить несколько полей в одно<span lang="ru">
</span>поле, вычислить итоговые значения и задать новые имена полей таблицы.<span lang="ru">
</span>Как правило, количество представлений в базе данных намного превосходит<span lang="ru">
</span>количество таблиц. По мере эксплуатации базы данных их количество непрерывно растет. Во многих информационных системах доступ к данным, включая просмотр, добавление и редактирование, осуществляется только с помощью представлений данных. Данный подход позволяет осуществить гибкое<span lang="ru">
</span>управление доступом к информации. При использовании представлений для<span lang="ru">
</span>выборки данных в формах, отчетах, при создании запросов и в программах<span lang="ru">
</span>применяются те же правила, что и для таблиц. Редактирование данных, включенных в представление, возможно только при определенных условиях. Например, в том случае, если оно создано на основе только одной таблицы.
</P>
<P>
Для отображения и редактирования данных используются формы, отчеты,<span lang="ru">
</span>запросы и программы. При создании форм, отчетов и запросов применяются<span lang="ru">
</span>конструкторы. Поэтому эти компоненты часто называют конструкторскими<span lang="ru">
</span>объектами. Формы и отчеты являются составными объектами, т. к. они состоят из более мелких объектов (таких как поля, кнопки, диаграммы, рамки,<span lang="ru">
</span>OLE<span lang="ru">-</span>компоненты и т. п.), которые называются объектами интерфейса.
</P>
<P>
Формы используются для просмотра или ввода данных в таблицы. Данные<span lang="ru">
</span>можно вводить непосредственно в таблицы, но использование формы является более быстрым и более эффективным способом ввода. Форма содержит<span lang="ru">
</span>некоторые или все поля таблиц, в которые вы вводите информацию. Для<span lang="ru">
</span>создания форм вы можете использовать мастер создания форм или конструктор форм. Мастер форм содержит целый ряд шаблонов, которые определяют соотношение между помещаемыми в форму таблицами, вид отображения данных и порядок размещения полей. Для создания сложных форм<span lang="ru">
</span>применяется конструктор форм.
</P>
<P>
Отчеты используются для просмотра и вывода на печать содержащейся в базе<span lang="ru">
</span>данных информации. Примерами отчетов являются прайс-лист товаров, список покупателей, оборотная складская ведомость. Как правило, отчеты создаются в том случае, если информацию необходимо передавать кому-либо в печатном виде. Для создания отчетов в Visual FoxPro, как и для форм,<span lang="ru">
</span>используются мастер и конструктор отчетов. С помощью мастера отчетов вы<span lang="ru">
</span>можете быстро создать собственный отчет на основе имеющихся шаблонов.<span lang="ru">
</span>Применение конструктора отчетов позволяет создавать отчеты произвольной<span lang="ru">
</span>сложности, включая многоуровневую группировку данных и размещение вычисляемых полей.
</P>
<P>
Запросы являются средством выборки данных из одной или нескольких таблиц. В Visual FoxPro 
для создания запроса вы можете использовать как конструктор запросов, так и специализированный язык Structured Query 
Language (SQL). Результаты выполнения запроса могут отображаться в форме,<span lang="ru">
</span>выводиться в виде отчетов и диаграмм или сохраняться в указанной вами<span lang="ru">
</span>таблице.
</P>
<P>
Программы, написанные на языке Visual FoxPro, являются объектно-ориентированными. С помощью них вы обрабатываете события в форме, создаете 
объекты, осуществляете различные вычисления, управляете базой данных. Для удобства работы вы можете объединить программы в библиотеки.
</P>
<P>
Для создания форм в Visual FoxPro можно использовать не только базовые<span lang="ru">
</span>классы, но и создавать собственные. Например, вы можете определить класс<span lang="ru">
</span>форм, в котором задан определенный цвет фона и стандартный набор кнопок для управления данными. Чтобы стандартизировать разработку, полезно<span lang="ru">
</span>иметь один или несколько пользовательских классов для каждого базового<span lang="ru">
</span>класса. Классы, созданные в Visual FoxPro, хранятся в библиотеках классов.
</P>
<P>
Для объединения компонентов создаваемого приложения используется проект, в который включаются все перечисленные выше компоненты. Использование проекта упрощает<span lang="ru">
</span>разработку приложения и его сопровождение.
</P>
<P>
В Visual FoxPro имеется возможность сохранять параметры основного окна<span lang="ru">
</span>Visual FoxPro, настройки таблиц, параметры диалоговых окон и панели инструментов с помощью файла параметров настройки.
</P>
<P>
Каждый компонент хранится в отдельном файле, причем имена файлов, содержащих основные компоненты, вы задаете самостоятельно, а наименования<span lang="ru">
</span>файлов, содержащих объекты, связанные с таблицей, совпадают с именем<span lang="ru">
</span>таблицы. В зависимости от типа содержащегося в нем объекта Visual FoxPro<span lang="ru">
</span>автоматически присваивает каждому файлу расширение, которое помогает в<span lang="ru">
</span>идентификации объекта. Список расширений файлов приведен в табл. 1.1.
</P>
<P>
Таблица 1.1. Расширения имен файлов объектов Visual FoxPro
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD
Наименование объекта
</TD>
<span lang="ru">Наименование объекта</span><TD>
Расширения
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Проект
</TD>
<TD>
PRJ, FPC, CAT, PJX, PJT
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
База данных
</TD>
<TD>
DBC
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Таблица Visual FoxPro
</TD>
<TD>
DBF
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Составной индексный файл
</TD>
<TD>
CDX
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Memo-поле и поле типа General
</TD>
<TD>
FRT
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Форма
</TD>
<TD>
sex
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Запрос
</TD>
<TD>
QPR

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Отчет
</TD>
<TD>
FRX, FRM
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Почтовая наклейка
</TD>
<TD>
LBX, LBL
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Меню
</TD>
<TD>
MNX
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Библиотека класса
</TD>
<TD>
VCX
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Программа, библиотека программ,текст меню, текст запроса
</TD>
<TD>
PRG, FXP, MPR, QPR
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Рисунок
</TD>
<TD>
BMP, JPG, GIF, ICO, DIB, CUR, ANI
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD>
Звукозапись
</TD>
<TD>
WAV
</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="4"></a><font size="4">Что нового появилосьв Visual FoxPro 7.0 </font>
</P>
<P>
Visual FoxPro является постоянно развивающейся системой. По сравнению с<span lang="ru">
</span>предыдущей версией, в Visual FoxPro 7.0 сделан еще один шаг в расширении<span lang="ru">
</span>функциональных возможностей системы, улучшены имеющиеся средства,<span lang="ru">
</span>касающиеся интерфейса среды разработки.
</P>
<P>
Visual FoxPro 7.0 поддерживает технологию IntelliSense, облегчающую создание программного кода. Суть данной технологии состоит в том, что при<span lang="ru">
</span>вводе операторов, свойств и функций FoxPro предлагает на выбор возможные варианты написания. Это уменьшает количество вводимого вручную<span lang="ru">
</span>кода и избавляет разработчика от необходимости лишний раз обращаться к<span lang="ru">
</span>документации. Технология IntelliSense Visual FoxPro содержит следующие<span lang="ru">
</span>функции:
</P>
<ul>
  <li>показывает список допустимых дочерних объектов (свойств, событий,<span lang="ru">
  </span>методов) для указанного объекта. Для СОМ-объектов информация считывается из библиотеки типов; 
  </li>
  <li>показывает окно подсказки, содержащее список допустимых параметров
или аргументов для команд, функций, свойств, методов и событий.</li>
</ul>
<P>
В редактор Visual FoxPro были добавлены следующие возможности:
</P>
<ul>
  <li>использование для выделения текста на выбор пробела или табулятора с<span lang="ru">
  </span>настраиваемыми параметрами; </li>
  <li>настройка строк комментария; </li>
  <li>поддержка в редакторе гиперссылок на Web-страницы или документацию; </li>
  <li>поддержка Dirty File Indicator для отображения времени внесения изменений в код; 
  </li>
  <li>удобная установка точек прерывания в программном коде;</li>
  <li>использование закладок для быстрого возврата на нужный фрагмент кода.</li>
</ul>
<P>
Для настройки параметров редактора используются новые вкладки Editor<span lang="ru">
</span>(Редактор)   и IDE   (Интерактивная   среда  разработки)   диалогового   окна<span lang="ru">
</span>Options   (Параметры),   которое   открывается   при   выполнении   команды<span lang="ru">
</span>Options (Параметры) из меню Tools (Сервис).
</P>
<P>
Для облегчения работы пользователя с несколькими окнами, такими как<span lang="ru">
</span>Command (Команда), Properties (Свойства) и окном редактора, VisualFoxPro 7.0 позволяет перемещать и закреплять окна, т. е. манипулировать<span lang="ru">
</span>ими по своему усмотрению. Например, вы можете установить командное<span lang="ru">
</span>окно и окно свойств в одно окно-контейнер и привязать его к правому<span lang="ru">
</span>краю экрана, а окно редактора — в другое окно-контейнер, привязав его к<span lang="ru">
</span>левому краю экрана.
</P>
<P>
СОМ-компоненты Visual FoxPro могут использовать свойства, события и<span lang="ru">
</span>методы СОМ-интерфейса, определенного в другом СОМ-компоненте.<span lang="ru">
</span>В Visual FoxPro появилось средство Task List (Список заданий), позволяющее 
пользователю формировать список задач в проекте и управлять их выполнением.
</P>
<P>
Приложение Object Browser (Браузер объекта), входящее в состав Visual FoxPro и запускаемое из меню Tools (Сервис), позволяет просматривать свойства, методы и события СОМ-объектов, что очень удобно при работе с объектами, на которые нет документации.
</P>
<P>
В Visual FoxPro появились новые средства управления XML-файлами:</P>
<ul>
  <li>&nbsp;XMLTOCURSOR — преобразовывает XML-текст в курсор или таблицу Visual
FoxPro; </li>
  <li>CURSORTOXML — преобразовывает курсор Visual FoxPro в XML-текст.Поддержка Active Accessibility в Visual FoxPro позволяет создавать приложения, которые могут использовать люди с проблемами зрения, слуха или моторики. 
  </li>
</ul>
<P>
В базе данных, созданной в Visual FoxPro, вы можете использовать события,<span lang="ru">
</span>связанные с базой данных, такие как открытие таблицы, добавление или<span lang="ru">
</span>удаление таблицы для проверки прав доступа при открытии таблицы, трассировки выполняемых действий и т. п.
</P>
</BODY>
</HTML>