<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 6 
<br>
Конструктор форм</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl6.html#1">Окно конструктора форм</a>
  <li><a href="gl6.html#2">Создание формы </a>
  <li><a href="gl6.html#3">Настройка параметров формы</a>
  <li><a href="gl6.html#4">Расположение формы</a>
  <li><a href="gl6.html#5">Заголовок формы</a>
  <li><a href="gl6.html#6">Стиль обрамления формы</a>
  <li><a href="gl6.html#7">Среда окружения формы</a>
  <li><a href="gl6.html#8">Последовательность действий при настройке параметров формы</a>
  <li><a href="gl6.html#9">Размещение объектов в форме </a>
  <li><a href="gl6.html#10">Размещение полей таблиц и надписей к ним с использованием построителя формы</a>
  <li><a href="gl6.html#11">Текстовая информация</a>
  <li><a href="gl6.html#12">Поле ввода</a>
  <li><a href="gl6.html#13">Использование построителя для создания поля ввода</a>
  <li><a href="gl6.html#14">Поле редактирования</a>
  <li><a href="gl6.html#15">Кнопки управления</a>
  <li><a href="gl6.html#16">Размещение изображений в форме</a>
  <li><a href="gl6.html#17">Размещение в форме объекта типа General</a>
  <li><a href="gl6.html#18">Использование в форме флажков </a>
  <li><a href="gl6.html#19">Что такое переключатель</a>
  <li><a href="gl6.html#20">Списки</a>
  <li><a href="gl6.html#21">Раскрывающиеся списки</a>
  <li><a href="gl6.html#22">Использование построителя для создания раскрывающегося списка</a>
  <li><a href="gl6.html#23">Счетчики </a>
  <li><a href="gl6.html#24">Линии и контуры </a>
</ul>




<P>
Вы уже познакомились с созданием формы с помощью мастера форм. В данной главе рассмотрим создание формы в окне конструктора форм.
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Окно конструктора форм </font>
</P>
<P>
Любая форма в Visual FoxPro состоит из объектов, каждый из которых имеет 
характерные свойства. Для любого объекта вы можете указать действия, выполняемые программой при наступлении определенных событий. 
Процесс создания формы в конструкторе форм состоит в размещении в форме объектов и определении свойств, а также связанных с ними событий и выполняемых действий.
</P>
<P>
Для открытия окна конструктора форм при создании новой формы воспользуйтесь одним из следующих способов.
</P>
<ul>
  <li>Выполните команду New (Новый) из меню File (Файл). В открывшемся 
  диалоговом окне New (Новый) выберите опцию Form (Форма) и нажмите кнопку New File (Новый файл). 
  </li>
  <li>Нажмите кнопку на стандартной панели инструментов Visual FoxPro. В открывшемся диалоговом окне New (Новый) выберите опцию Form(Форма) и нажмите кнопку New File (Новый файл). 
  </li>
  <li>Для размещения создаваемой формы в проекте выберите вкладку Documents (Документы), перейдите в группу Forms (Формы) и 
  нажмите кнопку New окна проекта. Затем в открывшемся окне New Form (Новая 
  форма) нажмите одноименную кнопку. </li>
</ul>
<P>
На рис. 6.1 показано окно конструктора форм, содержащее панели инструментов Color Palette 
(Цветовая палитра), Layout (Расположение), Form Designer (Конструктор форм) и Form Controls (Элементы управления формы),используемые при работе в конструкторе. В окне конструктора 
размещена новая форма, с которой вы можете работать.
</P>
<P>
В том случае, когда необходимые панели инструментов отсутствуют, для их 
отображения на экране выберите соответствующие команды в меню View(Вид) (рис. 6.2) или установите флажки выбора панелей инструментов 
в диалоговом окне Toolbars (Панели инструментов).
</P>
<IMG src="gl6-1.jpg" alt="gl6-1.jpg" width="500" height="389"></IMG>
<P>
Рис. 6.1. Окно конструктора форм с панелями инструментов
</P>
<IMG src="gl6-2.jpg" alt="gl6-2.jpg" width="178" height="224"></IMG>
<P>
Рис. 6.2. Установленные метки в опциях меню View для отображения на экране панелей инструментов
</P>
<P>
Панель инструментов Form Controls (Элементы управления формы) используется для размещения в форме объектов. Краткое описание кнопок 
этой панели приведено в табл. 6.1. Более подробно назначение этих кнопок будет 
рассмотрено ниже.
</P>
<P>
Таблица 6.1. Кнопки панели инструментов Form Controls
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Кнопка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/53.jpg" width="15" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Select Objects (Выбор объектов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Указатель   выделения.   Позволяет   выбирать   в форме объекты

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/54.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

View Classes
(Просмотр классов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Позволяет  выбрать  класс для создаваемых  в форме объектов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/55.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Label (Метка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме текстовый объект

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/56.jpg" width="18" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Text Box (Поле ввода)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме поле ввода

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/57.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Edit Box (Поле редактирования)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме поле редактирования

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/58.jpg" width="18" height="12"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Command Button
(Кнопка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме кнопку управления

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/59.jpg" width="14" height="14"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Option Group
(Переключатель)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме переключатель

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/60.jpg" width="15" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Check Box (Флажок)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме флажок

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/61.jpg" width="18" height="13"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Grid (Таблица)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме для размещения полей объект в виде таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/62.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Combo Box
(Раскрывающийся список)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме раскрывающийся список

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/63.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

List Box (Список)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме список

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/64.jpg" width="15" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Spinner (Счетчик)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме поле ввода значения в виде счетчика

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/65.jpg" width="16" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Line (Линия)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме линию

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/66.jpg" width="16" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Shape (Контур)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме контур

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/67.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Container (Контейнер)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме контейнер

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/68.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Image (Изображение)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Размещает в форме рисунок

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/69.jpg" width="18" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Command Group
(Группа кнопок)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Размещает в форме группу кнопок

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/70.jpg" width="17" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Timer (Таймер)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает в форме объект типа таймера

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/71.jpg" width="18" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Page Frame (Вкладка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Размещает в форме страницы с вкладками

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/72.jpg" width="17" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

ActivX Bound Control(OleBoundControl)
(ActivX-объект)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает содержимое OLE-объекта, хранящегося в поле типа General

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/73.jpg" width="17" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

ActivX Control(OleControl) (OLE-объект)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает OLE-объект

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/74.jpg" width="18" height="18"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

HyperLink
(Гиперссылка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает объект для работы с Интернетом

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/75.jpg" width="16" height="12"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Separator
(Разделитель)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Размещает на панели инструментов разделитель кнопок

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/76.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Builder Lock
(Закрепитель построителя)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Закрепляет выбор построителя

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/77.jpg" width="11" height="14"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Button Lock
(Закрепитель кнопки)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Закрепляет выбранную кнопку на панели инструментов

</TD>
</TR>
</TABLE>
<P>
Панель инструментов Form Designer (Конструктор форм) содержит кнопки вызова панелей инструментов Form Controls (Элементы управления формы),Color Palette (Цветовая палитра), Layout (Расположение). С помощью 
этой панели можно выполнять и некоторые дополнительные действия по управлению формой. Краткое назначение кнопок данной панели 
инструментов приведено в табл. 6.2.
</P>
<P>
Таблица 6.2. Кнопки панели инструментов Form Designer
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Кнопка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/78.jpg" width="17" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Set Tab Order
(Порядок объектов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Переключает конструктор форм в режим установления порядка обхода объектов формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/79.jpg" width="18" height="14"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Data Environment
(Окружение данных)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает окно определения среды окружения формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/80.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Code Window (Окно кода)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает   окно   просмотра   исходного   кода формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/81.jpg" width="16" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Color Palette Toolbar
(Панель инструментов Цветовая палитра)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает   на   экране   панель   инструментов Color Palette (Цветовая палитра)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/82.jpg" width="16" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Form Builder
(Построитель формы)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Вызывает построитель формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/83.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Properties Window
(Окно свойств)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает  на экране  окно  свойств  объектов формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/84.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Form Controls Toolbar
(Панель инструментов Элементы управления формы)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Вызывает на экран панель инструментов FormControls (Элементы управления формы)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/85.jpg" width="17" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Layout
(Расположение)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Вызывает на экран панель инструментов Layout(Расположение)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/86.jpg" width="18" height="17">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Auto Format
(Авто формат)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Вызывает   построитель   авто формата  для   выбранных объектов формы

</TD>
</TR>
</TABLE>
<P>
Для выравнивания объектов, размещенных в форме, удобно использовать панель инструментов Layout (Расположение). Краткое назначение 
кнопок данной панели приведено в табл. 6.3.
</P>
<P>
Таблица 6.3. Кнопки панели инструментов Layout
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Кнопка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/87.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Align Left Sides (По
левому краю)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выравнивает   выбранные   объекты   по   левому краю самого левого объекта

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/88.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Align Top Edges (По
верхнему краю)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выравнивает выбранные объекты по верхнему краю самого верхнего объекта

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/89.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Align Right Sides (По
правому краю)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выравнивает  выбранные  объекты   по   правому краю самого правого объекта

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/90.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Align Bottom Edges
(По нижнему краю)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выравнивает выбранные  объекты  по  нижнему краю самого нижнего объекта

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/91.jpg" width="14" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Align Vertical Centers
(По вертикали)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выравнивает выбранные объекты по вертикали

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/92.jpg" width="17" height="14"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Align Horizontal Centers (По горизонтали)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выравнивает выбранные объекты по горизонтали

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/93.jpg" width="16" height="14"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Center Vertically (По
вертикальному центру)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Центрирует   выбранные   объекты   относительно вертикальной средней линии формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/94.jpg" width="16" height="14"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Center Horizontally (По
горизонтальному центру)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Центрирует   выбранные   объекты   относительно горизонтальной средней линии

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/95.jpg" width="17" height="13"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Same Width
(Одинаковая ширина)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Устанавливает одинаковую ширину для выбранных объектов формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/96.jpg" width="17" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Same Size
(Одинаковый размер)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Устанавливает одинаковую ширину и высоту для выбранных объектов формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/97.jpg" width="13" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Same Height
(Одинаковая высота)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Устанавливает одинаковую высоту для выбранных объектов формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/98.jpg" width="17" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Send to Back (Позади)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Направляет выбранный объект на самый нижний слой формы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/99.jpg" width="17" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Bring to From (Поверх)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Направляет выбранный объект на самый верхний слой формы

</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="2"></a><font size="4">Создание формы </font>
</P>
<P>
Процесс создания формы включает следующие действия:</P>
<ul>
  <li>настройка параметров формы; </li>
  <li>определение среды окружения, т. е. выбор используемых в форме таблиц и установка связей между ними; 
  </li>
  <li>размещение в форме объектов: текста, полей различных типов, линий, 
  рисунков, кнопок управления; </li>
  <li>настройка свойств размещенных в форме объектов. </li>
</ul>
<P>
Начнем создание формы в конструкторе форм с настройки ее параметров.
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Настройка параметров формы </font>
</P>
<P>
Форма, как и все располагаемые в ней объекты, имеет свойства, используя которые можно задать ее размер, координаты верхнего левого угла, 
стиль рамки обрамления, заголовок, цвет и т. д.
</P>
<P>
Настройка параметров формы осуществляется в окне свойств Properties(Свойства), для открытия которого установите курсор на свободную от объектов поверхность формы, нажмите правую кнопку мыши и выберите 
из контекстного меню команду Properties (Свойства).
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Расположение формы </font>
</P>
<P>
Новая форма по умолчанию располагается в верхнем левом углу основного окна 
Visual FoxPro. Для изменения ее положения можно использовать свойства Left (Левый) и тор (Верхний), указывающие расстояние в 
пикселях от левого и верхнего края, соответственно, а также мышь. При 
использовании мыши для изменения положения формы установите курсор на заголовок
формы, нажмите кнопку мыши и, удерживая ее, переместите форму в окне 
конструктора в место ее предполагаемого расположения (рис. 6.3).
</P>
<P>
Для изменения размера формы можно использовать свойства Height(Высота) и widht (Ширина), определяющие высоту и ширину формы, 
а также мышь. При использовании мыши для изменения размера формы установите курсор в ее нижний правый угол. Когда он примет вид двунаправленной стрелки, нажмите кнопку мыши и, удерживая ее, измените 
размер формы. Установив необходимый размер, отпустите кнопку мыши.
</P>
<IMG src="gl6-3.jpg" alt="gl6-3.jpg" width="500" height="389"></IMG>
<P>
Рис. 6.3. Расположение формы в центре главного окна Visual FoxPro
</P>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для размещения формы в центре главного окна Visual FoxPro необходимо в окне свойств установить для свойства AutoCenter (Авто 
центр) значение True(Истина). </font>
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Заголовок формы </font>
</P>
<P>
Для задания текста заголовка формы, располагающегося в строке заголовка, 
предназначено свойство Caption (Надпись) окна свойств. Чтобы отредактировать заголовок, откройте окно Properties (Свойства), выделите 
свойство Caption (Надпись) и в поле ввода, ставшее активным, введите заголовок 
формы.
</P>
<P>
Если вы хотите, чтобы форма вообще не содержала заголовок, установителя свойства TitieBar (Строка заголовка) значение off (Выкл.)</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Стиль обрамления формы </font>
</P>
<P>
Стиль обрамления формы задается с помощью свойства Borderstyle (Стиль рамки) и может принимать значения, описанные в табл. 6.4.
</P>
<P>
Таблица 6.4. Значения стиля обрамления формы
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Значение

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

0-No border (Нет рамки)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Форма не имеет рамки

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

1-Fixed  Single (Одинарная рамка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Неизменяемая одинарная рамка

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

2-Fixed  Dialog (Двойная рамка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Неизменяемая двойная рамка

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

3-Sizable    (Default)(Изменяемая)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Изменяемая рамка (размеры формы можно изменять при выполнении)

</TD>
</TR>
</TABLE>
<P>
Свойство BackCoior (Цвет фона) позволяет задать цвет фона формы.
</P>
<P>
Свойство windowstate (Состояние окна) определяет размер формы при ее вызове и может принимать одно из значений, описанных в табл. 6.5.
</P>
<P>
Таблица 6.5. Значения свойства windowstate
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Значение

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Normal (Обычное)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Форма имеет размеры,  определенные  его свойствами

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Minimized   (Windows   only)(Минимизированное)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Форма сворачивается в значок

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Maximized (Максимизированное)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Форма распахивается на весь экран

</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="7"></a><font size="4">Среда окружения формы </font>
</P>
<P>
При создании формы, предназначенной для редактирования или просмотра информации, содержащейся в таблицах, в конструкторе форм 
необходимо определить среду окружения, т. е. задать таблицы, используемые в форме, 
и установить связи между ними.
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">При создании форм с помощью мастера и размещении объектов в форме с помощью построителя среда окружения создается Visual FoxPro без 
участия разработчика. </font>
</P>
<P>
При определении среды окружения вы выполняете следующие действия:</P>
<ul>
  <li>добавляете все таблицы, используемые в форме;</li>
  <li>устанавливаете для таблиц индексы; </li>
  <li>устанавливаете между таблицами отношения, необходимые для создания формы. 
  </li>
</ul>
<P>
Вся эта информация, относящаяся к среде окружения, хранится в файле описания формы.
</P>
<P>
Для создания среды окружения формы предназначено диалоговое окно DataEnvironment 
(Среда окружения), открыть которое можно одним из следующих способов:
</P>
<ul>
  <li>выбрать команду Data Environment (Среда окружения)  из  меню View(Вид); 
  </li>
  <li>нажать кнопку Data Environment (Среда окружения) на панели инструментов Form Designer (Конструктор форм); 
  </li>
  <li>выбрать команду контекстного меню формы Data Environment (Среда окружения). 
  </li>
</ul>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">При открытии окна среды окружения Data Environment (Среда окружения) 
в основное меню добавляется соответствующий пункт. </font>
</P>
<P>
Для работы в окне Data Environment (Среда окружения) можно использовать команды из меню Data Environment (Среда окружения) или контекстное меню (рис. 6.4), позволяющие добавить в окружение таблицы, просмотреть 
их в режиме Browse (Обзор), открыть окно свойств окружения для задания различных параметров.
</P>
<P>
Для добавления новой таблицы в среду окружения можно выполнить одно из следующих действий:
</P>
<ul>
  <li>выбрать команду контекстного меню Add (Добавить); </li>
  <li>выбрать команду Add (Добавить) из меню Data Environment (Среда окружения). 
  </li>
</ul>
<P>
При этом открывается диалоговое окно Add Table or View (Добавить таблицу или представление данных) (рис. 6.5), содержащее список таблиц 
открытой базы данных. Опция Views 
(Представления данных) области Select (Выбор)позволяет разместить в среде 
окружения созданные в базе данных представления данных.
</P>
<IMG src="gl6-4.jpg" alt="gl6-4.jpg" width="500" height="389"></IMG>
<P>
Рис. 6.4. Диалоговое окно Data Environment с контекстным меню
</P>
<IMG src="gl6-5.jpg" alt="gl6-5.jpg" width="247" height="273"></IMG>
<P>
Рис. 6.5. Диалоговое окно Add Table or View
</P>
<P>
После размещения таблиц в среде окружения формы вам необходимо упорядочить данные, находящиеся в таблицах. Для этого выполните 
следующие действия:
</P>
<ol>
  <li>Выделите таблицу, в которой хотите упорядочить данные. </li>
  <li>Откройте окно свойств таблицы. Для этого установите на нее курсор, нажмите правую кнопку мыши и выберите из контекстного меню команду Properties (Свойства). 
  </li>
  <li>Выделите свойство Order (Упорядочение). </li>
  <li>В поле коррекции свойства нажмите кнопку раскрытия списка. Из списка индексов таблицы выберите тот, по которому хотите 
  упорядочить данные в форме. </li>
</ol>
<P>
При размещении в форме связанных таблиц они переносятся в окружение формы вместе со связями, установленными в базе данных. Вам 
необходимо убедиться, что связи установлены должным образом. Для этого выполните 
следующие действия:
</P>
<ol>
  <li>Выделите линию, соединяющую таблицы. При этом в окне Properties(Свойства) 
будут отображаться свойства, характеризующие установленную между таблицами связь. 
  </li>
</ol>
<IMG src="gl6-6.jpg" alt="gl6-6.jpg" width="500" height="445"></IMG>
<P>
Рис. 6.6. Диалоговое окно Data Environment с размещенными таблицами
</P>
<ol>
  <li value="2">Проверьте, какая из таблиц является родительской, а какая дочерней 
  по отношению к ней. Для этого просмотрите свойства ChildAlias(Дочерняя таблица) и 
  ParentAlias (Родительская таблица). </li>
  <li>Посмотрите выражение, используемое для связи таблиц, воспользовавшись свойством 
  RelationalExpr (Выражение отношения). Оно должно совпадать с выражением, используемым при создании индекса, по которому таблицы связаны. 
  </li>
</ol>
<P>
На рис. 6.6 представлено диалоговое окно Data Environment (Среда окружения) с размещенными в нем таблицами customer и Phoncust и 
открытым окном свойств для установленной между таблицами связи.
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Последовательность действий при настройке параметров формы </font>
</P>
<P>
Теперь рассмотрим последовательность действий для определения окружения и задания основных свойств формы.
</P>
<ol>
  <li>Откройте проект Sales. </li>
  <li>Выберите вкладку Documents (Документы), перейдите в окне проекта в группу Forms (Формы) и нажмите кнопку New (Новая). 
  </li>
  <li>В открывшемся диалоговом окне New Form (Новая форма) выберите опцию New Form (Новая форма). Откроется окно конструктора форм 
  для создания новой формы. </li>
  <li>Откройте окно окружения формы Data Environment (Среда окружения),выбрав команду Data Environment (Среда окружения) из меню View (Вид). 
  </li>
  <li>Для размещения таблицы в среде окружения выберите команду Add(Добавить) из меню Data Environment (Среда окружения). 
  </li>
  <li>В открывшемся диалоговом окне Add Table or View (Добавить таблицу или представление данных) выберите из списка таблиц открытой 
  базы данных таблицу, для которой создаете форму, и нажмите кнопку ОК. </li>
  <li>Откройте окно свойств таблицы, размещенной в окне окружения. Для этого установите на нее курсор, нажмите правую кнопку мыши и выберите из контекстного меню команду Properties (Свойства), 
  </li>
  <li>Выделите свойство order (Упорядочение). Для упорядочения данных форме в поле коррекции свойства нажмите кнопку раскрытия списка 
  и из списка индексов таблицы выберите индекс, по которому хотите упорядочить данные. 
  </li>
  <li>Закройте окно определения среды окружения. </li>
  <li>Для задания свойств формы установите курсор в форму, нажмите правую кнопку 
мыши и выберите из контекстного меню команду Properties(Свойства). Открывается 
окно Properties (Свойства). В его верхнем списке, указывающем название объекта, для которого осуществляется настройка свойств, содержится текст 
  Form1 (Форма 1). </li>
  <li>В окне Properties (Свойства) скорректируйте свойство caption (Надпись), введя в текстовом поле заголовок формы. 
  </li>
  <li>Задайте цвет фона формы. Для этого используйте свойство формы BackColor (Цвет фона). Щелкните на нем мышью. 
  Затем нажмите расположенную с правой стороны поля редактирования свойства кнопку ив открывшемся диалоговом окне Цвет выберите цвет, который 
  хотите использовать для фона. </li>
  <li>Свойство     AutoCenter     (Автоцентр)     должно иметь значение       True
(Истина), чтобы форма располагалась в центре экрана. </li>
  <li>Для изменения размера формы установите курсор в ее нижний правый угол. Когда он примет вид двунаправленной стрелки, нажмите 
  кнопку мыши и, удерживая ее, измените размер формы. Установив необходимый размер формы, отпустите кнопку мыши. 
  </li>
  <li>Измените свойства FontName (Наименование шрифта), Fontsize (Размер шрифта), 
выбрав подходящий шрифт из установленных на вашем компьютере и его размер. </li>
  <li>Сохраните форму на диске. </li>
</ol>
<p>&nbsp;
<a NAME="9"></a><font size="4">Размещение объектов в форме </font>
</P>
<P>
После того как вы определили параметры формы, разместили в окружении 
используемые таблицы, можно приступать к размещению объектов в форме.
</P>
<p>&nbsp;
<a NAME="10"></a><font size="4">Размещение полей таблиц и надписей к ним с использованием 
построителя формы </font>
</P>
<P>
Для размещения в форме полей таблицы и надписей к ним в конструкторе форм можно использовать построитель формы.
</P>
<P>
Чтобы запустить построитель форм, выберите команду Builder (Построитель)контекстного меню формы или нажмите кнопку Form Builder (Построитель 
формы) на панели инструментов Form Designer (Конструктор форм). Откроется диалоговое окно Form Builder (Построитель формы), содержащее 
две вкладки (табл. 6.6).
</P>
<P>
Таблица 6.6. Назначение вкладок окна Form Builder
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Вкладка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Field Selection
(Выбор поля)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выбор полей, которые будут размещены в форме (рис. 6.7)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Style (Стиль)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задание стиля отображения объектов формы (рис. 6.8)

</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl6-7.jpg" alt="gl6-7.jpg" width="445" height="308"></IMG> </p>
<P>
Рис, 6.7. Вкладка для выбора полей, размещаемых в форме с помощью построителя
</P>
<IMG src="gl6-8.jpg" alt="gl6-8.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.8. Вкладка для определения стиля объектов, размещаемых с помощью построителя
</P>
<P>
Используя вкладку Field Selection (Выбор поля) диалогового окна FormBuilder (Построитель формы), сформируйте список полей таблицы, размещаемых в форме. Для этого из верхнего списка области Databases and tables
</P>
<P>
(Базы данных и таблицы) выберите необходимую базу данных, а из нижнего — таблицу, поля которой размещаете в форме. Затем из списка Availablefields (Имеющиеся поля) перенесите в Selected fields (Выбранные поля) поля, которые вы хотите разместить в создаваемой форме. Для переноса 
полей используйте кнопки, расположенные между списками.
</P>
<P>
Сформировав список полей, перейдите на вкладку Style (Стиль). Используя 
расположенный здесь список Style (Стиль), задайте стиль оформления объектов, размещаемых в форме. Завершив установку параметров на 
обеих вкладках, нажмите кнопку ОК. В форме будут размещены поля и надписи к ним (рис. 6.9).
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Построитель может размещать в форме все поля, включая также поля 
типа General. </font>
</P>
<IMG src="gl6-9.jpg" alt="gl6-9.jpg" width="500" height="166"></IMG>
<P>
Рис. 6.9. Форма с объектами, размещенными с помощью построителя
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">При размещении в форме объектов с помощью построителя нет 
необходимости размещать таблицы в окне окружения, т. к. их разместит там сам 
построитель<span lang="en-us">.</span></font></P>
<p>&nbsp;
<a NAME="11"></a><font size="4">Текстовая информация </font>
</P>
<P>
Размещение в форме текста (заголовков, надписей к полям, поясняющей информации) 
осуществляется с помощью кнопки Label (Метка), находящейся на панели инструментов Form Controls (Элементы 
управления формы).
</P>
<P>
Для размещения текста выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Label (Метка) на панели инструментов Form Controls(Элементы управления формы). Если данная панель отсутствует на экране, 
для ее отображения выберите в меню View (Вид) команду Form Controls Toolbar (Панель элементов управления формы). 
  </li>
  <li>Установите указатель мыши на место предполагаемого расположения текстового объекта и нажмите кнопку мыши. В форме появляется 
  объект, в названии которого содержится слово Label1. </li>
  <li>Для открытия окна свойств созданного объекта выделите его и выберите из контекстного меню команду Properties (Свойства).  Откроется 
  окно Properties (Свойства). </li>
  <li>Фон текстового объекта определяется свойством Backstyle (Стиль фона).Если вы хотите, чтобы фон текста не отличался от фона формы, установите 
  для свойства BackStyle (Стиль фона) значение Transparent 
(Прозрачный). </li>
  <li>Текст задается свойством caption (Надпись). Выделите данное свойство, 
  после чего в поле ввода свойства введите нужную текстовую информацию и нажмите клавишу &lt;Enter&gt;. 
  </li>
  <li>Задайте с помощью свойств FontName (Наименование шрифта) и Fonsize (Размер шрифта) вид и размер шрифта. 
  </li>
  <li>Используя свойство ForeColor (Цвет надписи), задайте цвет текстовой 
  информации. </li>
  <li>Скорректируйте размер объекта, чтобы в нем помещалась вся надпись. Для этого используйте маркеры выделения или установите значение True(Истина) в поле свойства AutoSize (Авто 
  размер). </li>
</ol>
<p>&nbsp;
<a NAME="12"></a><font size="4">Поле ввода </font>
</P>
<P>
Для отображения информации из таблиц в форме используются поля различных типов. 
Наиболее простым типом поля является поле ввода. Для размещения поля ввода в форме выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Text Box (Поле ввода) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Щелкнете в том месте формы, в котором вы предполагаете расположить поле ввода. 
  </li>
  <li>Откройте окно свойств для созданного объекта. </li>
  <li>Чтобы связать созданное поле с полем таблицы, выберите на вкладке Dta (Данные) свойство Controisource (Источник данных). В поле 
  ввода свойства 
воспользуйтесь кнопкой раскрытия списка и из списка всех полей открытой таблицы выберите поле, которое хотите добавить в форму(рис. 6.10). 
  </li>
</ol>
<IMG src="gl6-10.jpg" alt="gl6-10.jpg" width="500" height="433"></IMG>
<P>
Рис. 6.10. Связывание поля формы с полем таблицы
</P>
<ol>
  <li value="5">Используя свойство Alignment (Выравнивание), задайте вариант выравнивания информации в поле: по центру, по левому или правому 
  краю поля. </li>
  <li>Для задания стиля и цвета рамки поля используйте свойства Borderstyle(Стиль рамки) и 
  BorderColor (Цвет рамки) соответственно. </li>
  <li>С помощью свойства DisabiedBackCoior (Цвет фона неактивного поля)задайте цвет фона неактивного поля. 
  </li>
  <li>Применяя свойство comment (Описание), вы можете задать краткое описание назначения размещенного объекта. Это описание будет 
  полезно при разработке приложения и его сопровождении. </li>
  <li>Используя свойства     FontName     (Наименование     Шрифта)     и FontSize
(Размер шрифта), задайте используемый при отображении информации шрифт и его размер. 
  </li>
  <li>С помощью свойства ForeColor (Цвет надписи) задайте цвет, которым будет отображаться информация в поле ввода. 
  </li>
  <li>Для отображения полей ввода в заданном формате используйте свойство Format (Формат). 
  </li>
</ol>
<blockquote>
<P>
Допустимые форматы и их назначения приведены в табл. 6.7.
</P>
</blockquote>
<P>
Таблица 6.7. Форматы данных
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Код

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<span lang="en-us">!</span></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Преобразует буквы к верхнему регистру

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

$

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выводит на экран текущий денежный символ

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<span lang="en-us">^</span>

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает числа в экспоненциальном виде

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

А

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Разрешает ввод только текстовых символов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

D

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Для редактирования данных типа даты использует текущий формат
SET   DATE (например, BRITISH, GERMAN и т. д.)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Е

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Редактирует данные, рассматривая их как европейские (BRITISH) даты

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

К

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выделяет все поле целиком, когда курсор перемещается в данное поле

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

L

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает ведущие нули при их выводе в поле ввода

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

М

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает несколько предопределенных значений на выбор

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

R

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит маску формата для поля ввода. Символы маски отображаются на экране, но не сохраняются в источнике данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Т

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Удаляет начальные и конечные пробелы в форме

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

YS

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает дату в кратком формате, используя установки Windows

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

YL

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает дату в полном формате, используя установки Windows

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Z

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает 0 как пробел, за исключением случая, когда фокус установлен на объекте

</TD>
</TR>
</TABLE>
<ol>
  <li value="12">Свойство inputMask (Маска ввода) позволяет задать шаблон. 
  Символы, которые могут быть использованы в шаблоне, представлены в табл. 6.8. 
  </li>
</ol>
<P>
Таблица 6.8. Коды шаблонов PICTURE
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Код

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

X

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Допускает ввод любых символов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

9

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

В случае символьных данных позволяет вводить только цифры. В случае числовых данных позволяет вводить цифру и знак

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

#

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Позволяет вводить цифры, пробелы и знак

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

$

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выводит на экран текущий денежный символ (определяемый при помощи команды SET CURRENCY). 
По умолчанию этот символ помещается непосредственно до или после поля. Однако денежный символ и 
его позиция (SET CURRENCY), разделительный символ (SET SEPARATOR) и символ десятичного знака (SET POINT) могут быть переопределены

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

$$

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает плавающий денежный символ, положение которого определяется расположением цифр в поле ввода или счетчике

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

*

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Перед числовыми значениями выводятся звездочки. Используется со знаком доллара $

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">



.</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает позицию десятичной точки

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

,

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Используется для отделения цифр, стоящих слева от десятичной точки

</TD>
</TR>
</TABLE>
<ol>
  <li value="13">Если вы создаете поле, информация которого должна быть доступна 
  только для чтения, необходимо установить значение свойства Readonly(Только чтение) равным True (Истина). 
  </li>
  <li>Используя свойство specialEffect (Специальный эффект), задайте стиль отображения поля из трех предложенных вариантов: обычный, 
  с эффектом объемности или принимающий объемный вид при перемещении курсора мыши над ним. 
  </li>
  <li>Для поля можно задать длинные поясняющие надписи, выводимые в строку состояния при установке на поле курсора мыши. Для этого используется свойство statusBarText (Текст строки состояния). 
  На рис. 6.11 представлена форма с полем код клиента, при определении которого было использовано данное свойство. 
  </li>
  <li>Visual FoxPro позволяет с помощью свойства ToolTipText (Текст подсказки) создавать текст краткого пояснения, появляющийся ниже курсора, когда он установлен на поле. Чтобы текст заданного поясненияотображался, установите для свойства 
  ShowTips (Показывать подсказки)формы значение True (Истина). </li>
  <li>При добавлении новой записи в поле по умолчанию можно вводить наиболее часто 
встречающееся значения. Для этого используется свойство value (Значение). </li>
</ol>
<IMG src="gl6-11.jpg" alt="gl6-11.jpg" width="500" height="378"></IMG>
<P>
Рис. 6.11. Отображение в строке состояния информации, задаваемой свойством StatusBarText
</P>
<p>&nbsp;
<a NAME="13"></a><font size="4">Использование построителя для создания поля ввода </font>
</P>
<P>
В Visual FoxPro для большинства размещаемых в форме объектов имеются построители объектов, которые помогут вам при настройке их свойств. Рассмотрим использование построителя для создания в форме поля ввода.
</P>
<P>
Для размещения в форме поля ввода с помощью построителя выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Text Box (Поле ввода) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Щелкните в том месте формы, в котором вы предполагаете разместить поле. При этом поле ввода примет размер по умолчанию. Если вы 
  хотите определить размер поля ввода при его размещении, нажмите кнопку мыши и, не отпуская ее, нарисуйте рамку требуемого размера. 
  </li>
  <li>Для запуска построителя нажмите правую кнопку мыши и выберите команду контекстного меню Builder (Построитель). Открывается 
  диалоговое окно Text Box Builder (Построитель поля ввода) (рис. 6.12), содержащее вкладки Format (Формат), Style (Стиль) и Value (Значение). Используя данное диалоговое окно, вы можете задать формат, стиль 
  оформления поля и связать его с полем таблицы. </li>
</ol>
<IMG src="gl6-12.jpg" alt="gl6-12.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.12. Вкладка Format позволяет задать формат поля ввода
</P>
<P>
<font color="#008000"><b>Замечание </b></font>
</P>
<P>
<font color="#008000">Используя построитель, вы можете не только разместить поле, но и 
изменить свойства поля, уже размещенного в форме. </font>
</P>
<ol>
  <li value="4">Вкладка Format (Формат) содержит раскрывающийся список Data Type(Тип данных), используя который вы можете задать тип данных поля. 
  На вкладке также расположены флажки, описанные в табл. 6.9. </li>
</ol>
<P>
Таблица 6.9. Назначение флажков вкладки Format
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Флажок

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Enable at run time
(Доступно для ввода)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Устанавливает признак разрешения доступа к полю ввода при запуске формы. Данный флажок 
связан со свойством объекта Enabled (Доступен)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Alphabetic characters only
{Только буквы алфавита)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Разрешает ввод в поле только букв, что равносильно установке для свойства Format (Формат) 
значения формата А

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Make read-only (Только для чтения)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Используется для запрета ввода данных в поле

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Select on entry (Выбор при входе)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При перемещении курсора в поле выделяет все поле целиком

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Hide selection (Скрывать выбор)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Устанавливает   свойство   объекта   HideSelection(Скрывать выбор), управляющее выделением объекта после того, как фокус с него перейдет на 
другой объект

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Display leading zeros
(Отображать ведущие нули)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображает ведущие нули  при  их выводе  в  поле ввода

</TD>
</TR>
</TABLE>
<blockquote>
<P>
В нижней части вкладки расположен раскрывающийся список для задания шаблона ввода данных. Вы можете ввести любой из возможных шаблонов или выбрать из списка.
</P>
</blockquote>
<ol>
  <li value="5">Установив параметры на вкладке Format (Формат), перейдите на 
  вкладку Style (Стиль) (рис. 6.13), чтобы задать стиль отображения создаваемого 
  поля. Она содержит четыре параметра (табл. 6.10). </li>
</ol>
<P>
Таблица 6.10. Назначение параметров вкладки Style
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Параметр

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Special effect
(Специальный эффект)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Этот переключатель содержит опции 3D (Объемный) или Plain (Плоский). При выборе значения   3D(Объемный) поле будет иметь объемный вид. Определяет значение свойства SpecialEffect   (Специальный эффект)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Border (Рамка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Данный переключатель позволяет установить одно из двух значений:  single или None. 
Определяет значение свойства BorderStyle (Стиль рамки)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Character alignment
(Выравнивание символов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Этот список  позволяет задать тип  выравнивания данных внутри поля и определяет значения свойства Alignment (Выравнивание)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Size text box to fit
(Подходящий размер поля ввода)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке данного флажка ширина поля определяется автоматически на основе шаблона 
ввода или длины поля источника данных

</TD>
</TR>
</TABLE>
<ol>
  <li value="6">Для связывания поля ввода с полем таблицы перейдите на вкладку Value(Значение) (рис. 6.14). Из раскрывающегося списка Field name (Имя поля) выберите поле таблицы, с которым хотите связать поле ввода. 
  </li>
  <li>После установки всех параметров, для завершения формирования свойств поля ввода нажмите кнопку ОК. 
  </li>
</ol>
<IMG src="gl6-13.jpg" alt="gl6-13.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.13. Окно, предназначенное для установки параметров стиля поля
</P>
<IMG src="gl6-14.jpg" alt="gl6-14.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.14. Связывание создаваемого поля с полем таблицы
</P>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для автоматического вызова построителя при размещении объектов в 
форме необходимо на панели инструментов Form Controls (Элементы управления формы) нажать кнопку Builder Lock (Закрепитель построителя).
</font>
</P>
<p>&nbsp;
<a NAME="14"></a><font size="4">Поле редактирования </font>
</P>
<P>
Поля Edit Box (Поле редактирования) очень удобны для редактирования символьных полей большого размера и Memo-полей. Чтобы разместить 
поле редактирования в форме, выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Edit Box (Поле редактирования) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Щелкните в том месте формы, где вы предполагаете разместить поле редактирования. 
  </li>
  <li>Откройте окно свойств Properties (Свойства) для размещенного объекта. 
  </li>
  <li>При использовании поля данного типа для просмотра и редактирования полей 
большого размера, в его правой части можно расположить вертикальную полосу прокрутки, предназначенную для просмотра информации, 
не поместившейся в окне просмотра. Для этого необходимо в свойстве scrollsars (Полоса прокрутки) задать значение vertical 
(Вертикальная). При установке значения None (Нет) полоса прокрутки у поля будет отсутствовать. 
  </li>
</ol>
<P>
Остальные свойства поля редактирования аналогичны свойствам поля ввода,
которые описаны выше.
</P>
<p>&nbsp;
<a NAME="15"></a><font size="4">Кнопки управления </font>
</P>
<P>
Как правило, в полях формы отображается информация об одной записи. Для просмотра всех записей таблицы необходимо добавить в форму 
средства перемещения по записям. В Visual FoxPro имеются удобные инструменты, 
предназначенные для этих целей, — кнопки.
</P>
<P>
Для размещения кнопок управления в форме можно использовать две кнопки панели инструментов Form Controls (Элементы управления формы) (табл. 6.11).
</P>
<P>
Таблица 6.11. Кнопки панели инструментов Form Controls
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Кнопка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Command Button (Кнопка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создание одиночной кнопки

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Command Group (Группа кнопок)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создание набора кнопок

</TD>
</TR>
</TABLE>
<P>
<b>Размещение одиночных кнопок </b>
</P>
<P>
Для размещения в форме одной кнопки выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Command Button (Кнопка) на панели инструментов Form Controls (Элементы управления формы) и щелкните мышью в 
  месте предполагаемого размещения создаваемой кнопки. </li>
  <li>Откройте окно свойств созданного объекта. </li>
  <li>Кнопка может содержать текст или графическое изображение. При создании 
кнопки, содержащей текст, скорректируйте свойство Caption(Надпись), разместив в 
поле ввода значения текст, который будет отображаться на кнопке.  Например, при создании кнопки для 
  закрытия формы введите Выход. </li>
  <li>При создании кнопки, содержащей графическое изображение, для задания 
  изображения, размещаемого на кнопке, воспользуйтесь свойством picture. Нажмите кнопку, расположенную справа от поля ввода значения 
  свойства. В результате откроется диалоговое окно Open (Открыть) (рис. 6.15), используя которое, вы можете выбрать файл на диске, содержащий изображение, 
  и просмотреть его в области Picture (Изображение). Чтобы это можно было 
  сделать, необходимо установить флажок Preview (Просмотр). После выбора файла нажмите кнопку ОК для перенесения изображения на кнопку. 
  </li>
</ol>
<IMG src="gl6-15.jpg" alt="gl6-15.jpg" width="500" height="249"></IMG>
<P>
Рис. 6.15. Диалоговое окно Open, предназначенное для выбора изображения на кнопке
</P>
<ol>
  <li value="5">Кнопка размещена в форме. Теперь необходимо, используя автоматически вызываемый при нажатии на кнопку метод объекта click (Нажатие),определить действия, выполняемые при нажатии на эту кнопку. Отобразите 
в окне свойств объекта список всех методов. Для этого в окне Properties (Свойства) выберите вкладку Methods (Методы). 
  </li>
  <li>Установите курсор на метод click (Нажатие) и щелкните мышью. На экране откроется окно процедур (рис. 6.16). 
  </li>
  <li>Введите команды, которые должны выполняться при нажатии на данную кнопку. Например, если вы создаете кнопку для выхода из формы, 
  это могут быть следующие команды, использующие функцию MESSAGEBOX {): </li>
</ol>
<blockquote>
<P>
* Запрос для выхода из формы
</P>
<P>
IF MESSAGEBOX(&quot;Выходить из формы?&quot;, 4+32+256, &quot;Выход&quot;)=6
</P>
<P>
_screen.ActiveForm.Release{)
</P>
<P>
ELSE
</P>
<P>
_screen.ActiveForm.Refresh()
</P>
<P>
ENDIF
</P>
</blockquote>
<ol>
  <li value="8">Закройте окно процедур. Кнопка создана. </li>
</ol>
<IMG src="gl6-16.jpg" alt="gl6-16.jpg" width="500" height="443"></IMG>
<P>
Рис. 6.16. Окно процедур для метода Click
</P>
<P>
<b>Редактирование составных объектов </b>
</P>
<P>
Некоторые объекты Visual FoxPro, такие как commandGroup (Группа кнопок)и optionGroup (Переключатель), являются составными объектами, т. к. 
они содержат несколько объектов, имеющих свои собственные свойства. Для работы с составными объектами Visual FoxPro предоставляет в распоряжение разработчика контекстное меню, содержащее команду Edit (Правка),переводящую объект в режим редактирования и позволяющую 
управлять входящими в его состав простыми объектами: перемещать их внутри рамки, 
изменять размеры, цвет, настраивать другие свойства. В режиме редактирования вокруг составного объекта появляется заштрихованная рамка(рис. 6.17).
</P>
<P>
Для выхода из режима редактирования необходимо щелкнуть вне области составного объекта.
</P>
<IMG src="gl6-17.jpg" alt="gl6-17.jpg" width="500" height="601"></IMG>
<P>
Рис. 6.17. Объект CommandGroup в режиме редактирования
</P>
<P>
<b>Создание группы кнопок </b>
</P>
<P>
Для размещения в форме группы из нескольких кнопок можно использовать инструмент Command Group (Группа кнопок) на панели 
инструментов Form Controls (Элементы управления формы). Создаваемый при этом 
объект является составным и обладает свойством ButtonCount (Количество кнопок), определяющим количество входящих в его состав кнопок.
</P>
<P>
Воспользуемся данным инструментом для размещения в форме кнопок перемещения по записям таблицы и кнопки выхода из формы.
</P>
<ol>
  <li>Для создания набора кнопок нажмите кнопку Command Group (Группа кнопок) на панели инструментов Form Controls (Элементы 
  управления формы) и щелкните в месте их предполагаемого размещения в форме. 
  </li>
  <li>Откройте окно свойств для размещенного составного объекта. </li>
  <li>Свойство ButtonCount (Количество кнопок) объекта определяет количество кнопок, размещаемых в объекте (по умолчанию 2). 
  Скорректируйте его, задав необходимое количество кнопок, например 5. </li>
  <li>Увеличьте с помощью мыши размеры рамки, окружающей созданный объект, чтобы в ней можно было расположить горизонтально все 
  пять кнопок. </li>
  <li>Переведите объект в режим редактирования. Для этого установите на него курсор, нажмите правую кнопку мыши и выберите из 
  контекстного меню команду Edit (Редактировать). </li>
  <li>Выделяя поочередно кнопки, переместите их, расположив горизонтально в одну линию. 
  </li>
  <li>Выйдите   из   режима   редактирования,   щелкнув   вне   области   объекта
CommandGroup   (Группа кнопок). </li>
  <li>Скорректируйте размер рамки, окружающей составной объект. </li>
</ol>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для более точного задания размера рамки составного объекта выделите свойство AutoSize (Авто 
размер) и установите для него значение True (Истина). </font>
</P>
<ol>
  <li value="9">Откройте окно свойств объекта типа CommandGroup (Группа кнопок).Нажмите 
кнопку раскрытия списка в верхней части данного окна(рис. 6.18). Отметьте, что 
этот список содержит все объекты, размещенные в форме, а также все элементы, входящие в составной объект, под
именами   Command1,   Command2,   Command3,   Comman<span lang="en-us">d</span>4,   
  Command<span lang="en-us">5</span>.   Выбирая
поочередно элементы в этом списке, можно изменить свойства каждой кнопки. </li>
</ol>
<IMG src="gl6-18.jpg" alt="gl6-18.jpg" width="500" height="450"></IMG>
<P>
Рис. 6.18. Окно свойств объекта типа CommandGroup
</P>
<ol>
  <li value="10">Используя свойство Caption (Надпись) каждого элемента 
  составного объекта, задайте названия кнопок: Первая, Следующая, Предыдущая, 
  Последняя и Выход. </li>
  <li>Для задания цвета фона, на котором располагаются кнопки, используйте 
  свойство Backcolor (Цвет фона) объекта CommandGroup (Группа кнопок).Если вы хотите, чтобы он совпадал с цветом фона формы, установите 
  для свойства Backstyle (Стиль фона) значение Transparent (Прозрачный). </li>
  <li>Теперь необходимо определить команды, которые будут выполняться при нажатии на данные кнопки. Для этого, открывая поочередно 
  окно процедур метода click (Нажатие) каждого элемента, входящего в составной объект, введите следующие команды: 
  </li>
</ol>
<ul>
  <li>&nbsp;для кнопки Первая: </li>
</ul>
<blockquote>
<P>
* Переходим на первую запись и обновляем информацию в форме<span lang="en-us">
</span>
</P>
<P>
IF !BOF()</P>
<P>
GO TOP</P>
<P>
ENDIF</P>
<P>
_screen.ActiveForm.Refresh()
</P>
</blockquote>
<ul>
  <li>для кнопки Следующая: </li>
</ul>
<blockquote>
<P>
* Переходим на следующую запись и обновляем информацию в форме</P>
<P>
IF !EOF()
</P>
<P>
SKIP</P>
<P>
ENDIF</P>
<P>
_screen.ActiveForm.Refresh(}
</P>
</blockquote>
<ul>
  <li>для кнопки Предыдущая: </li>
</ul>
<blockquote>
<P>
* Переходим на предыдущую запись и обновляем информацию в форме</P>
<P>
IF !BOF<span lang="en-us">(</span>)
</P>
<P>
SKIP <span lang="en-us">- </span>1</P>
<P>
ENDIF</P>
<P>
_screen. ActiveForm. Refresh ()
</P>
</blockquote>
<ul>
  <li>для кнопки Последняя: </li>
</ul>
<blockquote>
<P>
* Переходим на последнюю запись и обновляем информацию в форме</P>
<P>
IF !EOF()
</P>
<P>
GO BOTTOM</P>
<P>
ENDIF</P>
<P>
_screen.ActiveForm.Refresh(<span lang="en-us">)</span>
</P>
</blockquote>
<ul>
  <li>для кнопки Выход: </li>
</ul>
<blockquote>
<P>
* Запрашиваем и выходим, если Да
</P>
<P>
IF MESSAGEBOX(&quot;Выходить из формы?&quot;,4+32+256, &quot;Выход&quot;)=6
</P>
<P>
_screen.ActiveForm.Release()
</P>
<P>
ELSE
</P>
<P>
_screen.ActiveForm.Refresh()
</P>
<P>
ENDIF
</P>
</blockquote>
<ol>
  <li value="13">После ввода команд закройте окна процедур. </li>
  <li>Набор кнопок для перемещения по записям таблицы и выхода из формы создан. Запустите форму на выполнение по команде Run Form(Запустить форму) из меню Form (Форма). Для перемещения по 
  записям таблицы и закрытия формы используйте кнопки, находящиеся в нижней 
  части окна (рис. 6.19). </li>
</ol>
<IMG src="gl6-19.jpg" alt="gl6-19.jpg" width="500" height="456"></IMG>
<P>
Рис. 6.19. Форма с размещенной группой кнопок
</P>
<p>&nbsp;
<a NAME="16"></a><font size="4">Размещение изображений в форме </font>
</P>
<P>
В форме можно размещать различные изображения, используя кнопку Image (Изображение) на панели инструментов Form Controls (Элементы 
управления формы). Для размещения изображения в форме выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Image (Изображение) на панели инструментов FormControls (Элементы управления формы). 
  </li>
  <li>Установите указатель мыши в том месте формы, где собираетесь разместить изображение, и, удерживая кнопку мыши в нажатом состоянии, переместите курсор по диагонали так, чтобы получилась рамка 
  требуемого размера. </li>
  <li>Откройте окно свойств Properties (Свойства) для созданного объекта. Для 
  этого выделите его и выберите в контекстном меню команду Properties(Свойства). 
  </li>
  <li>Для задания имени графического файла предназначено свойство Picture(Изображение). Выберите данное свойство или нажмите кнопку, расположенную рядом с полем для ввода значения свойства. Откроется диалоговое окно Open (Открыть) (рис. 6.20). 
  </li>
</ol>
<IMG src="gl6-20.jpg" alt="gl6-20.jpg" width="500" height="249"></IMG>
<P>
Рис. 6.20. Диалоговое окно Open для выбора графического изображения
</P>
<ol>
  <li value="5">Выберите графический файл. Просмотрите его в области Picture(Изображение), 
установив флажок Preview (Просмотр), и нажмите кнопку ОК. Изображение разместится в форме (рис. 6.21). 
  </li>
</ol>
<IMG src="gl6-21.jpg" alt="gl6-21.jpg" width="500" height="448"></IMG>
<P>
Рис. 6.21. Размещение графического изображения в форме
</P>
<ol>
  <li value="6">Для настройки свойств размещенного в форме графического объекта 
  можно использовать свойство stretch (Масштабирование). Оно содержит три значения: 
  </li>
</ol>
<ul>
  <li>clip (Обрезать рисунок) — изображение размещается в форме, сохраняя свой исходный размер; 
  </li>
  <li>isometric  (Масштабировать,  сохраняя форму) —  изображение  масштабируется с сохранением пропорций; 
  </li>
  <li>stretch (Масштабировать, заполняя рамку) — изображение занимает отведенный ему размер без сохранения пропорций. 
  </li>
</ul>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Если вы захотите использовать изображение в качестве фона формы, прибегните к свойству Picture (Изображение) формы.
</font>
</P>
<p>&nbsp;
<a NAME="17"></a><font size="4">Размещение в форме объекта типа General </font>
</P>
<P>
Размещение графического поля типа General (Общий) рассмотрим на<span lang="en-us">
</span>примере таблицы Goods, содержащей список товаров базы данных sales. В таблице имеется поле данного типа с изображением товара, предлагаемого клиенту.
</P>
<ol>
  <li>Для добавления в форму графического поля типа General (Общий) нажмите кнопку ActiveX Bound Control (ActivX-объект) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Установите указатель мыши в место предполагаемого расположения поля 
  данного типа. Удерживая кнопку мыши нажатой, создайте рамку требуемого размера. 
  </li>
  <li>Откройте окно свойств для размещенного объекта. </li>
  <li>Используя свойство controisource (Источник данных), свяжите созданное поле с полем таблицы. Для этого в поле ввода свойства 
  нажмите кнопку раскрытия списка и из списка полей таблицы Goods выберите поле image 
(Изображение), имеющее тип General (Общий) и содержащее изображения товаров. 
  </li>
  <li>Запустите созданную форму на выполнение, выбрав в меню Form(Форма) команду Run Form (Запустить форму).  Если рисунок не помещается в рамке целиком, увеличьте размер рамки в конструкторе форм. 
  </li>
</ol>
<p>&nbsp;
<a NAME="18"></a><font size="4">Использование в форме флажков </font>
</P>
<P>
Для размещения в форме полей, которые могут иметь только одно из двух допустимых значений, используются объекты типа checkbox 
(Флажок), называемые флажками. Объекты данного типа могут использоваться в форме 
по одному или группами.
</P>
<P>
Рассмотрим следующий пример. Таблица со списком клиентов может содержать поле, указывающее, является ли данный клиент постоянным покупателем. При установке флажка значение в поле будет соответствовать 1, 
а при сбросе флажка — 0 (табл. 6.12).
</P>
<P>
Таблица 6.12. Значения свойства value объекта типа checkBox
в зависимости от установки флажка
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Вид флажка на экране

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Значение свойства Value

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/138.jpg" width="15" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

0

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/60.jpg" width="15" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

1

</TD>
</TR>
</TABLE>
<P>
Рассмотрим подробно процедуру создания флажка для редактирования поля, указывающего, является ли покупатель постоянным клиентом. Это 
поле имеет тип Logical (Логический) и может принимать значения 0 или 1.
</P>
<ol>
  <li>Откройте в окне конструктора проекта форму, позволяющую просматривать список клиентов. 
  </li>
  <li>Нажмите кнопку Check Box (Флажок) 0?J на панели инструментов FormControls (Элементы управления формы). 
  </li>
  <li>Щелкните в месте предполагаемого размещения флажка. Объект разместится в форме. 
  </li>
  <li>Откройте окно Properties (Свойства) для объекта типа checkBox(Флажок). 
  </li>
  <li>Для связывания флажка с полем таблицы скорректируйте свойство 
  controlsource (Источник данных), задав в качестве источника данных поле типа Logical (Логический) таблицы Customer. 
  </li>
  <li>Введите в поле свойства caption (Надпись) текст Постоянный покупатель. Данный текст будет размещен справа от флажка в окне конструктора форм, а также в форме. 
  </li>
  <li>Флажок создан. Запустите форму на выполнение. Для установки признака постоянного покупателя установите флажок (рис. 6.22). 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание </b></font>
</P>
<P>
<font color="#008000">Для размещенного в форме флажка вы можете скорректировать 
свойства ForeColor (Цвет надписи), BackStyle (Стиль фона) и FontName(Наименование шрифта), определяющие цвет, фон, наименование шрифта.
</font>
</P>
<IMG src="gl6-23.jpg" alt="gl6-23.jpg" width="500" height="456"></IMG>
<P>
Рис. 6.22. Использование в форме объекта типа CheckBox
</P>
<p>&nbsp;
<a NAME="19"></a><font size="4">Что такое переключатель </font>
</P>
<P>
Объекты типа Optioncroup (Переключатель) называются переключателями, т. к. они 
позволяют выбрать одно из нескольких значений поля или переменной. Переключатели широко используются не только в Visual FoxPro, 
но и в других приложениях Windows. Объекты типа optionGroup (Переключатель) представляют собой составные объекты, содержащие элементы, наделенные собственными свойствами, основные из которых приведены 
в табл. 6.13.
</P>
<P>
Таблица 6.13. Назначение основных свойств объекта типа optionGroup
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Свойство

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

ButtonCount  (Количество опций)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает количество опций в переключателе

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Style  (Стиль)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Определяет вид переключателя

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Left  (Слева), Тор (Сверху)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Расстояние между кнопками

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

BorderStyle  (Стиль обрамления)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Стиль обрамления

</TD>
</TR>
</TABLE>
<P>
Рассмотрим процесс создания переключателя для просмотра и редактирования поля, указывающего страну проживания клиента. Например, 
данное поле может принимать одно из трех значений: Россия/Украина/Беларусь.
</P>
<ol>
  <li>Откройте в конструкторе форму для ввода списка клиентов. Расположите в ней все поля, за исключением поля, указывающего страну. 
  </li>
  <li>Нажмите кнопку Option Group (Переключатель) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Щелкните в том месте формы, в котором вы предполагаете расположить поле для ввода названия страны. 
  </li>
  <li>Откройте окно Properties (Свойства) для созданного объекта. </li>
  <li>Скорректируйте свойство ButtonCount (Количество опций). Задайте количество опций, равное 3. 
  </li>
  <li>Свяжите созданное поле формы с полем таблицы, содержащим информацию о стране проживания клиента. Для этого используйте 
  свойство controlsource (Источник данных). </li>
  <li>Откройте в верхней части окна Properties (Свойства) список объектов и 
  выберите из него первую опцию переключателя Option 1 (Опция 1). На рис. 6.23 показано, что при этом объект выделяется штриховой 
  рамкой, т. е. переходит в режим редактирования. </li>
  <li>Для объекта option1 (Опция 1) скорректируйте свойство caption(Надпись), введя название страны Россия. 
  </li>
  <li>Для объекта option1 (Опция 1) скорректируйте свойства Forecolor(Цвет надписи), BackCoior (Цвет фона), FontName (Наименование 
  шрифта), определяющие цвет шрифта, цвет фона переключателя и наименование шрифта. 
  </li>
  <li>Аналогично скорректируйте свойства для остальных двух объектов. </li>
  <li>Воспользовавшись кнопкой Label (Метка) на панели инструментов FormControls (Элементы управления формы), создайте над 
  переключателем надпись Страна. </li>
</ol>
<IMG src="gl6-24.jpg" alt="gl6-24.jpg" width="500" height="477"></IMG>
<P>
Рис. 6.23. Выбор объекта Option1 для коррекции
</P>
<IMG src="gl6-25.jpg" alt="gl6-25.jpg" width="500" height="456"></IMG>
<P>
Рис. 6.24. Форма, содержащая переключатель
</P>
<ol>
  <li value="12">Сохраните форму с размещенным в ней переключателем. </li>
</ol>
<P>
На рис. 6.24 представлена форма с переключателем, использующимся для ввода информации в поле Страна.
</P>
<P>
Теперь при вводе информации в список клиентов в поле таблицы, содержащее страну проживания, будет заноситься значение, которое вы установите с помощью переключателя.
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">По умолчанию опции в переключателе расположены вертикально. Для расположения опций горизонтально перейдите в режим редактирования переключателя и, используя мышь и клавиши-стрелки, измените их расположение.
</font>
</P>
<p>&nbsp;
<a NAME="20"></a><font size="4">Списки </font>
</P>
<P>
Visual FoxPro для отображения в форме одного и того же поля позволяет 
использовать разные объекты. Например, в предыдущем примере для ввода информации в поле, указывающее страну проживания, мы 
использовали переключатель. Если вводимых в поле значений много, удобно 
применять списки, называемые объектами типа ListBox (Список).
</P>
<P>
Списки в Visual FoxPro используются для отображения в форме элементов, которые могут быть заданы с помощью массива, меню, списка файлов, значений поля таблицы и т. д. Для указания источника данных для 
списка применяется свойство RowSourceType (Тип источника данных), имеющее 
значения, описанные в табл. 6.14.
</P>
<P>
Таблица 6.14. Значения свойства RowSourceType
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Значение

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Источник данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

0    (None)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Значения элементов списка определяются программно с помощью методов Additem (Добавить объект) или AddListltem(Добавить объект списка)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

1    (Value)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Список задается в виде строки, элементы в которой разделяются запятыми

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

2    (Alias)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

В качестве источника данных используется таблица. Количество выводимых полей таблицы определяется значением свойства ColumnCount   (Количество полей)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

3    (SQLStatement)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Список содержит данные, полученные в результате выполнения SQL-оператора

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

4    (Query)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Список содержит данные, полученные в результате выполнения указанного запроса. Запрос задается именем файла с расширением QPR

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

5    (Array)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Источником данных является заданный массив

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

6   (Fields)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Значения элементов списка определяются полями таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

7    (Files)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Список содержит перечень файлов текущей папки. В свойстве RowSource (Источник данных списка) вы можете задать шаблон выбора файлов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

8    (Structure)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

В качестве источника данных используется структура таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

9   (Popup)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Список содержит пункты всплывающего меню

</TD>
</TR>
</TABLE>
<P>
Объекты типа ListBox имеют также свойства, которые отсутствовали у ранее 
рассмотренных объектов (табл. 6.15).
</P>
<P>
Таблица 6.15. Свойства объектов типа ListBox, отсутствовавшие
у рассмотренных ранее объектов
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Свойство

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

ColumnCount(Количество колонок)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Определяет число колонок в списке

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

FirstElement(Первый элемент)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает первый элемент массива, который будет отображаться в списке

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Number Of Elements(Количество элементов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Определяет количество элементов массива,  отображаемых в списке

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

RowSource(Источник данных списка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Указывает источник данных списка

</TD>
</TR>
</TABLE>
<P>
Разместим в форме, предназначенной для редактирования списка клиентов из таблицы customer, список, который будем применять для ввода 
названия города проживания клиента. В качестве источника данных для списка будем 
использовать таблицу.
</P>
<ol>
  <li>Создайте дополнительную таблицу city, содержащую одно поле Nmcity и введите в нее названия всех городов предполагаемых клиентов фирмы. 
  </li>
  <li>Откройте в окне конструктора форму для ввода информации о клиентах. </li>
  <li>Откройте окно окружения формы, выбрав из меню View (Вид) команду Data Environment (Окружение). Для добавления в окружение формы таблицы 
с наименованиями городов выберите команду Add (Добавить) контекстного меню. На экране откроется диалоговое окно Add Table or View
(Добавить таблицу или отображение), в котором выберите таблицу city. </li>
  <li>Удалите из формы поле ввода города покупателя, поскольку в данном примере для ввода значения города проживания клиента будет использоваться список. 
  </li>
  <li>Нажмите кнопку List Box (Список) на панели инструментов FormControls (Элементы управления формы). 
  </li>
  <li>Щелкните на месте удаленного поля ввода. </li>
  <li>Откройте окно Properties (Свойства) размещенного в форме списка. </li>
  <li>Чтобы связать созданное поле с полем таблицы customer, выберите свойство controisource (Источник данных). В поле ввода значения 
  свойства воспользуйтесь кнопкой раскрытия списка и из списка всех полей открытой таблицы customer выберите поле ccity. 
  </li>
  <li>Скорректируйте свойство RowSourceType (Тип источника данных), которое указывает тип источника данных. Выберите из списка значение Fields(Поля), поскольку список городов располагается в поле Nmcity таблицы
City. </li>
</ol>
<IMG src="gl6-26.jpg" alt="gl6-26.jpg" width="500" height="456"></IMG>
<P>
Рис. 6.25. Использование в форме списка
</P>
<ol>
  <li value="10">Скорректируйте свойство RowSource (Источник данных списка), задав 
  в поле ввода значения свойства city<span lang="en-us"> </span>NmCity. </li>
  <li>Запустите форму на выполнение. Теперь при редактировании списка клиентов в поле ccity таблицы customer будет заноситься 
  значение, выбираемое из списка (рис. 6.25). </li>
</ol>
<p>&nbsp;
<a NAME="21"></a><font size="4">Раскрывающиеся списки </font>
</P>
<P>
В Visual FoxPro существуют два вида списков. Один из них мы рассмотрели в предыдущем примере. Второй вид списка — объект типа comboBox(Раскрывающийся список) или раскрывающийся список. Этот тип 
списка удобно использовать в том случае, если вводимых значений много, а места в 
форме для расположения обычного списка не хватает.
</P>
<P>
Опишем процедуру создания раскрывающегося списка для ввода и редактирования наименования города проживания клиента таблицы customer. В отличие от предыдущего примера, в качестве источника данных будем использовать не таблицу со списком стран, а строку с наименованиями городов.
</P>
<ol>
  <li>Откройте в окне конструктора форму для ввода информации о клиентах. </li>
  <li>Удалите список для ввода названия города, созданный ранее. </li>
  <li>Нажмите кнопку Combo Box (Раскрывающийся список) на панели инструментов Form Controls (Элементы управления 
  формы). </li>
  <li>Щелкните на месте удаленного объекта. Объект типа ComboBox (Раскрывающийся список) разместится в форме. 
  </li>
  <li>Откройте окно Properties (Свойства) для размещенного в форме раскрывающегося списка. 
  </li>
  <li>Свяжите раскрывающийся список с полем ccity таблицы customer, используя свойство controisource (Источник данных). 
  </li>
  <li>Из списка возможных значений свойства RowSourceType (Тип источника данных списка) выберите Value (Значение). 
  </li>
  <li>Введите в поле ввода значения свойства RowSource (Источник данных списка) перечень допустимых элементов списка через запятую: 
  Москва, Одесса, Новосибирск, Свердловск, Черноголовка (рис. 6.26). </li>
  <li>Запустите форму на выполнение. Теперь при редактировании списка покупателей 
для ввода в таблицу customer названия города, в котором проживает клиент, нажмите кнопку раскрытия созданного списка и выберите из него нужное значение. Это значение будет введено в поле 
  ccity таблицы (рис. 6.27). </li>
</ol>
<IMG src="gl6-27.jpg" alt="gl6-27.jpg" width="500" height="456"></IMG>
<P>
Рис. 6.26. Определение свойств раскрывающегося списка
</P>
<IMG src="gl6-28.jpg" alt="gl6-28.jpg" width="500" height="456"></IMG>
<P>
Рис. 6.27. Выбор наименования города из раскрывающегося списка
</P>
<p>&nbsp;
<a NAME="22"></a><font size="4">Использование построителя
для создания раскрывающегося списка </font>
</P>
<P>
Для размещения в форме раскрывающегося списка удобно применять построитель раскрывающегося списка. Рассмотрим его использование для 
создания объекта типа comboBox (Раскрывающийся список) и настройки его свойств.
</P>
<ol>
  <li>Нажмите кнопку Combo Box (Раскрывающийся список) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Щелкните в том месте формы, в котором вы предполагаете расположить поле. 
  </li>
  <li>Для запуска построителя нажмите правую кнопку мыши и выберите команду Builder (Построитель) контекстного меню. Открывается диалоговое окно Combo Box Builder (Построитель раскрывающегося списка)(рис. 6.28), содержащее вкладки List Items (Список объектов), Style(Стиль), Layout (Расположение) и Value (Значение), в которых вы 
  можете задать формат, стиль и источник данных для поля ввода. </li>
</ol>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для запуска построителя объекта ComboBox (Раскрывающийся список) 
можно сначала нажать на панели инструментов Form Controls (Элементы управления 
формы) кнопку Builder Lock (Закрепитель построителя), а затем — кнопку Combo Box (Раскрывающийся список). В этом случае при размещении 
объекта в форме сразу запускается построитель. </font>
</P>
<IMG src="gl6-29.jpg" alt="gl6-29.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.28. Вкладка List Items построителя объекта ComboBox
</P>
<P>
Рассмотрим назначение вкладок диалогового окна Combo Box Builder(Построитель раскрывающегося списка). Вкладка List Items (Список объектов) позволяет задать тип источника данных для заполнения списка. На ней
расположен раскрывающийся список Fill the list with (Заполнение списка),содержащий значения, описанные в табл. 6.16.
</P>
<P>
Таблица 6.16. Назначение опций раскрывающегося списка Fill the list with
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Опция

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Fields from a table or view
(Поля таблицы или представления)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Указывает,  что источником данных являются поля таблицы или представления данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Data entered by hand
(Значения из списка)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Указывает,  что  источником  данных  является заданный список значений

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Values from an array
(Значения из массива)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Указывает,  что  источником  данных  является массив

</TD>
</TR>
</TABLE>
<P>
При использовании значения Fields from a table or view (Поля таблицы или 
представления) сначала необходимо в списке Databases and tables (Базы данных и таблицы) выбрать таблицу, поле которой будет являться источником данных, а затем перенести нужное поле из списка Available fields(Имеющиеся поля) в список Selected fields (Выбранные поля).
</P>
<IMG src="gl6-30.jpg" alt="gl6-30.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.29. Вкладка List Items построителя раскрывающегося
списка при установленном значении Values   from  an  array
</P>
<P>
При выборе других значений из списка Fill the list with (Заполнение списка)вкладка List Items (Список объектов) изменяется. На рис. 6.29 
представлена эта вкладка, когда источником данных является массив. Вам 
необходимо указать наименование массива и, в том случае, если он используется не 
весь, ввести количество строк и столбцов в размещаемом списке.
</P>
<P>
Завершив ввод параметров на вкладке List Items (Список объектов), для задания стиля отображения перейдите на вкладку Style (Стиль) построителя
объекта <span lang="en-us">Combo</span>Вох (Раскрывающийся список) (рис. 6.30). Она содержит 
три группы переключателей. Переключатели Three-dimensional (Объемный) и Plain(Плоский) позволяют задать объемный или плоский стиль отображения 
поля, определяемый значением свойства SpeciaiEffect (Специальный эффект).
</P>
<IMG src="gl6-31.jpg" alt="gl6-31.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.30. Вкладка Style построителя раскрывающегося списка
</P>
<P>
Переключатели второй группы имеют следующее назначение:
</P>
<ul>
  <li>Drop-down combo — указывает, что создаваемый объект будет раскрывающимся списком, из которого пользователь может выбрать 
  значение или ввести его в поле ввода списка; </li>
  <li>Drop-down list — указывает, что объект будет раскрывающимся списком, из которого можно только выбирать значения. 
  </li>
</ul>
<P>
Переключатели третьей группы задают значение свойства incrementaisearch и имеют следующее назначение:
</P>
<ul>
  <li>Yes, enable incremental searching (Да, возможен поиск значения) — указывает, что при вводе каждой буквы в поле ввода списка будет осуществляться поиск подходящего значения; 
  </li>
  <li>No, don't enable incremental searching (Нет, не возможен поиск значения) — указывает, что при вводе каждой буквы в поле ввода списка поиск подходящего значения не будет осуществляться. 
  </li>
</ul>
<P>
Установив необходимые опции на вкладке Style (Стиль), перейдите на вкладку Layout (Расположение) (рис. 6.31). Флажок Adjust the width of 
the combo box to display all columns (Увеличить ширину раскрывающегося списка 
для отображения всех колонок) задает значение свойства width (Ширина)объекта 
ComboBox (Раскрывающийся список). При установке флажка ширина раскрывающегося списка увеличивается, чтобы поместились 
значения всех элементов списка.
</P>
<P>
Таблица данной вкладки содержит реальные данные и позволяет задать значения свойства 
columnwidths (Ширина колонки). Для изменения ширины колонки установите курсор на правую границу столбца и перемещайте в 
ту или иную сторону.
</P>
<IMG src="gl6-32.jpg" alt="gl6-32.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.31. Вкладка Layout построителя раскрывающегося списка
</P>
<P>
Вкладка Value (Значение) построителя (рис. 6.32) предназначена для указания источника данных и задает значение свойства controisource (Источник 
данных) объекта.
</P>
<IMG src="gl6-33.jpg" alt="gl6-33.jpg" width="445" height="308"></IMG>
<P>
Рис. 6.32. Вкладка Value построителя раскрывающегося списка
</P>
<P>
Завершив установку параметров, нажмите кнопку ОК для закрытия окна построителя. В том случае, если вам опять потребуется его помощь, выделите созданный объект типа 
ComboBox (Раскрывающийся список), нажмите
правую кнопку мыши и выберите из контекстного меню команду Builder(Построитель).
</P>
<p>&nbsp;
<a NAME="23"></a><font size="4">Счетчики </font>
</P>
<P>
Чтобы разместить в форме поле для ввода числовых значений, которые изменяются  в  заданном  диапазоне,   вы  можете  использовать  объект 
типа spinner, называемый счетчиком. Разместим в форме счетчик, выполнив следующие действия.
</P>
<ol>
  <li>Нажмите кнопку Spinner (Счетчик) на панели инструментов FormControls (Элементы управления формы). 
  </li>
  <li>Щелкните в том месте формы, где предполагаете расположить поле-счетчик. 
  </li>
  <li>Откройте окно Properties (Свойства) для размещенного в форме объекта. 
  </li>
  <li>В поле ввода значения свойства controisource (Источник данных) нажмите кнопку раскрытия списка и выберите поле 
  таблицы, для которого счетчик создается. </li>
  <li>Используя свойства объектов spinner HighValue (Наибольшее значение 
  счетчика) и spinnerLowValue (Наименьшее значение счетчика), задайтемаксимальное и минимальное значения, которые можно установить припомощи кнопок изменения значения самого поля. 
  </li>
  <li>Используя свойство KeyboardHighValue (Максимальное значение, вводимое с клавиатуры), задайте максимальное значение, которое 
  можно ввести в поле, используя клавиатуру. </li>
  <li>В поле свойства KeyboardLowValue (Минимальное значение, вводимое с 
  клавиатуры) введите число, определяющее минимальное значение, вводимое в поле с клавиатуры. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание </b></font>
</P>
<P>
<font color="#008000">При вводе в поле числа, выходящего за установленные с помощью 
свойств KeyboardHighValue и KeyboardLowValue границы, на экран будет выводиться сообщение о допустимых пределах вводимого числа.
</font>
</P>
<ol>
  <li value="8">Используя свойство increment (Шаг), задайте шаг, с которым будет изменяться значение поля. 
  </li>
  <li>Создайте текстовую надпись для поля. </li>
  <li>Сохраните форму с размещенным в ней счетчиком и запустите ее на выполнение. 
  </li>
  <li>Попробуйте вводить с помощью счетчика информацию, используя для этого кнопки&nbsp; 
  поля, клавиши и , а также цифры на клавиатуре. </li>
</ol>
<P>
На рис. 6.33 представлена форма, содержащая счетчик для ввода значения скидки, 
которая может быть предоставлена клиенту, если он является постоянным покупателем. При вводе в поле значения больше 
допустимого, Visual FoxPro выдает соответствующее предупреждение с указанием диапазона вводимого значения.
</P>
<IMG src="gl6-34.jpg" alt="gl6-34.jpg" width="500" height="446"></IMG>
<P>
Рис. 6.33. Счетчик, размещенный в форме
</P>
<p>&nbsp;
<a NAME="24"></a><font size="4">Линии и контуры </font>
</P>
<P>
Visual FoxPro позволяет размещать в форме линии, прямоугольники, скругленные прямоугольники, круги, эллипсы, используемые для объединения 
в группу схожих по смыслу объектов и улучшения внешнего вида формы.
</P>
<P>
<b>Линия </b>
</P>
<P>
Для добавления в форму вертикальной или горизонтальной линии выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Line (Линия) на панели инструментов Form Controls
(Элементы управления формы). </li>
  <li>Установите указатель мыши в то место, где должна начинаться линия, и, не отпуская кнопку мыши, переместите его до получения линии 
  нужной длины. </li>
  <li>Используя свойство Borderwidth (Толщина линии), введите число, которое будет определять толщину линии. 
  </li>
  <li>Если линия вертикальная, для задания ее длины используйте свойство Height (Высота). Для задания длины горизонтальной линии предназначено свойство width (Ширина). 
  </li>
  <li>Для задания цвета линии используйте свойство BorderCo<span lang="en-us">l</span>or (Цвет линии). 
  </li>
  <li>С помощью свойства Borderstyle (Стиль линии) укажите стиль линии, 
  используя значения, описанные в табл. 6.17. </li>
</ol>
<P>
Таблица 6.17. Описание стилей линии в зависимости
от свойства Borderstyle
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Значение

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Стиль линии

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

0-Transparent

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Линия отсутствует (имеет цвет фона)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

1-Solid   (Default)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Тонкая линия

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

2-Dash

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Штриховая линия

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

3-Dot

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Пунктирная линия

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

4-Dash-Dot

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Штрих-пунктир

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

5-Dash-Dot-Dot

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Штрих-двойной пунктир

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

6-Inside   Solid

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Непрерывная линия

</TD>
</TR>
</TABLE>
<P>
<b>Контуры </b>
</P>
<P>
Для добавления в форму контура и настройки его свойств выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Shape (Контур) Е1 на панели инструментов FormControls (Элементы управления формы). 
  </li>
  <li>Установите указатель мыши в то место, где должен начинаться объект, и 
  переместите указатель мыши до получения квадрата или прямоугольника нужного размера. 
  </li>
  <li>Для придания созданному объекту формы, отличной от прямоугольника или квадрата, используйте свойство curvature (Изгиб), которое 
  может принимать целочисленные значения в диапазоне от 1 до 99. </li>
  <li>Используя свойство Backstyle (Стиль фона), задайте, будет ли созданный объект прозрачным. 
  </li>
  <li>С помощью свойства Filistyle (Стиль заполнения) задайте узор заполнения (табл. 6.18). 
  </li>
</ol>
<P>
Таблица 6.18. Описание узоров заполнения в зависимости
от свойства Filistyle
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Значение

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Узор заполнения

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

0-Solid

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Сплошное заполнение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

1-Transparent   (Default)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Нет заполнения

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

2-Horizontal   Line

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Горизонтальная штриховка

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

3-Vertical   Line

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Вертикальная штриховка

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

4-Upward  Diagonal

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Штриховка по диагонали слева направо

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

5-Downward   Diagonal

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Штриховка по диагонали справа налево

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

6-Cross

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Горизонтально-вертикальная штриховка

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

7-Diagonal   Cross

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Штриховка по диагонали в обоих направлениях

</TD>
</TR>
</TABLE>
<ol start="6">
  <li>Используя свойство Fillcolor (Цвет заполнения), задайте цвет узора заполнения объекта. 
  </li>
  <li>Свойство Borderstyle (Стиль рамки) предназначено для задания стиля рамки объекта. Оно содержит те же значения, что и для линии. 
  </li>
  <li>Для придания контуру объемности используйте свойство SpecialEffect(Специальные эффекты). 
  </li>
</ol>
</BODY>
</HTML>