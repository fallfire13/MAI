<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 7 
<br>
Создание и печать отчетов</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl7.html#1">Что такое отчет</a>
  <li><a href="gl7.html#2">Рекомендации по созданию отчета</a>
  <li><a href="gl7.html#3">Средства создания отчетов</a>
  <li><a href="gl7.html#4">Использование мастера для создания однотабличного отчета</a>
  <li><a href="gl7.html#5">Просмотр подготовленного отчета</a>
  <li><a href="gl7.html#6">Панель инструментов, используемая для просмотра отчета</a>
  <li><a href="gl7.html#7">Печать отчета</a>
</ul>




<P>
В   предыдущих  двух   главах  вы   познакомились   с   инструментами   VisualFoxPro, предназначенными для создания форм. Не менее мощные 
средства предоставляются в распоряжение разработчика для создания отчетов. 
Прочитав эту главу, вы узнаете, что такое отчет и познакомитесь со средствами создания и печати отчетов в Visual FoxPro.
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Что такое отчет </font>
</P>
<P>
Отчет представляет собой форматированное представление данных, выводимое на экран, принтер или в файл. Отчет, создаваемый в Visual 
FoxPro, может быть представлен в табличном виде или в свободной форме. Табличный отчет — это напечатанная таблица, в которой строка представляет собой запись, а каждый из элементов строки содержит поле 
исходной таблицы или вычисляемое поле. Данные в таблице упорядочены. Табличные 
отчеты используются для печати данных, представленных в виде списка. При подготовке писем, почтовых этикеток поля используемых в отчете таблиц должны располагаться в специально выделенных для них местах. В 
этом случае табличный отчет не подходит и используются отчеты в свободной форме. При создании такого отчета вы можете воспользоваться 
стандартным форматом, автоматически создаваемым Visual FoxPro для каждой 
таблицы, при котором поля исходной таблицы располагаются вертикально. Используя 
конструктор отчетов, вы можете разрабатывать собственные форматы отчета, где поля исходной таблицы будут расположены там, где вам нужно.
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">Рекомендации по созданию отчета </font>
</P>
<P>
Если вам требуется создать простой табличный отчет, в котором используются поля из одной таблицы, то трудностей, скорее всего, у вас не возникнет. При разработке более сложного отчета прежде чем приступить к 
его созданию, вы должны четко представлять, что же хотите получить в результате. Поэтому продумайте следующие вопросы.</P>
<ul>
  <li>С какой целью создается настоящий отчет? </li>
  <li>Отчет какого вида вы создаете (табличный, в свободной форме или наклейки)? 
  </li>
  <li>Информация из каких таблиц должна быть представлена в отчете? </li>
  <li>Из используемых в отчете таблиц какая таблица будет главной, а какая —подчиненной? 
  </li>
  <li>По каким параметрам будет упорядочиваться информация в отчете? </li>
  <li>Будет ли при создании отчета использоваться группировка данных и по каким параметрам? 
  </li>
</ul>
<P>
Получив четкие ответы на поставленные вопросы, вы облегчите свою работу при создании отчета.
</P>
<P>
Создавая первые отчеты, прежде чем приступить к работе с конструктором отчетов, прорисуйте формат отчета на бумаге. Это избавит вас от ошибок 
и сократит время, затрачиваемое на разработку отчета.
</P>
<P>
При создании сложных отчетов, использующих данные из нескольких таблиц с отношением &quot;один-ко-многим&quot;, желательно идти 
последовательными шагами от простого к сложному. Сначала добавить в среду 
окружения главную таблицу и расположить в отчете ее поля. После этого просмотреть 
отчет в окне предварительного просмотра и убедиться, что он формируется верно. 
Затем добавить в окружение вторую таблицу, связать ее с главной, задать тип используемого между таблицами отношения и расположить в отчете 
ее поля. И опять убедиться, что отчет печатает те данные, какие вы хотите получить. При таком подходе к созданию отчета вам будет значительно 
легче разобраться в появляющихся ошибках или вообще их избежать.
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Средства создания отчетов </font>
</P>
<P>
В Visual FoxPro для создания отчетов можно использовать следующие средства.
</P>
<ul>
  <li>Report Wizard (Мастер отчета). Позволяет достаточно быстро создать отчет, применяя сортировку, группировку данных и заданный вами 
  стиль оформления. Для создания готового отчета с помощью мастера достаточно ответить на ряд вопросов Report Wizard (Мастер отчета) Visual FoxPro. 
  </li>
  <li>Report Designer (Конструктор отчета). В конструкторе отчетов вы можете 
  разрабатывать или модифицировать отчеты, созданные с помощью мастера. </li>
  <li>Quick Report (Быстрый отчет). Данное средство предназначено для размещения 
  в конструкторе отчета полей и задания среды окружения. Разработчику на выбор предлагается два варианта размещения полей. 
  </li>
</ul>
<P>
При создании отчета можно использовать любые средства, предлагаемые Visual 
FoxPro, какие вам кажутся более удобными. Конечно, больше возможностей предоставляет конструктор отчетов, позволяющий 
создавать отчеты как в табличном виде, так и в свободной форме. Разработке 
отчетов средствами конструктора будет посвящена следующая глава.
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Использование мастера для создания однотабличного отчета </font>
</P>
<P>
Для создания отчета с помощью мастера вам необходимо его запустить, а затем в открывающихся диалоговых окнах выбрать таблицы, входящие в отчет, определить список полей отчета и порядок их размещения, указать 
тип упорядочения данных.
</P>
<P>
Для запуска мастера отчетов выполните одно из следующих действий:
</P>
<ul>
  <li>Выберите в меню Tools (Сервис) команду Wizards (Мастера), а затем в 
  открывшемся меню значение Report (Отчет). </li>
  <li>Нажмите кнопку Report Wizard (Мастер отчета) в диалоговом окне NewReport (Новый отчет), открываемом при создании нового отчета из 
  окна проекта. </li>
  <li>Нажмите кнопку Wizard (Мастер) диалогового окна New (Новый), открываемого при нажатии кнопки New (Новый) на стандартной панели инструментов 
  или выборе команды New (Новый) из меню File (Файл) и установке опции Report (Отчет). 
  </li>
</ul>
<P>
Рассмотрим создание однотабличного отчета с помощью мастера.
</P>
<ol>
  <li>Откройте создаваемый вами проект, например Sales. </li>
  <li>Откройте базу данных проекта. Для этого на вкладке Data (Данные) установите курсор на ее названии и нажмите кнопку Open (Открыть) 
  окна проекта. При этом на стандартной панели инструментов в списке Databases (Базы данных) появится название открытой базы данных. 
  </li>
  <li>Перейдите на вкладку Documents (Документы) и выберите группу Reports(Отчеты). 
  </li>
  <li>Нажмите кнопку New (Новый) окна проекта (рис. 7.1). </li>
  <li>В открывшемся диалоговом окне New Report (Новый отчет) (рис. 7.2) выберите опцию Report Wizard (Мастер отчета). 
  </li>
  <li>После запуска мастера для построения отчета на экране открывается диалоговое окно (рис. 7.3), в котором вы должны указать тип 
  создаваемого отчета (табл. 7.1). </li>
</ol>
<IMG src="gl7-1.jpg" alt="gl7-1.jpg" width="500" height="349"></IMG>
<P>
Рис. 7.1. Группа Reports в окне создания проекта
</P>
<IMG src="gl7-2.jpg" alt="gl7-2.jpg" width="211" height="176"></IMG>
<P>
Рис. 7.2. Диалоговое окно New Report
</P>
<P>
Таблица 7.1. Типы отчетов
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Тип отчета

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

One-to-Many    Report    Wizard   (Мастер отчетов с отношением &quot;один-ко-многим&quot;)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает отчет для таблиц с отношением &quot;один-ко-многим&quot;

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Report  Wizard {Мастер отчетов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает     простой     однотабличный отчет

</TD>
</TR>
</TABLE>
<P>
Для создания простого однотабличного отчета выберите значение ReportWizard и нажмите кнопку ОК.
</P>
<IMG src="gl7-3.jpg" alt="gl7-3.jpg" width="500" height="349"></IMG>
<P>
Рис. 7.3. Диалоговое окно для выбора типа создаваемого отчета
</P>
<ol>
  <li value="7">Открывается первое диалоговое окно мастера (рис, 7.4), в котором необходимо 
  указать таблицу, для которой вы создаете отчет, и выбрать размещаемые в отчете поля. В области Databases and tables (Базы данных 
  и таблицы) расположены два списка. Верхний список содержит открытые базы данных, а нижний — таблицы выбранной из верхнего списка 
  базы. Выберите из верхнего списка необходимую базу данных, а из нижнего —таблицу, для которой создаете отчет. 
  </li>
</ol>
<IMG src="gl7-4.jpg" alt="gl7-4.jpg" width="492" height="360"></IMG>
<P>
Рис. 7.4. Окно создания однотабличного отчета с помощью мастера
</P>
<P>
<font color="#008000"><b>Замечание </b></font>
</P>
<P>
<font color="#008000">Может оказаться, что в диалоговом окне мастера списки области Databasesand tables (Базы данных и таблицы) пусты или содержат не те данные, которые вы предполагаете использовать для построения отчета. Такая 
ситуация возникает в том случае, если предварительно вы не открыли необходимую 
базу данных. Ничего страшного. Для выбора базы данных и входящих в нее таблиц нажмите кнопку, расположенную рядом со списком баз данных. На 
экране откроется диалоговое окно Open (Открыть), позволяющее найти таблицу, которая будет использоваться в отчете.
</font>
</P>
<ol>
  <li value="8">После выбора таблицы, для которой создается отчет, список Availablefields (Имеющиеся поля) будет содержать перечень всех полей 
  таблицы. Вам необходимо из данного перечня перенести в список Selected fields
(Выбранные поля) поля, которые вы хотите разместить в создаваемом отчете. Для переноса полей используйте располагающиеся между 
  списками кнопки. После формирования списка отображаемых в отчете полей нажмите кнопку Next (Далее) для перехода к следующему шагу в 
  создании отчета. </li>
  <li>В следующем диалоговом окне мастера создания отчета необходимо указать поля, по которым будет осуществляться группировка данных в отчете (рис. 7.5). 
  </li>
</ol>
<IMG src="gl7-5.jpg" alt="gl7-5.jpg" width="492" height="360"></IMG>
<P>
Рис. 7.5. Определение полей для группировки данных в отчете
</P>
<blockquote>
<P>
В центре диалогового окна расположены три раскрывающихся списка, позволяющих задать до трех группировок данных в отчете. Эти списки содержат все поля таблицы. Для осуществления группировки данных в 
отчете выберите нужное поле из раскрывающегося списка 1. При создании второй и третьей группировки используются, соответственно, списки 2 и 3.
</P>
</blockquote>
<ol>
  <li value="10">Для задания интервала группировки нажмите кнопку Grouping options(Опции группировки). Открывается диалоговое окно Grouping Intervals(Интервалы группировки) (рис. 7.6). Раскрывающийся список Groupingintervals (Интервалы группировки) этого окна содержит значения, описанные в табл. 7.2. 
  </li>
</ol>
<P>
Таблица 7,2. Описание интервалов группировки раскрывающегося
списка Grouping intervals
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Интервал группировки

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Entire Field (Полное поле)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Интервал группировки задается исходя из полного значения поля таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

1st Letter (1 буква)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Группировка  осуществляется   по   первой  букве значения поля таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

2, 3, 4, 5 Initial Letters
(2, 3, 4, 5 начальных букв)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Группировка осуществляется по 2,  3,  4 или 5первым буквам значения поля таблицы соответственно

</TD>
</TR>
</TABLE>
<P>
Установите необходимое значение и нажмите кнопку ОК.
</P>
<IMG src="gl7-6.jpg" alt="gl7-6.jpg" width="439" height="187"></IMG>
<p></IMG>&nbsp;Рис. 7.6. Диалоговое окно <span lang="en-us">Grouping Intervals</span></p>
<ol>
  <li value="11">Для формирования в отчете итоговых значений воспользуйтесь 
  диалоговым окном <span lang="en-us">Summary Options (</span>Итоговые опции<span lang="en-us">)</span>. 
  В нем содержится таблица, строками которой являются поля таблицы, а столбцами 
  - возможные итоговые значения отчета (табл. 7.3.)</li>
</ol>
<p>Таблица 7.3. Итоговые значения отчета</p>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Столбец

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Field

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование поля таблицы, по которому будет вычисляться итоговое значение в отчете

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Sum

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке флажка в отчет будет помещена итоговая сумма поданному полю

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Avg

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке флажка в отчет будет помещено итоговое среднее значение по данному полю

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Count

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке флажка в отчет будет помещено итоговое количество строк

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Min

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке флажка в отчет будет помещено минимальное значение поля таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Max

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке флажка в отчет будет помещено максимальное значение поля таблицы

</TD>
</TR>
</TABLE>
<P>
Установите флажки для тех итоговых значений, которые хотите разместить в отчете.
</P>
<IMG src="gl7-7.jpg" alt="gl7-8.jpg" width="412" height="225"></IMG>
<P>
Рис. 7.7. Диалоговое окно Summary Options
</P>
<P>
В диалоговом окне Summary Options (Итоговые опции) под таблицей расположен переключатель, управляющий отображением в отчете областей данных (табл. 7.4).
</P>
<P>
Таблица 7.4. Назначение опций переключателя окна Summary Options
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Опция

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Detail and Summary
(Область данных и итоги)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке этой опции в отчете отображается область данных,  промежуточные  итоговые значения  по группировкам и конечные итоговые значения по отчету

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Summary only (Только итоги)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При установке данной опции в отчете отображается область данных и конечные итоговые значения по отчету

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

No totals (Нет итогов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Если выбрана эта опция, то в отчете будет отображаться только область данных

</TD>
</TR>
</TABLE>
<blockquote>
<P>
В нижнем правом углу диалогового окна Summary Options (Итоговые опции) расположен флажок Calculate percent of total for sums (Вычислить 
процент итоговых сумм), позволяющий в качестве итогового значения печатать процент промежуточного итогового суммарного значения 
от конечного итогового суммарного значения по отчету.
</P>
<P>
Завершив в диалоговом окне Summary Options (Итоговые опции) все необходимые установки, нажмите кнопку ОК.
</P>
</blockquote>
<ol>
  <li value="12">В следующем диалоговом окне мастера задается стиль отображения объектов в отчете (рис. 7.8). 
  </li>
</ol>
<IMG src="gl7-8.jpg" alt="gl7-9.jpg" width="492" height="360"></IMG>
<P>
Рис. 7.8. Выбор стиля отображения объектов отчета
</P>
<blockquote>
<P>
Список Style (Стиль) содержит несколько вариантов отображения объектов (полей, линий, заголовков и т. д.) в отчете. При выборе стиля мастер позволяет просмотреть, как будут выглядеть элементы отчета. 
Для этого используется область просмотра в верхнем левом углу диалогового окна. Выбрав стиль, нажмите кнопку Next (Далее), чтобы перейти к следующему шагу.
</P>
</blockquote>
<ol>
  <li value="13">На четвертом шаге создания отчета необходимо указать порядок размещения объектов в отчете (рис. 7.9) и ориентацию страницы отчета. 
  После того как вы установили требуемые опции, нажмите кнопку Next (Далее). 
  </li>
</ol>
<IMG src="gl7-9.jpg" alt="gl7-10.jpg" width="492" height="360"></IMG>
<P>
Рис. 7.9. Установка порядка размещения объектов в отчете
</P>
<ol>
  <li value="14">На пятом шаге создания отчета с помощью мастера задаются поля, 
  по которым требуется упорядочение данных в отчете (рис. 7.10). Для формирования списка полей, по которым будет осуществляться сортировка, 
  из списка Available fields or index tag (Выбранные поля и индексы), содержащего перечень всех полей отчета и индексов таблицы, перенесите в 
  список Selected fields (Выбранные поля) требуемые поля в том порядке, в каком будут упорядочиваться данные. Для переноса полей используйте кнопку Add(Добавить) или двойной щелчок мыши на наименовании поля. 
  </li>
</ol>
<IMG src="gl7-10.jpg" alt="gl7-11.jpg" width="492" height="360"></IMG>
<P>
Рис. 7.10. Установка критерия упорядочения данных
</P>
<blockquote>
<P>
Используя опции Ascending (По возрастанию) и Descending (По убыванию), укажите тип сортировки выбранного поля: по возрастанию или 
по убыванию соответственно.
</P>
<P>
Сформировав список полей и указав тип сортировки, нажмите кнопку Next (Далее) для перехода к следующему шагу.
</P>
</blockquote>
<ol>
  <li value="15">На шестом шаге вы можете задать заголовок отчета, используя для 
  этого поле ввода Type a title for your report (Тип заголовка отчета). В этом 
  же диалоговом окне вы можете указать один из трех вариантов дальнейшей работы с отчетом (рис. 7.11) (табл. 7.5). 
  </li>
</ol>
<P>
Таблица 7.5. Переключатели окна Report Wizard (Step 6)
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Переключатель

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Действие

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Save report for later use (Сохранить отчет)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Созданный отчет сохраняется на диске

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Save report and modify it in the Report Designer (Сохранить и открыть в конструкторе для модификации)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Созданный отчет сохраняется на диске и открывается   в   конструкторе  отчетов  
для модификации

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Save and print report (Сохранить и распечатать отчет)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Созданный отчет сохраняется на диске и печатается

</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl7-11.jpg" alt="gl7-12.jpg" width="492" height="360"></IMG> </p>
<P>
Рис. 7.11. Заключительный этап создания отчета
</P>
<blockquote>
<P>
В правом нижнем углу диалогового окна находится кнопка Preview(Просмотр), позволяющая просмотреть созданный отчет. Если 
созданный отчет не удовлетворяет вашим требованиям, с помощью кнопки Back
(Назад) вы можете вернуться к предыдущим шагам построения отчета и изменить установленные там параметры.
</P>
<P>
Введя заголовок и установив требуемую опцию, для завершения создания отчета с помощью мастера нажмите кнопку Finish (Готово). 
Открывается диалоговое окно Save as (Сохранить как), в котором введите имя 
созданного файла.
</P>
</blockquote>
<P>
На рис. 7.12 представлен отчет, созданный с помощью мастера. Если он вас 
полностью устраивает, вы можете его распечатать. Но скорее всего, вам захочется в нем что-то изменить. В этом случае откройте созданный отчет 
в конструкторе отчетов и модифицируйте его.
</P>
<IMG src="gl7-12.jpg" alt="gl7-13.jpg" width="500" height="410"></IMG>
<P>
Рис. 7.12. Отчет, созданный с помощью мастера
</P>
<P>
<font color="#008000"><b>Замечание </b></font>
</P>
<P>
<font color="#008000">При создании отчета с помощью мастера надписи к полям отчета создаются 
на основе информации, введенной в поле Caption (Надпись) конструктора таблиц Table Designer (Конструктор таблиц). Если это поле пусто, надписи совпадают с именами полей таблицы.
</font>
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Просмотр подготовленного отчета </font>
</P>
<P>
Если вы хотите посмотреть, как ваш отчет выглядит, совсем не обязательно его распечатывать. Достаточно открыть его в окне предварительного просмотра, воспользовавшись любым из следующих средств, предоставляемых 
в ваше распоряжение программой Visual FoxPro:
</P>
<ul>
  <li>команда Print Preview (Просмотр печати) из меню File (Файл);</li>
  <li>команда Preview (Просмотр) из меню View (Вид);</li>
  <li>команда Preview (Просмотр) контекстного меню; </li>
  <li>кнопка Print Preview (Предварительный просмотр) на стандартной панели инструментов Visual FoxPro; 
  </li>
  <li>кнопка Preview (Просмотр) окна проекта. </li>
</ul>
<p>&nbsp;
<a NAME="6"></a><font size="4">Панель инструментов, используемая для просмотра отчета </font>
</P>
<P>
При открытии отчета в окне предварительного просмотра на экране появляется панель инструментов Print Preview (Предварительный просмотр) (рис. 7.13), позволяющая перемещаться между страницами отчета и распечатать его. Назначение кнопок этой панели инструментов приведено в табл. 7.6.
</P>
<IMG src="gl7-13.jpg" alt="gl7-14.jpg" width="275" height="51"></IMG>
<P>
Рис. 7.13. Панель инструментов, используемая в окне предварительного просмотра отчета
</P>
<P>
Таблица 7.6. Кнопки панели инструментов Print Preview
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Кнопка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/102.jpg" width="12" height="13"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает первую страницу отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/103.jpg" width="8" height="13"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает предыдущую страницу отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/104.jpg" width="15" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает диалоговое окно Go to Page (Переход на страницу) для перехода к заданной странице отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/105.jpg" width="8" height="13"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает следующую страницу отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/106.jpg" width="12" height="13"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает последнюю страницу отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/107.jpg" width="58" height="24"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Изменяет масштаб отображения отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/108.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Закрывает окно просмотра отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">



<img border="0" src="../key/109.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Печатает отчет

</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="7"></a><font size="4">Печать отчета </font>
</P>
<P>
Вы подготовили отчет, просмотрели его в окне предварительного просмотра и убедились, что он выглядит так, как вы хотите. Теперь можно 
распечатать отчет на принтере, воспользовавшись одним из предложенных ниже способов.
</P>
<ul>
  <li>Выберите команду Print (Печать) из меню File (Файл). </li>
  <li>Выберите команду Run Report (Запустить отчет) из меню Report (Отчет). 
  </li>
  <li>Выберите команду Print (Печать) контекстного меню. </li>
  <li>Нажмите   кнопку   Print One   Copy   (Печать   одной   копии)   или   Run(Запустить) на стандартной панели инструментов Visual FoxPro. 
  </li>
  <li>Нажмите комбинацию клавиш &lt;Ctrl&gt;+&lt;P&gt;. </li>
</ul>
<P>
Открывается диалоговое окно Print (Печать) (рис. 7.14), позволяющее указать имя используемого для печати принтера, изменить, в случае необходимости, его настройки и установить параметры печати.
</P>
<IMG src="gl7-14.jpg" alt="gl7-15.jpg" width="438" height="327"></IMG>
<P>
Рис. 7.14. Диалоговое окно Print
</P>
<P>
В верхней части диалогового окна Print (Печать) расположен раскрывающийся список Name (Наименование), позволяющий выбрать тип подключаемого 
принтера. Эта возможность особенно важна при работе в сети, когда у вас имеется несколько сетевых принтеров.
</P>
<P>
Переключатели области Print range (Печатать) позволяют указать печатаемые 
страницы и имеют следующее назначение:
</P>
<ul>
  <li>All (Все) —печатаются все страницы отчета; </li>
  <li>Pages (Страницы)— печатаются страниц, номера которых заданы в полях ввода from: (от) и to: (до). 
  </li>
</ul>
<P>
Счетчик области Copies (Копии) позволяет указать количество печатаемых копий отчета.
</P>
<P>
В случае, если требуется дополнительная настройка параметров принтера, нажмите кнопку Options (Опции). В результате откроется диалоговое 
окно Print Options (Параметры печати) (рис. 7.15).
</P>
<IMG src="gl7-15.jpg" alt="gl7-16.jpg" width="296" height="239"></IMG>
<P>
Рис. 7.15. Диалоговое окно Print Options
</P>
<P>
Поле Туре (Тип) области Print what (Что печатать) позволяет указать тип 
выводимой на печать информации. Поле File (Файл) содержит наименование и расположение печатаемого файла.
</P>
<P>
В области Options (Опции) расположены флажки, имеющие назначения, описанные в табл. 7.7.
</P>
<P>
Таблица 7.7. Назначение флажков окна Print Options
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Флажок

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Line numbers
(Линии нумерации)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Печатает в левой части отчета номера строк. Данный флажок используется только при печати 
содержимого окна команд и временного буфера Windows

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Page eject before
(Новая страница перед отчетом)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выдает принтеру команду перехода на новую страницу перед печатью отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Page eject after (Новая страница после отчета)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выдает принтеру команду перехода на новую страницу после печати отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Restore environment
(Восстановить окружение)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Используется  для  совместимости  с  отчетами   FoxPro версий 2.x

</TD>
</TR>
</TABLE>
<P>
При нажатии кнопки Options (Параметры) диалогового окна Print Options(Параметры печати) открывается диалоговое окно Report 
and Label Print Options (Параметры печати отчета и этикетки) (рис. 7.16).
</P>
<IMG src="gl7-16.jpg" alt="gl7-17.jpg" width="296" height="159"></IMG>
<P>
Рис. 7.16. Диалоговое окно Report and Label Print Options
позволяет указать критерий для выбора записей
</P>
<P>
В диалоговом окне Report and Label Print Options (Параметры печати отчета и этикетки) вы можете указать критерии для выбора записей, печатаемых 
в отчете (табл. 7.8).
</P>
<P>
Таблица 7.8. Критерии выбора записей
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Критерий

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Scope (Печатаемые записи)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит раскрывающийся список Scope (Печатаемые записи), в котором указывается область печатаемых записей

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

For (Пока)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Вызывает построитель выражений, в котором вы создаете логическое выражение, равное True (Истина) для всех печатаемых записей отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

While (При условии)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Вызывает построитель выражений, в котором вы создаете логическое выражение для выбора записей отчета. В отличие 
от критерия For, печать отчета прекращается при первом же значении выражения, равном False (Ложь)

</TD>
</TR>
</TABLE>
<P>
Для настройки дополнительных параметров печати отчета можно использовать 
диалоговое окно Свойства (рис. 7.17), открываемое при нажатии кнопки Properties (Свойства) в окне Print (Печать) (см. рис. 7.14).
</P>
<P>
На вкладке Бумага/Качество данного диалогового окна можно задать тип подачи бумаги в принтер. Вкладка Расположение позволяет указать расположение бумаги (книжная или альбомная), порядок печати страниц. 
Для того чтобы изменить размер используемой при печати бумаги, качество печати, используйте диалоговое окно Дополнительные возможности, открываемое при нажатии кнопки Дополнительно.
</P>
<IMG src="gl7-17.jpg" alt="gl7-18.jpg" width="385" height="440"></IMG>
<P>
Рис. 7.17. Диалоговое окно Свойства
</P>
</BODY>
</HTML>