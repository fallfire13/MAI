<HTML>
<HEAD>
<meta http-equiv="Content-Language" content="ru">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">

<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b><span lang="ru">ГЛАВА</span> 4 
<br>
Создание базы данных проекта</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl4.html#1">Создание базы данных в окне проекта</a>
  <li><a href="gl4.html#2">Создание базы данных вне проекта</a>
  <li><a href="gl4.html#3">Таблицы — основа базы данных</a>
  <li><a href="gl4.html#4">Имена таблиц</a>
  <li><a href="gl4.html#5">Создание таблицы с помощью мастера</a>
  <li><a href="gl4.html#6">Окно конструктора таблицы</a>
  <li><a href="gl4.html#7">Определение полей таблицы</a>
  <li><a href="gl4.html#8">Определение свойств таблицы</a>
  <li><a href="gl4.html#9">Создание таблицы в конструкторе таблицы </a>
  <li><a href="gl4.html#10">Режимы просмотра таблицы</a>
  <li><a href="gl4.html#11">Модификация таблицы</a>
  <li><a href="gl4.html#12">Индексы</a>
  <li><a href="gl4.html#13">Создание первичного ключа для таблицы</a>
  <li><a href="gl4.html#14">Создание составного индекса</a>
  <li><a href="gl4.html#15">Отношения между таблицами</a>
  <li><a href="gl4.html#16">Создание отношений между таблицами</a>
  <li><a href="gl4.html#17">Целостность данных</a>
</ul>

<P>
База данных в Visual FoxPro — это совокупность <span lang="ru">таблиц</span>, отношений 
между таблицами, индексов, триггеров и хранимых процедур.
</P>
<P>
Создание базы данных в Visual FoxPro осуществляется в интерактивном ре-. жиме с помощью конструктора базы данных, который позволяет:
</P>
<ul>
  <li>создавать и модифицировать таблицы, хранимые процедуры, представления данных; 
  </li>
  <li>добавлять созданные ранее таблицы;</li>
  <li>определять для таблиц индексы; </li>
  <li>устанавливать отношения между таблицами, которые будут поддерживаться при создании форм и отчетов. 
  </li>
</ul>
<P>
Описание структуры базы хранится в словаре базы данных, представляющем собой совокупность системных файлов.
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Создание базы данных в окне проекта </font>
</P>
<P>
База данных является частью проекта, поэтому ее целесообразно создавать в окне проекта. Для создания базы данных выполните следующие действия:
</P>
<ol>
  <li>Откройте созданный проект. </li>
  <li>Выберите в верхней части окна конструктора проектов вкладку Data(Данные). Курсор по умолчанию устанавливается в начале вкладки назначении Databases (Базы данных). 
  </li>
  <li>Нажмите кнопку New (Новый) в окне проекта. </li>
  <li>В открывшемся диалоговом окне New Database (Новая база данных) нажмите кнопку New Database (Новая база данных). 
  </li>
  <li>В поле ввода Enter database (Введите имя базы данных) появившегося на экране диалогового окна Create (Создать) задайте имя создаваемой базы данных, убедившись, что в поле Тип файла установлен тип сохраняемого      файла Database (База данных), а в раскрывающемся списке Папка правильно указана папка, в которой вы хотите расположить создаваемую базу данных. 
  </li>
  <li>Для сохранения созданной базы данных нажмите кнопку Сохранить. После этого откроется пустое окно базы данных Database Designer(Конструктор базы данных) (рис. 4.1). Используя панель&nbsp; 
  инструментов Designer (Конструктор базы данных), команды меню Database(База данных) и контекстное меню, в окне конструктора базы данных 
  вы можете создавать новые таблицы, модифицировать существующие, создавать для них индексы, устанавливать отношения между таблицами. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Если панель инструментов Database Designer (Конструктор базы данных) невидна на экране, в меню View (Вид) выберите команду Toolbars (Панели инструментов). Открывается диалоговое окно Toolbars (Панель инструментов), 
в котором установите флажок Database Designer (Конструктор базы данных). </font>
</P>
<IMG src="gl4-1.jpg" alt="gl4-1.jpg" width="500" height="388"></IMG>
<P>
Рис. 4.1. Пустое окно конструктора базы данных
</P>
<P>
В начале создания базы данных окно конструктора базы данных пусто. На рис. 4.2 показано, как выглядит это окно с размещенными в нем таблицами.
</P>
<IMG src="gl4-2.jpg" alt="gl4-2.jpg" width="500" height="458"></IMG>
<P>
Рис. 4.2. Окно конструктора базы данных Sales с размещенными в нем таблицами
</P>
<P>
Для создания в конструкторе базы данных новых таблиц и модификации существующих вы можете использовать:
</P>
<ul>
  <li>команды меню Database (База данных) (табл. 4.1); </li>
  <li>команды контекстного меню, появляющегося при нажатии правой кнопки мыши в окне конструктора базы данных; 
  </li>
  <li>панель инструментов Database Designer (Конструктор базы данных). </li>
</ul>
<P>
Таблица 4.1. Назначение команд меню Database
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Команда

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

New Table
(Новая таблица)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает новую таблицу

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Add Table
(Добавить таблицу)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет созданную таблицу в базу данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

New Remote View
(Новое удаленное представление)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает удаленное представление данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

New Local View
(Новое локальное представление)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает локальное представление данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Modify
(Модифицировать)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает таблицу в конструкторе таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Browse
(Обзор таблицы)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Показывает содержимое таблицы в режиме Browse

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Remove
(Удалить)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Удаляет таблицу из базы данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Find Object
(Найти объект)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Находит указанный вами объект в окне конструктора базы данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Rebuild Table Indexes
(Перестроить индексы)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Перестраивает индексы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Remove Deleted Records
(Удалить помеченные записи)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Физически удаляет из таблицы  помеченные для удаления записи

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Edit Relationship
(Редактирование отношения)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Редактирует отношения между таблицами

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Edit Referential Integrity
(Редактирование условия целостности)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Определяет условия целостности данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Edit Stored Procedures
(Редактирование хранимых процедур)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает окно редактирования хранимой процедуры

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Connections
(Соединения)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выводит на экран диалоговое окно Connections(Соединения), в котором вы можете создавать 
или модифицировать соединения с удаленными данными

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Arrange
(Упорядочить)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Упорядочивает объекты по имени или типу и выравнивает их по горизонтали или вертикали

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Refresh
(Обновить)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Обновляет информацию в окне конструктора базы данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Properties
(Свойства)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Выводит на экран диалоговое окно Database Properties (Свойства базы данных)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Clean Up Database
(Очистка базы данных)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Очищает базу данных от помеченных на удаление объектов

</TD>
</TR>
</TABLE>
<P>
Для работы в окне конструктора базы данных можно использовать контекстное меню, содержащее наиболее часто используемые команды из 
меню<span lang="en-us"> Database</span>&nbsp; (База данных), команду вызова 
справочной системы, а также команды Expand All (Развернуть все) и Collapse All (Свернуть все), предназначенные, соответственно, для раскрытия и свертывания уровней 
вложенности объектов в окне конструктора базы данных.
</P>
<P>
Панель инструментов Database Designer (Конструктор базы данных) содержит кнопки для выполнения наиболее часто используемых операций 
над базой данных. Вид панели инструментов приведен на рис. 4.3, а описание 
кнопок панели инструментов — в табл. 4.2.
</P>
<IMG src="gl4-3.jpg" alt="gl4-3.jpg" width="233" height="51"></IMG>
<P>
Рис. 4.3. Панель инструментов Database Designer
</P>
<P>
Таблица 4.2. Назначение кнопок панели инструментов
Database Designer
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Кнопка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Название

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/37.jpg" width="18" height="18"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

New Table (Новая таблица)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает новую таблицу

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/38.jpg" width="18" height="18"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Add Table (Добавить таблицу)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет ранее созданную таблицу в базу данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/39.jpg" width="17" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Remove Table (Удалить таблицу)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Удаляет таблицу из базы данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/40.jpg" width="19" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

New Remote View (Новое удаленное представление)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает удаленное представление данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/41.jpg" width="19" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

New Local View (Новое локальное представление)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает локальное представление данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/42.jpg" width="18" height="16"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Modify Table (Модифицировать таблицу)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает таблицу в конструкторе таблицы

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/43.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Browse Table (Обзор таблицы)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Показывает содержимое таблицы в режиме Browse

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/44.jpg" width="18" height="17"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Edit Stored Procedures
(Редактирование хранимых процедур)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает окно для редактирования хранимых процедур

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/45.jpg" width="16" height="15"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Connections (Соединения)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает связь с удаленными данными

</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="2"></a><font size="4">Создание базы данных вне проекта</font>
</P>
<P>
Visual FoxPro позволяет создавать базу данных вне проекта. Для этого воспользуйтесь одним из предложенных ниже способов.
</P>
<ul>
  <li>Выберите в меню File (Файл) команду New (Новый). В открывшемся диалоговом окне New (Новый) выберите опцию Database (База данных),а затем нажмите кнопку New File (Новый файл). На экране 
  откроется диалоговое окно Create (Создать), в поле Enter (Введите) которого задайте 
  имя создаваемой базы данных и нажмите кнопку Сохранить. Созданный файл получит расширение DBC. 
  </li>
  <li>Введите в командном окне Command (Команда) команду CREATEDATABASE, имеющую следующий синтаксис: 
  </li>
</ul>
<blockquote>
<P>
CREATE DATABASE [имяБазыДанных | ?]
</P>
<P>
В том случае, если вы не укажете имя создаваемой базы данных имя<span lang="en-us">
</span>Базы-данных, на экране откроется диалоговое окно Create (Создать), позволяющее его ввести.
</P>
</blockquote>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Базу данных, созданную вне проекта, можно использовать в разных проектах.
</font>
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Таблицы — основа базы данных </font>
</P>
<P>
Таблицы составляют основу вашей базы данных. В них будет храниться вся 
необходимая информация. В дальнейшем данные в таблице будут дополняться новыми данными, редактироваться или исключаться из таблицы. 
Вы сможете просматривать данные таблиц с помощью форм или упорядочивать их по заданному критерию. Информация, содержащаяся в таблицах, 
может быть использована для составления отчетов. Кроме того, используя диаграммы, вы можете графически представить информацию, содержащуюся 
в базе данных.
</P>
<P>
Таблица состоит из строк и столбцов и имеет уникальное имя в базе данных. В каждой из таблиц содержится информация о каких-либо 
объектах одного типа.
</P>
<P>
В Visual FoxPro 7.0 вы можете создавать как таблицы, входящие в базу данных, так и отдельные таблицы, называемые свободными, аналогичные создаваемым в предыдущих версиях FoxPro. В данной главе мы остановимся 
на создании таблиц, входящих в состав базы данных, поскольку в этом случаев сможете использовать все средства, предоставляемые Visual FoxPro 
для работы с таблицами.
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Имена таблиц </font>
</P>
<P>
Таблицы, как и любые другие объекты в Visual FoxPro, имеют имена. Как было сказано выше, таблицы бывают свободные и входящие в базу 
данных. Для таблиц, входящих в базу данных, вы можете задать два имени. Одно 
вводится в диалоговом окне Create (Создать), а второе — на вкладке Table(Таблица) окна конструктора таблицы. Имя, вводимое в диалоговом 
окне Create (Создать) при создании таблицы, является именем файла, в котором 
таблица сохраняется на диске. При задании этого имени необходимо придерживаться 
ограничений, накладываемых операционной системой на количество символов в имени файла. Второе имя таблицы является внутренним 
и хранится в базе данных. Внутреннее имя таблицы может содержать до 128 символов. Оно вводится в поле Name (Имя) вкладки Table 
(Таблица) окна конструктора таблицы.
</P>
<P>
Наименование таблицы может содержать буквы, цифры и знак подчеркивания. Создавая новую таблицу, необходимо помнить, что в базе данных 
не может быть двух таблиц, имеющих одинаковые имена. Если в базе данных уже имеется таблица с таким именем, на экране появляется запрос, заменить ли существующую таблицу новой.
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">При работе в окне конструктора базы данных внутреннее имя таблицы отображается в заголовке окна таблицы. В том случае, если таблица не имеет внутреннего имени, вместо него отображается имя файла, в котором данная таблица сохранена.
</font>
</P>
<P>
<font color="#000080"><b>Предупреждение</b></font></P>
<P>
<font color="#000080">В наименовании таблицы недопустимо использование пробелов и 
специальных символов. </font>
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Создание таблицы с помощью мастера </font>
</P>
<P>
Для создания таблицы с помощью мастера из конструктора базы данных выполните следующие действия:
</P>
<ol>
  <li>Откройте диалоговое окно New Table (Новая таблица) (рис. 4.4), выполнив любое из следующих действий: 
  </li>
</ol>
<ul>
  <li>выберите команду New Table (Новая таблица) из меню Database (База данных); 
  </li>
  <li>выберите команду New Table (Новая таблица) контекстного меню; </li>
  <li>нажмите кнопку New Table (Новая таблица) на панели инструментов Database Designer (Конструктор базы данных). 
  </li>
</ul>
<IMG src="gl4-4.jpg" alt="gl4-4.jpg" width="211" height="176"></IMG>
<P>
Рис. 4.4. Диалоговое окно New Table
</P>
<ol>
  <li value="2">В диалоговом окне New Table (Новая таблица) нажмите кнопку Table 
  Wizard (Мастер таблицы). На экране появляется первое диалоговое окно мастера. 
  </li>
  <li>Visual FoxPro предлагает целый ряд таблиц, которые вы можете использовать в качестве прототипов, что позволит сэкономить время и обеспечить стандартные имена и типы данных для полей создаваемой таблицы. 
  </li>
</ol>
<blockquote>
<P>
На первом шаге вам необходимо, используя предлагаемые Visual FoxPro прототипы таблиц и их поля, сформировать список полей 
создаваемой таблицы (рис. 4.5). Для этого из списка Sample Tables (Примеры таблиц)выберите таблицу, которую хотите взять за основу при создании 
своей таблицы. При этом в списке Available Fields (Имеющиеся поля) отобразятся поля выбранной таблицы.
</P>
</blockquote>
<IMG src="gl4-5.jpg" alt="gl4-5.jpg" width="492" height="360"></IMG>
<P>
Рис. 4.5. Формирование списка полей
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Содержимое списка Sample Tables (Примеры таблиц) можно изменять, используя расположенные под ним опции. Для создания таблиц делового содержания установите опцию Business (Деловые). В списке будут 
отображаться таблицы Accounts, Customers и т. д. При создании таблиц, содержащих 
данные личного характера, установите опцию Personal (Личные). </font>
</P>
<ol>
  <li value="4">Перенесите из списка Available Fields (Имеющиеся поля) в список 
  Selected Fields (Выбранные поля) поля, которые вы хотите разместить в создаваемой 
  таблице. Для переноса полей используйте кнопки, описанные в табл. 4.3. </li>
</ol>
<P>
Таблица 4.3. Назначение кнопок диалогового окна Table Wizard-Step 1
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Кнопка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/46.jpg" width="22" height="20"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Переносит текущее поле из списка Available Fields (Имеющиеся поля)в список Selected Fields (Выбранные поля)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/47.jpg" width="22" height="20"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Переносит все поля из списка Available Fields (Имеющиеся поля) в список Selected Fields (Выбранные поля)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/48.jpg" width="22" height="20"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Возвращает текущее поле из списка Selected Fields (Выбранные поля)в список Available Fields (Имеющиеся поля)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

<img border="0" src="../key/49.jpg" width="22" height="20"></TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Переносит все поля из списка Selected Fields (Выбранные поля) в список Available Fields (Имеющиеся поля)

</TD>
</TR>
</TABLE>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Если в качестве прототипа при создании таблицы вы хотите использовать 
одну из созданных вами ранее таблиц, нажмите кнопку Add (Добавить), расположенную в левом нижнем углу, и в открывшемся диалоговом окне Open(Открыть) выберите требуемую таблицу. Наименование этой таблицы 
будет размещено в списке Sample Tables (Примеры таблиц) окна мастера. </font>
</P>
<P>
Закончив формирование списка полей, нажмите кнопку Next (Далее).
</P>
<ol>
  <li value="5">На следующем шаге работы мастера (рис. 4.6) вам необходимо 
  указать, создаете вы свободную таблицу или данная таблица будет добавлена в базу данных. Для этого воспользуйтесь опциями, назначение которых описано в табл. 4.4. 
  </li>
</ol>
<P>
Таблица 4.4. Назначение опций диалогового окна Table Wizard Step 1
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Опция

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Create my table as a stand-alone freetable (Создать свободную таблицу)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При выборе этой опции создается свободная таблица

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Add my table to the following database
(Добавить таблицу в базу данных)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При выборе опции создаваемая таблица будет добавлена в базу данных

</TD>
</TR>
</TABLE>
<blockquote>
<P>
По умолчанию установлена опция Create my table as a stand-alone free table (Создать свободную таблицу). Для размещения создаваемой таблицы 
в базе данных установите опцию Add my table to the following database
</P>
<P>
(Добавить таблицу в базу данных) и выберите из расположенного ниже списка ее наименование. Если в списке не окажется необходимой 
вам базы данных, нажмите кнопку, расположенную справа от списка. Затем в 
открывшемся на экране диалоговом окне Open (Открыть) выберите нужную базу данных. Ее имя будет размещено в раскрывающемся списке.
</P>
<P>
Если вы хотите задать внутреннее имя таблицы, отображаемое внутри базы данных, воспользуйтесь полем Table Name (Имя таблицы). 
Завершив установки параметров в текущем окне мастера, нажмите кнопку Next(Далее) для перехода к следующему шагу.
</P>
</blockquote>
<IMG src="gl4-6.jpg" alt="gl4-6.jpg" width="492" height="360"></IMG>
<P>
Рис. 4.6. Указание типа создаваемой таблицы
</P>
<ol>
  <li value="6">В следующем диалоговом окне мастера (рис. 4.7) можно изменить наименования выбранных полей, их тип и размеры, используя для 
  этого поля Field Name (Имя поля), Туре (Тип), Width (Ширина) и Decimals(Десятичные). Можно также, используя поле ввода Caption (Надпись),задать для каждого поля заголовок, который будет использоваться 
  при просмотре таблицы и в качестве надписи к полю таблицы при создании форм с помощью мастера. 
  </li>
</ol>
<blockquote>
<P>
Флажок Allow null values (Разрешать нулевые значения) позволяет указать, может ли поле быть пустым, т. е. не содержать значений.
</P>
<P>
Чтобы определить для поля ввода маску, в соответствии с которой в него будут вводиться данные, используйте переключатель Input Mask (Маска 
ввода), содержащий следующие опции:
</P>
</blockquote>
<ul>
  <li>Pre-defined (Предопределенная); </li>
  <li>Custom mask (Пользовательская маска). </li>
</ul>
<blockquote>
<P>
Для использования маски, предлагаемой Visual FoxPro, установите опцию 
Pre-defined (Предопределенная), а затем из раскрывающегося списка, 
расположенного справа от опции, выберите требуемое вам значение.
</P>
<P>
В том случае, если ни одно из значений списка вам не подходит, установите опцию Custom mask (Пользовательская маска) и введите в расположенное справа поле выражение для маски. Для указания формата 
поля можно использовать значения раскрывающегося списка Format (Формат).Установите в диалоговом окне все необходимые значения поочередно 
для всех полей таблицы и нажмите кнопку Next (Далее) для перехода к следующему шагу.
</P>
</blockquote>
<IMG src="gl4-7.jpg" alt="gl4-7.jpg" width="492" height="360"></IMG>
<P>
Рис. 4.7. Модификация полей
</P>
<ol>
  <li value="7">На третьем шаге в работе мастера (рис. 4.8) с помощью 
  раскрывающегося списка Primary Key (Первичный ключ), содержащего список всех 
  полей таблицы, задайте первичный ключ таблицы. При этом вы должны помнить, что поле может использоваться для задания первичного ключа таблицы только в том случае, если оно содержит неповторяющиеся значения. Например, для таблицы customer, содержащей список клиентов, в       качестве первичного ключа можно использовать поле customerio с 
  кодами клиентов. </li>
</ol>
<blockquote>
<P>
Используя список Field Name (Имя поля), укажите дополнительные индексы для таблицы, установив соответствующие флажки слева от наименования полей. Затем нажмите кнопку Next (Далее).
</P>
</blockquote>
<IMG src="gl4-8.jpg" alt="gl4-8.jpg" width="492" height="360"></IMG>
<P>
Рис. 4.8..Окно мастера для определения первичного ключа и индексов таблицы
</P>
<ol>
  <li value="8">Если вы создаете не свободную таблицу, а таблицу, входящую в 
  базу данных, то на следующем шаге мастера определяются связи между новой таблицей и таблицами базы данных (рис. 4.9). 
  </li>
</ol>
<IMG src="gl4-9.jpg" alt="gl4-9.jpg" width="492" height="360"></IMG>
<P>
Рис. 4.9. Задание связей между создаваемой таблицей и таблицами базы данных
</P>
<blockquote>
<P>
В списке My new &lt;имя_таблицы&gt; table (Моя новая таблица) диалогового окна содержится перечень всех существующих и возможных связей для новой таблицы. Используя данный список и диалоговое окно Relationships(Отношения), открываемое при нажатии кнопки Relationships (Отношения), задайте тип связи между создаваемой таблицей и остальными таблицами базы данных.
</P>
</blockquote>
<ol>
  <li value="9">На последнем шаге работы мастера (рис. 4.10) указывается режим 
  дальнейшей работы с таблицей. Для этого необходимо выбрать одну из трех опций, назначение которых описано в табл. 4.5. 
  </li>
</ol>
<P>
Таблица 4.5. Назначение опций диалогового окна Table Wizard Step 4
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Опция

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Save table for later use {Сохранить таблицу)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Сохраняет созданную таблицу

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Save table and browse it (Сохранить таблицу и открыть для просмотра)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Сохраняет созданную таблицу и открывает ее в режиме Browse для просмотра содержимого

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Save table and modify in the Table Designer (Сохранить таблицу и открыть в окне конструктора для модификации)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Сохраняет созданную таблицу и открывает ее  в  конструкторе таблицы для 
модификации

</TD>
</TR>
</TABLE>
<blockquote>
<P>
Выбрав одну из трех опций, нажмите кнопку Finish (Готово). На экране открывается диалоговое окно Save as (Сохранить как) для задания 
имени таблицы. Введите в поле Enter Table (Введите имя таблицы) имя таблицы, 
укажите папку, в которой ее сохраняете, и нажмите кнопку Сохранить.
</P>
</blockquote>
<IMG src="gl4-10.jpg" alt="gl4-10.jpg" width="492" height="360"></IMG>
<P>
Рис. 4.1<span lang="en-us">0</span>. Задание режима дальнейшей работы с таблицей
</P>
<P>
Таблица создана и, в зависимости от установленной опции, откроется в режиме Browse (Обзор) или в конструкторе таблицы для дальнейшей модификации.
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Окно конструктора таблицы </font>
</P>
<P>
Конструктор таблицы предоставляет разработчику более широкие возможности при создании таблицы, чем мастер.
</P>
<P>
В конструктор таблицы вы можете перейти из мастера по созданию таблицы или непосредственно из диалогового окна New Table (Новая таблица) (см. 
рис. 4.4), нажав кнопку New Table (Новая таблица) и введя в диалоговом окне Create (Создать) имя создаваемой таблицы. В результате 
выполнения этих действий откроется окно конструктора таблицы Table Designer(Конструктор таблицы).
</P>
<P>
Окно конструктора таблицы Table Designer (Конструктор таблицы)(рис. 4.11) содержит три вкладки, предназначенные для определения следующих параметров:
</P>
<ul>
  <li>Fields (Поля) — полей таблицы;</li>
  <li>Indexes (Индексы) — индексов; </li>
  <li>Table  (Таблица) — условий достоверности  вводимых данных,  а также 
  триггеров добавления, удаления и модификации. </li>
</ul>
<IMG src="gl4-11.jpg" alt="gl4-11.jpg" width="478" height="416"></IMG>
<P>
Рис. 4.11. Окно конструктора таблицы Table Designer
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Определение полей таблицы </font>
</P>
<P>
При определении полей таблицы используется вкладка Fields (Поля), позволяющая ввести наименование поля, тип данных, размещаемых в поле, 
и ширину. При определении числовых полей необходимо также задать количество десятичных знаков.
</P>
<P>
Помимо основных параметров, в нижней части вкладки Fields (Поля) для каждого поля можно определить дополнительные параметры, которые 
будут определять условия ввода в него данных, а также краткое описание, которое 
поможет разработчику при модификации таблицы в процессе создания приложения или его сопровождения.
</P>
<P>
<b>Ввод наименований полей </b>
</P>
<P>
Наименования полей таблицы вводятся на вкладке Fields (Поля) в строке ввода столбца Name (Имя). При задании наименований полей вы 
можете использовать буквы, цифры и знак подчеркивания. Ваши попытки ввести 
специальные символы Visual FoxPro проигнорирует.
</P>
<P>
Длина наименования поля ограничивается 128-ю символами. Вряд ли вы воспользуетесь возможностью задавать такие длинные имена. Обычно для 
имен полей используют краткие названия, которые более наглядны и легко читаемы.
</P>
<P>
Visual FoxPro не позволяет иметь в таблице поля с одинаковыми именами. При вводе имени, уже имеющегося в таблице, программа выдает предупреждение, указывающее, что поле с таким именем в таблице уже существует.
</P>
<P>
<b>Типы полей </b>
</P>
<P>
Поля таблицы предназначены для хранения в них данных. Это могут быть числа, текстовая информация, даты, графические файлы и т. д. Для определения типа данных, размещаемых в поле, используются тип поля, его ширина и количество знаков после запятой. Для их ввода 
предназначены столбцы Туре (Тип), Width (Ширина) и Decimal (Десятичные) вкладки Fields(Поля) конструктора таблицы.
</P>
<P>
В Visual FoxPro допустимыми являются типы полей, перечисленные в табл. 4.6.
</P>
<P>
Таблица 4.6, Типы полей Visual FoxPro
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Тип

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Отображаемые данные

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Текстовый

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Character, Character(binary)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Текстовые поля могут содержать буквы, цифры   и   специальные   символы.   
Максимальная ширина  поля  составляет  254  символа.  тип Character (binary) используется в том 
случае, если не требуется учитывать кодовую страницу отображаемых данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Числовой

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Integer, Numeric, Float, Double

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Integer отображает целые числа от-2 147 483 647 до +2 147 483 646.
Числовые поля типа Numeric и Float отображают данные с фиксированной точкой в диапазоне от-0.9999999999x1 (Г19 до +0.9999999999х10+2&deg;.
Тип данных Double используется для хранения данных с высокой точностью в диапазоне от&plusmn;4.9406564854 1247x1 (Г324 до&plusmn;1 .797693 13486232x1 (Г308

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Денежный

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Currency

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

В поле денежного типа могут содержаться числа от -922 337 203 685 477.5807 до922 337 203 685 477.5807

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Дата

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Date

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

В поле типа Date может содержаться любая дата от 01. 01. 0001 до 31. 12.9999

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Дата и время

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

DateTime

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

В поле типа DateTime может содержаться любая дата от 01.01.0001 до 31.12.9999 и 
время от 00:00:00 а.m.. до 11 :59:59 р.m.

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Логический

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Logical

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит   логическое   значение   True    (Т.)(Истина) или False (.F.) (Ложь)

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Текстовое поле произвольной длины

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Memo, Memo(binary)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Memo-поле    содержит    символьные    данные большого объема

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Двоичное поле произвольной длины

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

General

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Поле данного типа предназначено для хранения в таблицах изображений и других двоичных данных

</TD>
</TR>
</TABLE>
<P>
<b>Задание свойств полей </b>
</P>
<P>
В нижней части вкладки Fields (Поля) конструктора расположены поля, позволяющие задать для каждого поля таблицы свойства, которые будут использоваться при вводе в них данных.
</P>
<P>
Область Display (Отображение) содержит поля, позволяющие задать форматы ввода и отображения данных (табл. 4.7).
</P>
<P>
Таблица 4.7. Назначение полей области Display вкладки Fields
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Поле

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Format (Формат)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает формат отображения данных в формах, отчетах и окне Browse

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Input mask (Маска ввода)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает формат ввода данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Caption (Надпись)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Определяет заголовок поля

</TD>
</TR>
</TABLE>
<P>
Область Map field type to classes (Используемые типы полей для классов)предназначена для указания библиотеки и имени класса, который будет использоваться для создания объектов при размещении данного поля 
таблицы в форме (табл. 4.8).
</P>
<P>
Таблица 4.8. Назначение полей области Map field type to classes
вкладки Fields
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Поле

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Display library
(Показывать библиотеку)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает   местоположение   и   имя   файла   библиотеки классов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Display class
(Показывать класс)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Задает имя класса из выбранной библиотеки

</TD>
</TR>
</TABLE>
<P>
Область Field validation (Проверка правильности ввода) позволяет задать параметры, описанные в табл. 4.9.
</P>
<P>
Таблица 4.9. Назначение полей области Field validation
вкладки Fields
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Поле

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Rule
(Условие)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Условие правильности ввода данных

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Message
(Сообщение)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Сообщение, выводимое при неправильном вводе данных в поле

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Default Value
(Значение по умолчанию)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Значение, вводимое в поле по умолчанию

</TD>
</TR>
</TABLE>
<P>
В текстовом поле Field comment (Комментарий) можно ввести краткое описание поля, которое может потребоваться при последующих 
модификациях структуры таблицы и сопровождении проекта.
</P>
<P>
<b>Свойство NULL </b>
</P>
<P>
Для каждого поля вы можете определить признак, разрешающий при вводе данных оставлять это поле пустым. Для этого используется свойство NULL 
в описании поля таблицы.   'Более подробно определение свойств полей будет рассмотрено в главе 14.
</P>
<P>
<b>Назначение кнопок окна конструктора таблицы </b>
</P>
<P>
Ввод полей в окне конструктора таблицы осуществляется последовательно. После определения всех необходимых параметров первого поля вы 
переходите на новую строку и вводите информацию для следующего поля таблицы. На вкладке Fields (Поля) справа расположены четыре кнопки. Кнопка 
ОК предназначена для закрытия окна конструктора таблицы и сохранения всех 
изменений, внесенных в структуру таблицы.
</P>
<P>
Если вы изменили структуру таблицы, но хотите от этого отказаться, вам 
необходимо воспользоваться кнопкой Cancel (Отмена).
</P>
<P>
Для добавления в таблицу нового поля установите курсор на поле, выше которого вы предполагаете разместить новое, и нажмите кнопку Insert(Вставить). Будет добавлена пустая строка, в которую вы можете ввести информацию о новом поле.
</P>
<P>
Для удаления поля таблицы перейдите на строку с описанием данного поля и нажмите кнопку Delete (Удалить).
</P>
<P>
Кнопки Insert (Вставить) и Delete (Удалить) на вкладке Indexes (Индексы)позволяют добавлять в таблицу новые индексы и удалять существующие.
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Определение свойств таблицы </font>
</P>
<P>
Для определения свойств самой таблицы предназначена вкладка Table(Таблица) конструктора (рис. 4.12).
</P>
<P>
В ее верхней части расположено поле Name (Имя), в котором вы можете задать длинное имя таблицы. Это имя будет отображаться в окне проекта, 
а также использоваться при создании форм, запросов и отчетов. При создании несвободной таблицы в строке Database 
(База данных) указывается имя базы данных, в которую будет входить создаваемая таблица. 
Это поле доступно только для чтения.
</P>
<P>
Используя поле Table Comment (Описание таблицы) вкладки Table(Таблица), вы можете ввести текстовое описание таблицы. Для 
определения условия проверки правильности ввода информации на уровне записей, гарантирующих достоверность вводимых в таблицу данных, и создания триггеров для добавления, изменения и удаления записей таблицы, предназначены поля областей Record validation (Достоверность записей)  и Triggers(Триггеры).
</P>
<P>
Определение свойств таблицы будет рассмотрено в главе 14.
</P>
<IMG src="gl4-12.jpg" alt="gl4-12.jpg" width="478" height="416"></IMG>
<P>
Рис. 4.12. Вкладка Table конструктора таблицы
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">Создание таблицы в конструкторе таблицы </font>
</P>
<P>
Мы рассмотрели назначение основных параметров окна конструктора таблицы. Теперь можно приступать к созданию таблицы.
</P>
<P>
Рассмотрим последовательность действий при создании таблицы customer(рис. 4.13), содержащей сведения о клиентах, из конструктора базы 
данных sales, предназначенной для учета заказов клиентов.
</P>
<ol>
  <li>Откройте проект sales. </li>
  <li>В иерархической структуре конструктора проекта установите курсор на базу данных sales и нажмите кнопку Modify (Модифицировать). На экране откроется окно конструктора базы данных. 
  </li>
  <li>Находясь в конструкторе базы данных, нажмите кнопку New Table(Новая таблица) на панели инструментов Database Designer (Конструктор 
  базы данных). </li>
  <li>В поле Enter table (Введите имя таблицы) диалогового окна Create(Создать) задайте имя таблицы customer и нажмите кнопку Сохранить. 
  На экране появится окно конструктора таблицы Table Designer (Конструктор
таблицы). Курсор находится в строке ввода столбца Name (Имя). Вы можете вводить имя, тип и ширину полей создаваемой таблицы. 
  </li>
</ol>
<IMG src="gl4-13.jpg" alt="gl4-13.jpg" width="478" height="416"></IMG>
<P>
Рис. 4.13. Структура таблицы Customer
</P>
<ol>
  <li value="5">В строке ввода столбца Name (Имя) введите наименование поля, содержащего код клиента icdcustomer. Для перехода в следующий 
  столбец воспользуйтесь мышью или нажмите клавишу &lt;Tab&gt;. Нажмите кнопку 
  раскрытия списка Туре (Тип) и выберите значение Integer (Целое число).Кроме того, вы можете изменить тип поля с помощью клавиш. Ширина поля типа Integer 
  равна 4. Данное значение устанавливается автоматически, и вы не можете его изменить. 
  </li>
  <li>Перейдите в поле Caption (Надпись), расположенное в области Display(Отображение), и укажите заголовок поля Код клиента. В поле Fieldcomment (Комментарий) введите краткое описание поля. 
  </li>
  <li>Аналогичным образом определите остальные поля. Для перехода с одного поля на другое используйте клавишу &lt;Та<span lang="en-us">b</span>&gt;, клавиши-стрелки или 
  мышь. Для изменения ширины поля используйте кнопки изменения ширины поля, расположенные в правой части поля, а также клавиши. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">В процессе создания структуры вы можете изменить порядок следования полей в таблице. Для этого используйте кнопку с двунаправленной стрелкой, расположенную с левой стороны имени поля.
</font>
</P>
<ol>
  <li value="8">При описании поля ccountry, указывающего страну, определите значение, вводимое в поле по умолчанию при добавлении новой записи. 
  Для этого перейдите в поле Default value (Значение по умолчанию) и введите 
  Россия. </li>
  <li>После завершения определения структуры таблицы нажмите кнопку ОК. </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">В окне конструктора вы можете отказаться от создания новой таблицы 
или введенных в ее структуру изменений. Для этого нажмите кнопку Cancel(Отмена). 
На экране появится запрос системы об отмене или принятии изменений (рис. 4.14). Выберите значение Yes (Да).
</font>
</P>
<IMG src="gl4-14.jpg" alt="gl4-14.jpg" width="253" height="117"></IMG>
<P>
Рис. 4.14. Запрос системы об отмене изменений структуры таблицы
</P>
<ol>
  <li value="10">На экране появляется запрос, будете ли вы сейчас вводить данные 
  в созданную таблицу. Если вы готовы приступить к вводу данных, нажмите кнопку Yes (Да). Созданная таблица откроется в режиме Edit (Ввод),позволяя вводить данные. При нажатии кнопки No (Нет) окно конструктора таблицы закрывается. 
  </li>
</ol>
<p>&nbsp;
<a NAME="10"></a><font size="4">Режимы просмотра таблицы </font>
</P>
<P>
В Visual FoxPro существует два режима просмотра таблицы: Edit (Ввод)(рис. 4.15) и Browse (Обзор).
</P>
<P>
В режиме Edit (Ввод) (рис. 4.15) поля таблицы располагаются в столбец друг под другом. Записи таблицы отделяются горизонтальными линиями.
</P>
<P>
По умолчанию после создания структуры таблицы Visual FoxPro предлагает вам вводить данные в таблицу в режиме Edit (Ввод). В этом режиме пользователю 
нет необходимости после ввода информации во все поля одной записи заботиться о добавлении новой пустой записи. Visual FoxPro автоматически добавляет следующую запись, и пользователь продолжает 
вводить информацию.
</P>
<P>
В режиме Browse (Обзор) (рис. 4.16) таблица более наглядна. Поля расположены в один ряд. Одна строка соответствует одной записи таблицы, а записи размещены одна под другой.
</P>
<IMG src="gl4-15.jpg" alt="gl4-15.jpg" width="500" height="355"></IMG>
<P>
Рис. 4.15. Просмотр таблицы в режиме Edit
</P>
<IMG src="gl4-16.jpg" alt="gl4-16.jpg" width="500" height="274"></IMG>
<P>
Рис. 4.16. Просмотр таблицы в режиме Browse
</P>
<P>
При вводе данных в таблицу, представленную в режиме Browse (Обзор), после ввода одной записи пользователю необходимо самому добавлять новую пустую запись, используя для этого команду Append New Record (Добавить 
новую запись) из меню Table (Таблица) или комбинацию клавиш &lt;Ctrl&gt;+&lt;Y&gt;.
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Для перехода в режимы просмотра таблицы Edit (Ввод) и Browse (Обзор) можно использовать одноименные команды из меню View (Вид).
</font>
</P>
<p>&nbsp;
<a NAME="11"></a><font size="4">Модификация таблицы </font>
</P>
<P>
Структуру таблицы, созданную с помощью мастера или конструктора таблицы, можно модифицировать, т. е. изменить наименование любого поля 
и его тип, вставить новое поле или удалить существующее, изменить порядок 
следования полей в таблице.
</P>
<P>
Чтобы модифицировать таблицу, откройте ее в конструкторе таблицы. Для этого выполните одно из следующих действий.
</P>
<ul>
  <li>В окне проекта установите курсор на модифицируемую таблицу и нажмите кнопку Modify (Модифицировать). 
  </li>
  <li>В окне проекта установите курсор на модифицируемую таблицу, нажмите правую кнопку мыши и в появившемся на экране контекстном меню выберите команду Modify (Модифицировать). 
  </li>
  <li>При открытии конструктора таблицы из окна конструктора базы данных 
  выделите модифицируемую таблицу и нажмите кнопку Modify Table(Модифицировать таблицу) на панели инструментов Database Designer(Конструктор базы данных) или выберите команду Modify (Модифицировать) в меню Database (База данных). 
  </li>
</ul>
<P>
В   результате   на   экране   открывается   диалоговое   окно   Table   Designer
(Конструктор таблицы), содержащее структуру модифицируемой таблицы.
</P>
<P>
<b>Изменение наименований полей и их типов </b>
</P>
<P>
Ошибки, допущенные при задании имени поля или его типа, легко устраняются. Установите курсор на имя поля, которое хотите изменить, и, используя клавишу &lt;Backspace&gt; или &lt;Del&gt;, 
удалите ошибочные символы. После этого введите правильное имя поля.
</P>
<P>
Для изменения типа поля установите курсор в столбец Туре (Тип) и выберите из списка требуемое значение.
</P>
<P>
<font color="#000080"><b>Предупреждение</b></font></P>
<P>
<font color="#000080">Изменение типов полей таблицы, содержащей данные, может привести к потере информации.
</font>
</P>
<P>
<b>Добавление и удаление полей </b>
</P>
<P>
Для добавления нового поля в таблицу выполните следующие действия:
</P>
<ol>
  <li>С помощью клавиш-стрелок или мыши установите курсор на строку, перед которой вы хотите вставить пропущенное поле. При этом курсор может находиться в любом столбце Name (Имя), Туре (Тип) или Width(Размер). 
  </li>
  <li>Нажмите кнопку Insert (Вставить). </li>
  <li>Visual FoxPro вставляет пустую строку с именем NewF<span lang="en-us">l</span>d. Введите требуемое имя поля. 
  </li>
  <li>Используя значения списка Туре (Тип), задайте тип поля. </li>
  <li>В столбце Width (Размер) введите размер нового поля. </li>
</ol>
<P>
Для удаления поля из структуры таблицы установите курсор на поле, которое 
требуется удалить, и нажмите кнопку Delete (Удалить) окна конструктора.
</P>
<P>
<b>Изменение порядка расположения полей </b>
</P>
<P>
Порядок расположения полей, заданный при создании структуры таблицы, можно изменить. Для этого выполните следующие действия:
</P>
<ol>
  <li>Установите курсор на поле, расположение которого хотите изменить. На 
  кнопке появляется значок перемещения поля в виде двунаправленной
стрелки. </li>
  <li>Установите курсор на значок перемещения. </li>
  <li>Нажмите кнопку мыши и, удерживая ее нажатой, переместите значок вверх или вниз на требуемое место в структуре. 
  </li>
  <li>Отпустите кнопку мыши. Поле изменило свое местоположение. </li>
</ol>
<p>&nbsp;
<a NAME="12"></a><font size="4">Индексы </font>
</P>
<P>
Среди требований, предъявляемых к СУБД, основное место занимает возможность быстрого поиска необходимой информации. Прекрасным средством, позволяющим решить эту проблему, является использование 
индексов, которые, в зависимости от количества полей, применяемых при их создании, делятся на простые и составные.
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">В отличие от многих реляционных баз данных, при 
определении составного индекса в Visual FoxPro можно использовать не просто список индексных полей, 
а индексное выражение, при формировании которого применяемых наименования полей таблицы.
</font>
</P>
<P>
Индексы в Visual FoxPro предназначаются также для создания первичных ключей, 
используемых при определении отношений между таблицами и условий целостности данных. В этом случае индексы должны быть уникальными. Это означает, что если для создания уникального индекса 
применяется простой индекс, значения поля должны быть неповторяющимися, т. е. уникальными. Часто для создания уникального индекса используется составной индекс, т. е. он может состоять из нескольких полей. В этом 
случае каждое поле в отдельности может содержать повторяющиеся значения, но 
индексное выражение, в состав которого входят эти поля, должно быть уникальным.
</P>
<P>
Значения индексов хранятся в индексном файле, в котором для каждого значения индекса существует уникальная ссылка, указывающая на местонахождение в таблице записи, соответствующей индексу, что обеспечивает 
при поиске нужной информации прямой доступ к записи на основании упорядоченных значений индекса, а не последовательный просмотр всей 
таблицы. Это, естественно, ускоряет поиск.
</P>
<P>
Для создания индекса таблицы используется вкладка Indexes (Индексы)(рис. 4.17) окна конструктора таблицы Table Designer (Конструктор таблицы).
</P>
<IMG src="gl4-17.jpg" alt="gl4-17.jpg" width="478" height="416"></IMG>
<P>
Рис. 4.17. Вкладка Indexes конструктора таблицы, предназначенная для создания индексов
</P>
<P>
Все индексы в Visual FoxPro имеют имена, задаваемые в поле Name (Имя).Слева от имени индекса в столбце Order (Упорядочение) располагается переключатель, определяющий порядок, в котором будут выстраиваться значения индексного выражения. По умолчанию при создании индекса в данном поле появляется стрелка, направленная вверх. Это означает, что значения 
индексного выражения упорядочены по возрастанию. Если стрелка направлена вниз, это говорит о том, что значения упорядочены по 
убыванию. Для изменения способа упорядочения можно нажать клавишу &lt;Пробел&gt;или 
щелкнуть кнопкой мыши.
</P>
<P>
Список Туре (Тип) используется для задания типа создаваемого индекса и содержит значения, описанные в табл. 4.10.
</P>
<P>
Таблица 4.10. Описание типов индекса
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Тип индекса

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Regular(Обычный)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создается индекс, в котором для каждой записи таблицы хранится значение индексного выражения.  Если несколько записей 
имеют одинаковое значение индексного выражения, то каждое значение хранится отдельно и содержит ссылку на связанную с ней запись

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Unique(Уникальный)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создается  индекс,  в котором хранятся только неповторяющиеся значения индексного выражения. Если две или более записей содержат одинаковое значение индексного выражения, то будет храниться только одно значение и ссылка на первую из записей с одинаковым значением индексного выражения. Таблица может 
иметь несколько уникальных индексов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Candidate(Кандидат)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создается уникальный индекс, который не содержит полей с пустыми значениями. Этот индекс обладает всеми качествами 
первичного ключа и не является им только по той причине, что таблица не может 
содержать более одного первичного ключа

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Primary(Первичный)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создается уникальный индекс, который используется для связывания таблиц и определения условий целостности данных. Поля, входящие в первичный ключ, не должны допускать ввода пустых значений. В отличие от уникального индекса, таблица может иметь 
только один первичный ключ

</TD>
</TR>
</TABLE>
<P>
Значение индекса или индексного выражения вводится в поле Expression(Выражение). Вы можете ввести индексное выражение непосредственно 
в поле ввода или для формирования выражения использовать диалоговое окно 
конструктора выражений Expression Builder (Построитель выражения), представленное на рис. 4.18. Для открытия данного окна нажмите кнопку, расположенную справа от поля Expression (Выражение).
</P>
<P>
При использовании в индексном выражении полей разных типов вы должны проверять допустимость введенного выражения. Например, для 
таблицы customer вы можете создать индекс для упорядочения данных по стране 
проживания и по коду клиента:
</P>
<P>
cCountry + STR(icdCustomer)
</P>
<P>
В поле Filter (Фильтр) конструктора таблицы вы можете определить фильтр, 
используемый для ограничения формируемых индексных значений. В этом случае результат выражения должен иметь логический тип.
</P>
<IMG src="gl4-18.jpg" alt="gl4-18.jpg" width="368" height="359"></IMG>
<P>
Рис. 4.18. Диалоговое окно Expression Builder
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Без индексов в Visual FoxPro не обойтись. Однако при их создании вы 
должны помнить, что если вы используете индекс, в состав которого входят поля 
большой ширины, индексный файл может оказаться очень больших размеров. Visual FoxPro не разрешает при создании индексов использовать Memo-поля 
и поля, содержащие графические изображения. </font>
</P>
<p>&nbsp;
<a NAME="13"></a><font size="4">Создание первичного ключа для таблицы </font>
</P>
<P>
Рассмотрим последовательность ваших действий при создании первичного ключа для таблицы customer. Так как первичный ключ таблицы 
должен быть уникальным, для его создания можно использовать поле icdcustomer 
таблицы, содержащее коды клиентов. Это поле было добавлено в таблицу специально, т. к. значения остальных полей не являются уникальными.
</P>
<ol>
  <li>Откройте окно конструктора таблицы для таблицы Customer. Для этого в окне проекта установите курсор на модифицируемую таблицу и 
  нажмите кнопку Modify (Модифицировать) конструктора проекта. </li>
  <li>В окне Table Designer (Конструктор таблицы) перейдите на вкладку Indexes (Индексы). 
  </li>
  <li>В поле Name (Имя) введите имя индекса icdcustomer. </li>
  <li>Из списка возможных типов индекса в поле Туре (Тип) выберите значение Primary (Первичный). 
  </li>
  <li>Перейдите в поле Expression (Выражение) и введите выражение для индекса icdCustomer. 
  </li>
  <li>Установите переключатель столбца Order (Упорядочение) в значение По 
  возрастанию. Результат создания первичного ключа представлен на рис. 4.19. 
  </li>
  <li>Для завершения создания индекса нажмите кнопку ОК. </li>
</ol>
<IMG src="gl4-19.jpg" alt="gl4-19.jpg" width="478" height="416"></IMG>
<P>
Рис. 4.19. Первичный ключ таблицы Customer
</P>
<p>&nbsp;
<a NAME="14"></a><font size="4">Создание составного индекса </font>
</P>
<P>
Рассмотрим создание индекса для таблицы customer, который будет упорядочивать данные в таблице по фамилии, имени и отчеству. Для 
создания такого индекса воспользуемся индексным выражением.
</P>
<ol>
  <li>Откройте   окно Table   Designer   (Конструктор   таблицы)   для   таблицы 
  customer и перейдите на вкладку Indexes (Индексы). </li>
  <li>В поле Name (Имя) введите имя индекса custName. </li>
  <li>Из списка возможных типов индекса в поле Туре (Тип) выберите значение Regular (Обычный). 
  </li>
  <li>Для задания индекса нажмите кнопку открытия построителя выражений для поля Expression (Выражение). В окне построителя сформируйте следующее выражение: 
  </li>
</ol>
<blockquote>
<P>
cLastName  + cFirstName  + cSecondName
</P>
</blockquote>
<ol>
  <li value="5">Проверьте синтаксис выражения, воспользовавшись кнопкой Verify(Проверить), и закройте окно построителя выражений. 
  </li>
  <li>Для завершения создания индекса нажмите кнопку ОК. </li>
</ol>
<p>&nbsp;
<a NAME="15"></a><font size="4">Отношения между таблицами </font>
</P>
<P>
Между таблицами существует четыре типа отношений. Это &quot;один-к-одному&quot;, &quot;один-ко-многим&quot;, &quot;много-к-одному&quot;, &quot;много-ко<span lang="en-us">-</span>многим&quot;. Все 
эти типы отношений поддерживаются в Visual FoxPro.
</P>
<P>
Отношение &quot;один-к-одному&quot; означает, что каждая запись в одной таблице 
соответствует только одной записи в другой таблице. В качестве примера можно рассмотреть отношения между списком служащих предприятия 
и таблицей, содержащей их служебные характеристики.
</P>
<P>
Наиболее часто встречающимся является тип отношения &quot;один-ко-многим&quot;. В качестве примеров могут быть рассмотрены отношения между покупателем и купленными им товарами, между предприятием и работающими 
на нем сотрудниками.
</P>
<P>
Отношение &quot;много-к-одному&quot; можно сравнить с отношением &quot;один-ко-многим&quot;, рассматриваемое с другой точки зрения. Например, между клиентами и сделанными им заказами существует отношение &quot;один-ко-многим&quot;. 
С другой стороны, если в качестве исходной точки рассматривать заказы, то между сделанными заказами и клиентами получается отношение &quot;много-к-одному&quot;.
</P>
<P>
В качестве примера отношения &quot;много-ко-многим&quot; можно привести пример 
магазина оптовой торговли. Данный тип отношений существует между списком товаров, производимых предприятиями-поставщиками, и списком товаров, заказанных потребителями.
</P>
<p>&nbsp;
<a NAME="16"></a><font size="4">Создание отношений между таблицами </font>
</P>
<P>
Как правило, в Visual FoxPro при создании форм, отчетов и запросов используется несколько таблиц, между которыми установлены 
постоянные отношения. Такие таблицы называются связанными. Из двух связанных таблиц 
одна является главной, а другая — подчиненной. Главную таблицу называют родительской, а подчиненную — дочерней. При создании 
индексов для родительской таблицы должен быть определен ключ типа Primary
</P>
<P>
(Первичный) или типа Candidate (Кандидат), а для дочерней таблицы — индекс для связи с родительской таблицей типа Regular (Обычный).
</P>
<P>
Рассмотрим, например, отношения между таблицей Customer, содержащей список клиентов, и таблицей Phoncust, 
в которой размещены данные о телефонах, по которым можно связываться с клиентами. Таблица 
customer является родительской по отношению к таблице PhonCust. В свою очередь, 
таблица PhonCust является дочерней по отношению к таблице Customer. При создании отношений между этими таблицами для customer 
должен быть определен первичный ключ, а для таблицы PhonCust — создан индекс по полю, содержащему код клиента, по которому осуществляется связь между таблицами.
</P>
<P>
Для создания отношений между таблицами customer и PhonCust выполните следующие действия:
</P>
<ol>
  <li>Откройте окно конструктора базы данных, в которой эти таблицы размещены. 
  </li>
  <li>Откройте таблицу customer в конструкторе таблицы. Для этого щелкните на ней правой кнопкой мыши и в контекстном меню 
  выберите команду Modify (Модифицировать). </li>
  <li>На вкладке Indexes (Индексы) создайте первичный ключ для поля icdCustomer. Для этого в поле столбца Name (Имя) введите наименование индекса icdCustomer. Для простого индекса в качестве его 
  имени удобно использовать наименование поля, по которому индекс создается. 
  </li>
  <li>В столбце Туре (Тип) выберите из списка значение Primary (Первичный). 
  </li>
  <li>В столбце Expression (Выражение) нажмите кнопку построителя. В открывшемся диалоговом окне Expression Builder (Построитель выражения) в списке Fields (Поля) дважды щелкните мышью на 
  поле icdCustomer. Оно будет перенесено в поле Expression (Выражение). Нажмите кнопку ОК для закрытия диалогового окна. 
  </li>
  <li>Индекс для таблицы customer создан. Нажмите кнопку ОК для закрытия окна конструктора таблицы. 
  </li>
  <li>Откройте в конструкторе таблицу PhonCust. </li>
  <li>Перейдите на вкладку Indexes (Индексы) и создайте ключ типа Regular </li>
</ol>
<blockquote>
<P>
(Обычный) для поля icdCustomer.
</P>
</blockquote>
<ol>
  <li value="9">Нажмите кнопку ОК для закрытия окна конструктора таблицы. </li>
  <li>Выберите   родительскую   таблицу.   В   нашем   примере   это   таблица
Customer. </li>
  <li>Установите курсор мыши на первичный ключ таблицы icdCustomer. </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Таблицы в конструкторе базы данных обозначаются прямоугольниками, в нижней части которых после надписи Indexes (Индексы) расположен список индексов, 
созданных для данной таблицы. Первичный ключ в этом списке выделяется значком ключа, расположенным с левой стороны от наименования индекса.
</font>
</P>
<ol>
  <li value="12">Нажмите кнопку мыши и, не отпуская ее, переместите курсор мыши 
  на индекс дочерней таблицы Phoncust, по которому устанавливается связь. </li>
  <li>Отпустите кнопку мыши. </li>
  <li>Открывается диалоговое окно Edit Relationship (Редактирование отношения) (рис. 4.20), в котором слева приведено наименование 
  родительской таблицы и расположен раскрывающийся список индексов таблицы, а 
  справа размещена аналогичная информация о дочерней таблице. Используя раскрывающиеся списки, можно изменять индексы, по 
  которым связываются таблицы. В этом диалоговом окне указан также тип установленного отношения между таблицами. Для сохранения 
  отношения нажмите кнопку ОК, а для отказа — кнопку Cancel (Отмена). </li>
</ol>
<IMG src="gl4-20.jpg" alt="gl4-20.jpg" width="397" height="143"></IMG>
<P>
Рис. 4.20. Диалоговое окно Edit Relationship
для установления отношений между таблицами
</P>
<P>
Диалоговое окно Edit Relationship (Редактирование отношения) закрывается, а в окне конструктора базы данных отображается в виде линии 
созданное отношение между таблицами (рис. 4.21).
</P>
<P>
Установите курсор на линию, соединяющую связываемые таблицы. Толщина линии увеличивается. При щелчке по ней правой кнопкой мыши появляется контекстное меню, содержащее четыре команды (рис. 4.22). 
команда Remove Relationship (Удалить отношение) удаляет установленное между таблицами отношение. При выборе команды Edit Relationship (Редактирование 
отношения) открывается диалоговое окно Edit Relationship (Редактирование 
отношения), позволяющее изменить установленное отношение. Команда Edit Referential Integrity (Редактирование целостности данных) 
открывает диалоговое окно Referential Integrity Builder (Построитель целостности 
данных). Об этом окне речь пойдет в следующем разделе.
</P>
<IMG src="gl4-21.jpg" alt="gl4-21.jpg" width="433" height="455"></IMG>
<P>
Рис. 4.21. Отображение связи между таблицами
</P>
<IMG src="gl4-22.jpg" alt="gl4-22.jpg" width="167" height="90"></IMG>
<P>
Рис. 4.22. Контекстное меню
</P>
<p>&nbsp;
<a NAME="17"></a><font size="4">Целостность данных </font>
</P>
<P>
Целостность данных является одним из самых важных требований, предъявляемых к базам данных. Рассмотрим такой пример. База данных sales 
оптового магазина содержит таблицу customer со списком клиентов и таблицу 
ordsalem, в которой размещены данные о клиентах и сделанных ими заказах. Если окажется, что в таблице 
ordsalem содержатся коды клиентов, которые отсутствуют в таблице Customer, то невозможно определить, кому 
был отпущен товар по этому заказу. Или еще такой пример. Вы удалили из таблицы клиентов, которые перестали пользоваться услугами вашего 
магазина, а потом обнаружили, что один из них не возвратил вам кредит. Но вся информация о нем в базе данных отсутствует.
</P>
<P>
Для определения условий целостности данных в базе данных проекта могут быть использованы установленные между таблицами отношения.
</P>
<P>
Проверка целостности данных может осуществляться как программными средствами, так и средствами базы данных. Например, при вводе в таблицу
</P>
<P>
Ordsalem нового заказа можно использовать программу, которая будет проверять, имеется ли информация об этом клиенте в таблице customer. В случае отсутствия клиента в таблицу Customer будет добавляться новая запись.
</P>
<IMG src="gl4-23.jpg" alt="gl4-23.jpg" width="500" height="271"></IMG>
<P>
Рис. 4.23. Диалоговое окно Referential Integrity Builder
для определения условия целостности данных
</P>
<P>
Для определения условия целостности данных используется окно построителя условий целостности данных Referential Integrity Builder (Построитель 
целостности данных) (рис. 4.23), которое содержит перечень всех установленных отношений между таблицами. Для его открытия выполните одно 
из следующих действий.
</P>
<ul>
  <li>В окне конструктора базы данных установите курсор на линию, отображающую отношения таблиц, и выберите в контекстном меню 
  команду Edit Referential Integrity (Редактирование целостности данных). </li>
  <li>В меню Database (База данных) выберите команду Edit Referential Integrity (Редактирование целостности данных). 
  </li>
  <li>В диалоговом окне Edit Relationship (Редактирование отношений) нажмите кнопку Referential Integrity (Целостность данных). 
  </li>
</ul>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Если база данных содержит помеченные на удаление объекты, при 
открытии окна построителя условий целостности данных Referential Integrity Builder(Построитель целостности данных) Visual FoxPro 
попросит очистить базу данных. В этом случае в меню Database (База данных) выберите команду CleanUp Database (Очистка базы данных), после чего повторно выполните 
команду, открывающую окно построителя условий целостности данных. </font>
</P>
<P>
Таблица описания условий содержит имена родительской и дочерней таблиц, 
наименования индексов, используемых для связи, а также типы действий, 
выполняемых при модификации данных: добавлении и удалении записей.
</P>
<P>
В центре диалогового окна находятся переключатели, предназначенные для указания типа выполняемого действия. В нижней части диалогового 
окна отображается краткая справка о возможном выборе действий. Кроме того, вы можете выбрать тип действия из раскрывающегося списка непосредственно в полях Update (Изменить), Delete (Удалить) и Insert (Вставить).
</P>
<P>
Рассмотрим возможные действия программы Visual FoxPro при изменении значения первичного ключа или ключа типа Candidate 
(Кандидат) в родительской таблице в зависимости от используемой опции (табл. 4.11.).
</P>
<P>
Таблица 4.11. Описание действий Visual FoxPro в зависимости от выбранной опции при изменении 
значения первичного ключа или ключа типа Candidate
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование опции

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Cascade
(Каскадное изменение)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При  изменении  значений  полей  первичного  ключа  или  ключа-кандидата в родительской таблице, автоматически 
осуществляется каскадное изменение всех соответствующих значений в дочерней 
таблице.  Например, если это правило применить к отношению между таблицами  Customer и  Ordsalem,  при  изменении  
кода клиента в таблице Customer автоматически будут изменены коды<span lang="en-us">
</span>и в Таблице Ordsalem

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Restrict
(Запрет изменения)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Не  позволяет изменять значения  полей  первичного ключа или ключа-кандидата в родительской таблице, если в дочерней таблице имеется хотя бы одна запись, содержащая ссылку на изменяемую запись. Данное правило также можно применить к 
отношению между таблицами  Customer  и Ordsalem,  если  в создаваемом приложении коды клиента определяются на этапе ввода 
нового клиента и в дальнейшем не редактируются

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Ignore
(Игнорировать)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Позволяет изменять значения полей первичного ключа или ключа-кандидата в родительской таблице независимо от 
существования связанных записей в дочерней таблице. Целостность данных при этом не поддерживается

</TD>
</TR>
</TABLE>
<P>
При удалении записи из родительской таблицы возможны следующие действия программы Visual FoxPro в зависимости от установленной в диалоговом окне Referential Integrity Builder 
(Построитель целостности данных) опции (табл. 4.12).
</P>
<P>
Таблица 4.12. Описание действий Visual FoxPro, в зависимости
от выбранной опции, при удалении записи
из родительской таблицы
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование опции

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Cascade
(Изменять каскадно)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При удалении  записи  из  родительской таблицы автоматически осуществляется каскадное удаление всех записей из 
дочерней таблицы, связанных с удаляемой записью

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Restrict
(Ограничивать)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Не позволяет удалять записи в родительской  таблице, если в дочерней таблице имеется хотя бы одна запись, содержащая 
ссылку на удаляемую запись. При попытке удаления записи возникает ошибка, которую вы можете обработать программно

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Ignore
(Игнорировать)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Позволяет удалять записи в родительской таблице независимо от существования связанных записей в дочерней таблице. 
Очевидно, что целостность данных при этом не поддерживается

</TD>
</TR>
</TABLE>
<P>
Используя опции диалогового окна Referential Integrity Builder (Построитель 
целостности данных), можно задать действия, выполняемые Visual FoxPro при добавлении новой записи в дочернюю таблицу или редактировании 
в ней существующей (табл. 4.13).
</P>
<P>
Таблица 4.13. Описание действий Visual FoxPro, в зависимости от выбранной опции, при добавлении новой записи
в родительскую таблицу
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование опции

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Описание

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Restrict
(Ограничивать)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Не позволяет вводить запись, если значение индексного выражения дочерней таблицы 
не соответствует одной из записей в родительской таблице

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Ignore
(Игнорировать)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При вводе данных в дочернюю таблицу не анализируется значение индексного выражения. Целостность данных при этом не поддерживается

</TD>
</TR>
</TABLE>
<P>
После   завершения   определения   в  диалоговом   окне   Referential   IntegrityBuilder (Построитель целостности данных) условий целостности данных 
вся введенная информация сохраняется в базе данных. Определим условия целостности данных для таблиц Customer и Ordsalem.
</P>
<ol>
  <li>Откройте окно конструктора базы данных. </li>
  <li>Создайте отношение между родительской таблицей customer и дочерней
таблицей Ordsalem. </li>
  <li>Выделите линию, соединяющую таблицы. </li>
  <li>Нажмите правую кнопку мыши и выберите команду контекстного меню Edit Referential Integrity (Редактировать целостность данных). На 
  экране откроется диалоговое окно Referential Integrity Builder (Построитель 
  целостности данных). </li>
  <li>Предположим, что в процессе эксплуатации нашего приложения коды клиента могут изменяться, поэтому в поле update (Изменить) 
  установите тип действий cascade (Каскадное изменение). </li>
  <li>Для обеспечения целостности данных при удалении записей в таблице </li>
  <li>Customer в поле   Delete   (Удалить)   установите   тип   действий Restrict
(Запрет изменения). </li>
</ol>
<P>
На рис. 4.24 представлен результат описанных действий, которые необходимы для обеспечения целостности данных. Для сохранения выполненных действий нажмите кнопку ОК.
</P>
<IMG src="gl4-24.jpg" alt="gl4-24.jpg" width="500" height="271"></IMG>
<P>
Рис. 4.24. Диалоговое окно Referential Integrity Builder
</P>
</BODY>
</HTML>