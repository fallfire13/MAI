<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 24
<br>
Публикация данных на Web-сервере </b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl24.html#1">Мастер Web Publishing</a>
  <li><a href="gl24.html#2">Настройка параметров Web-страницы с помощью мастера</a>
  <li><a href="gl24.html#3">Диалоговое окно Layout Options</a>
  <li><a href="gl24.html#4">Диалоговое окно Advanced</a>
  <li><a href="gl24.html#5">Создание Web-страницы</a>
  <li><a href="gl24.html#6">Подготовка данных</a>
  <li><a href="gl24.html#7">Настройка параметров</a>
  <li><a href="gl24.html#8">Редактирование созданной Web-страницы </a>
</ul>

<P>
Все больше в нашу жизнь входит Интернет. В связи с этим во многие программные продукты добавляются средства создания Web-страниц. Не является исключением и FoxPro. В Visual FoxPro имеется мастер Web Publishing (Web-публикация), позволяющий формировать Web-страницы на основе баз данных. При этом пользователь может выбирать стили оформления страницы, предлагаемые мастером, а также использовать внешние таблицы стилей, созданные в других программных продуктах. Данные, размещаемые на странице, могут находиться в таблицах, локальных или удаленных представлениях базы данных. Рассмотрим работу мастера, а также предлагаемые им элементы оформления Web-страницы. 
</P>

<p>&nbsp;
<a NAME="1"></a><font size="4">Мастер Web Publishing </font> 
</P>
<P>
Чтобы создать Web-страницу с помощью мастера, выполните следующие действия: 
</P>
<ol>
  <li>Откройте базу данных проекта, содержащую таблицу, локальное или удаленное представление, информацию из которых хотите разместить на Web-странице. 
  </li>
  <li>В меню Tools (Сервис) выберите команду Wizards (Мастера), а затем опцию — Web Publishing (Web-публикация). 
  </li>
  <li>Запускается мастер и появляется его первое диалоговое окно, в котором 
  необходимо указать используемую таблицу или представление, и выбрать поля этой 
  таблицы, размещаемые на Web-странице. В области Databases and tables (Базы 
  данных и таблицы) окна мастера расположены два списка. Верхний список содержит название открытой базы данных, нижний — список ее таблиц и представлений. Выберите из нижнего списка требуемую таблицу. При этом в списке Available fields (Доступные поля) будут отображены все поля текущей таблицы (рис. 24.1). 
  </li>
  <li>Перенесите из списка Available fields (Доступные поля) в Selected fields (Выбранные поля) поля, которые хотите расположить на Web-странице. Для перехода к следующему шагу в работе мастера нажмите кнопку Next (Далее). 
  </li>
</ol>
<IMG src="gl24-1.jpg" alt="gl24-1.jpg" width="492" height="360" ></IMG>
<P>
Рис. 24.1. Первое окно мастера 
</P>
<ol>
  <li value="5">На втором шаге задается критерий сортировки данных (рис. 24.2). Поля, по которым будет осуществляться упорядочение, необходимо разместить в списке Selected fields (Выбранные поля). Для переноса полей из списка Available fields or index tag (Имеющиеся поля и индексы) в список Selected fields (Выбранные поля) можно использовать кнопку Add (Добавить) или мышь. Опции Ascending (По возрастанию) и Descending (По убыванию) определяют, по возрастанию или по убыванию будут упорядочиваться данные в указанном поле. 
  </li>
</ol>
<blockquote>
<P>
Задав сортировку данных, нажмите кнопку Next (Далее). 
</P>
</blockquote>
<IMG src="gl24-2.jpg" alt="gl24-2.jpg" width="492" height="360" ></IMG>
<P>
Рис. 24.2. Указание сортировки данных 
</P>
<ol>
  <li value="6">На третьем шаге задается макет Web-страницы и стиль отображения объектов (рис. 24.3). Диалоговое окно мастера содержит два списка. С помощью списка Data layouts (Расположение данных), содержащего пять значений, определяется расположение данных на странице, т. е. макет данных. Получаемый вид страницы в зависимости от выбранного макета данных можно просмотреть в области просмотра, расположенной в правом верхнем углу окна мастера. Список Visual styles (Визуальные стили) содержит флажки, позволяющие настроить стиль оформления Webстраницы установкой требуемых флажков. 
  </li>
</ol>
<IMG src="gl24-3.jpg" alt="gl24-3.jpg" width="492" height="360" ></IMG>
<P>
Рис. 24.3. Задание стиля оформления 
</P>
<blockquote>
<P>
Диалоговое окно мастера содержит кнопки следующего назначения: 
</P>
</blockquote>
<ul>
  <li>Options (Параметры) — открывает диалоговое окно для настройки параметров отображения данных на Web-странице; 
  </li>
  <li>Advanced (Дополнительно) — открывает диалоговое окно, позволяющее настроить параметры всей Web-страницы, разместить на ней помимо данных из таблицы, HTML-элементы (заголовки, текст, линии, бегущую строку и т. д.); 
  </li>
  <li>Preview (Просмотр) — загружает оформленную в соответствии с заданными стилями Web-страницу в обозреватель Internet Explorer без выхода из мастера. Вы можете просмотреть созданную страницу, в случае необходимости с помощью мастера изменить параметры настройки и снова просмотреть результат своей работы. 
  </li>
</ul>
<blockquote>
<P>
Используя расположенные в этом окне мастера объекты интерфейса, настройте 
параметры создаваемой Web-страницы и для перехода к следующему шагу нажмите кнопку Next (Далее). 
</P>
</blockquote>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Настройка параметров, осуществляемая на данном шаге мастера, будет рассмотрена чуть позже.
</font> 
</P>
<ol>
  <li value="7">На заключительном шаге создания Web-страницы с помощью мастера (рис. 24.4) укажите предполагаемые действия с созданной страницей, используя опции, описанные в табл. 24.1. 
  </li>
</ol>
<P>
Таблица 24.1. Опции окна Web Publishing Wizard  Step 4 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Опция 
</TD>
<TD VALIGN="TOP">
Действие 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save web page for later use
(Сохранить Web-страницу) 
</TD>
<TD VALIGN="TOP">
Созданная Web-страница сохраняется  на диске в файле с расширением НТМ 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save web page and modify it in the text editor (Сохранить Web-страницу и открыть 
для модификации в текстовом редакторе) 
</TD>
<TD VALIGN="TOP">
Созданная  Web-страница  сохраняется  на диске в файле с расширением НТМ и открывается в текстовом редакторе для модификации 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save web page and open it in a browser (Сохранить Web-страницу и открыть для 
просмотра в Webбраузере) 
</TD>
<TD VALIGN="TOP">
Созданная Web-страница сохраняется  на диске в файле с расширением НТМ и открывается для просмотра в Web-браузере 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Create script for generating web page (Создать скрипт генерации Web-страницы) 
</TD>
<TD VALIGN="TOP">
Созданная   Web-страница   сохраняется   в виде скрипта, т. е. генерируется программный файл с расширением PRG, при запуске которого на выполнение динамически создается Web-страница 
</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl24-4.jpg" alt="gl24-4.jpg" width="492" height="360" ></IMG> </p>
<P>
Рис. 24.4. Заключительное окно мастера 
</P>
<blockquote>
<P>
Диалоговое окно содержит флажок Save style (Сохранить стиль). При его установке в расположенное справа поле можно ввести имя файла, в котором будет сохранен стиль, полученный при создании Web-страницы. 
</P>
</blockquote>
<ol>
  <li value="8">После того как все параметры заданы, нажмите кнопку Finish (Готово). Откроется диалоговое окно Save as (Сохранить как), в котором укажите имя файла и папку, в которой созданная Web-страница должна быть сохранена. На этом создание Web-страницы завершено. 
  </li>
</ol>
<p>&nbsp;
<a NAME="2"></a><font size="4">Настройка параметров
Web-страницы
с помощью мастера </font> 
</P>
<P>
Мы рассмотрели создание Web-страницы с помощью мастера Web Publishing 
</P>
<P>
(Web-публикация). Теперь более подробно остановимся на параметрах, настраиваемых на третьем шаге работы мастера (см. рис. 24.3). 
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Диалоговое окно Layout Options </font> 
</P>
<P>
Диалоговое окно Layout Options (Параметры расположения) (рис. 24.5) предназначено для настройки параметров данных, отображаемых на Webстранице 
из таблицы или представления данных. Оно открывается при нажатии на третьем шаге работы мастера кнопки Options (Параметры) и содержит несколько вкладок. Находящиеся в окне Layout Options (Параметры расположения) вкладки, а также отображаемые на них параметры зависят от значения, выбранного из списка Data layouts (Расположение данных), т. е. от макета данных. 
</P>
<IMG src="gl24-5.jpg" alt="gl24-5.jpg" width="401" height="296" ></IMG>
<P>
Рис. 24.5. Диалоговое окно Layout Options 
</P>
<P>
Вкладки диалогового окна Layout Options (Параметры расположения) позволяют настроить следующие параметры Web-страницы: 
</P>
<ul>
  <li>Border (Граница) — для данных, отображаемых в виде таблицы, цвет обрамления и фона, толщину границ. Поле Background image (Фоновое изображение) позволяет использовать в качестве фона область, в которой располагаются данные, графическое изображение; 
  </li>
</ul>
<IMG src="gl24-6.jpg" alt="gl24-6.jpg" width="401" height="296" ></IMG>
<P>
Рис. 24.6. Вкладка Relations диалогового окна Layout Options 
</P>
<ul>
  <li>Font (Шрифт) — задает семейство шрифтов (наименование, размер и цвет), которые будут использоваться при открытии Web-страницы, если у пользователя отсутствует шрифт, используемый при создании этой страницы; 
  </li>
  <li>Other (Другие) — используемый для оформления страницы HTML-класс. Кроме того, вкладка содержит параметры, специфичные для разных макетов 
  данных. Так, например, с помощью объектов интерфейса этой вкладки строки или 
  группы строк табличных данных можно выделить разными цветами. Или, например, 
  задать цвет строки, на которой установлен курсор; </li>
  <li>Relations (Отношения) (рис. 24.6) — данная вкладка присутствует в окне Options (Параметры) только для макета типа Tabular Hierarchical
(Табличная иерархия). Она позволяет создавать иерархические таблицы. Например, вы можете отобразить на странице список покупателей и выполненные ими заказы. Web-страница, созданная с использованием настроек вкладки Relations (Отношения),. 
  </li>
</ul>
<p>&nbsp;
<a NAME="4"></a><font size="4">Диалоговое окно Advanced </font> 
</P>
<P>
При нажатии кнопки Advanced (Дополнительно) на третьем шаге мастера появляется 
одноименное диалоговое окно, показанное на рис. 24.7. Оно позволяет использовать при создании Web-страницы внешние таблицы стилей (ess), созданные с помощью других программ, задать фон страницы, разместить на Web-странице HTML-элементы, такие как заголовок, текст, бегущая строка, линия и т. д. 
</P>
<IMG src="gl24-8.jpg" alt="gl24-8.jpg" width="500" height="251" ></IMG>
<P>
Рис. 24.7. Диалоговое окно Advanced 
</P>
<P>
В верхнем левом углу диалогового окна Advanced (Дополнительно) расположено поле Cascading style sheet (Внешняя таблица стилей), позволяющее указать расположение внешней таблицы стилей, используемой для оформления Web-страницы. 
</P>
<P>
Область Body (Тело) содержит два элемента. Список Color (Цвет) позволяет задать фон Web-страницы. Этот параметр имеет более высокий приоритет по отношению к цвету, установленному с помощью макета данных или визуального стиля. Поле Image (Изображение) позволяет указать расположение графического файла, размещаемого на странице. 
</P>
<P>
Установленный флажок Copy Graphics to HTML output location (Копировать графику) 
указывает, что любой графический файл, используемый для размещения на странице, копируется в папку, в которой сохраняется Webстраница. 
</P>
<P>
В области Additional HTML items (Добавленные HTML-элементы) содержится список 
элементов, используемых в оформлении Web-страницы. Находящиеся здесь же кнопки имеют назначение, описанное в табл. 24.2. 
</P>
<P>
Таблица 24.2. Назначение кнопок области Additional HTML Items 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Add (Добавить) 
</TD>
<TD VALIGN="TOP">
Открывает диалоговое окно HTML Item (HTML-элемент) (рис. 24.8),  позволяющее добавить элемент оформления на Web-страницу 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Edit (Правка) 
</TD>
<TD VALIGN="TOP">
Открывает диалоговое окно HTML Item (HTML-элемент) для редактирования выбранного из списка текущей области элемента оформления Web-страницы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Remove (Удалить) 
</TD>
<TD VALIGN="TOP">
Удаляет выделенный HTML-элемент из списка 
</TD>
</TR>
</TABLE>
<P>
В нижней части окна расположены следующие три кнопки (табл. 24.3). 
</P>
<P>
Таблица 24.3. Кнопки окна Advanced 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save Settings
(Сохранить параметры) 
</TD>
<TD VALIGN="TOP">
Открывает диалоговое окно Save Settings (Сохранить параметры), в котором можно указать название созданного визуального стиля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Load Settings
(Загрузить параметры) 
</TD>
<TD VALIGN="TOP">
Открывает диалоговое окно Load Settings (Загрузить параметры), в котором содержится список сохраненных визуальных стилей 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Done (Применить) 
</TD>
<TD VALIGN="TOP">
Сохраняет и применяет к создаваемой Web-странице настройки окна 
</TD>
</TR>
</TABLE>
<P>
Используя область Additional HTML items (Добавленные HTML-элементы), можно сформировать список элементов оформления Web-страницы. Для добавления в список нового элемента предназначено диалоговое окно HTML Item (HTML-элемент) (рис. 24.8), открываемое при нажатии кнопки Add (Добавить). 
</P>
<IMG src="gl24-9.jpg" alt="gl24-9.jpg" width="430" height="353" ></IMG>
<P>
Рис. 24.8. Диалоговое окно HTML Item 
</P>
<P>
В его верхней части находится список Туре (Тип), содержащий типы HTML-элементов, которые могут быть размещены на Web-странице с помощью мастера, а список Location (Расположение) — его расположение на странице. Диалоговое окно HTML Item (HTML-элемент) позволяет добавить на Web-страницу следующие элементы: 
</P>
<ul>
  <li>Text — обычный текст, заголовки различных уровней; </li>
  <li>Hyperlink — гиперссылка; </li>
  <li>Image — графическое изображение; </li>
  <li>Marquee — бегущая строка текста; </li>
  <li>Horizontal Rule — горизонтальная линия; </li>
  <li>Line Break — линия разрыва; </li>
  <li>Tag — тег. </li>
</ul>
<P>
Количество доступных в диалоговом окне HTML Item (HTML-элемент) объектов интерфейса зависит от типа добавляемого элемента. Так, например, для текста можно указать сам текст, используемый при его отображении шрифт, размер, цвет, способ выравнивания информации. Для гиперссылки кроме перечисленных выше параметров можно также указать адрес, на который с помощью нее осуществляется переход, и т. д. 
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Создание Web-страницы </font> 
</P>
<P>
Мы рассмотрели работу мастера Web Publishing (Web-публикация). Теперь создадим с его помощью Web-страницу, которая будет содержать бегущую строку, заголовок и данные из представления GoodsCount. 
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Подготовка данных </font> 
</P>
<P>
Прежде чем приступить к созданию Web-страницы, необходимо подготовить размещаемые на ней данные. Это могут быть таблицы, содержащие требуемые данные, локальные или удаленные представления. Мы будем использовать локальное представление Goods count, в котором содержатся сведения о продажах различных товаров фирмы за истекший месяц. Требуемая нам информация содержится в таблицах ordsaled и Goods. Создадим представление данных: 
</P>
<ol>
  <li>Откройте окно конструктора представлений. Для этого на вкладке Data (Данные) окна конструктора проекта перейдите в раздел Local Views (Локальные представления данных) выбранной базы данных и нажмите кнопку New (Новый). 
  </li>
  <li>Добавьте в него таблицы ordsaled и Goods, используемые для создания представления. 
  </li>
  <li>Установите связи между размещенными в окне конструктора таблицами по коду товара. 
  </li>
  <li>В список Selected fields (Выбранные поля) перенесите код, наименование и описание товара. 
  </li>
</ol>
<ol>
  <li value="5">Добавьте в список Selected fields (Выбранные поля) вычисляемое поле содержащее количество продаж: SUM(Ordsaled.nquant) 
  </li>
  <li>На вкладке Group By (Группировка) конструктора задайте группировку данных по коду товара. 
  </li>
  <li>Упорядочите данные по наименованию товара, используя для этого вкладку Order By (Сортировка). 
  </li>
  <li>Для сохранения представления данных в меню File (Файл) выберите команду Save As (Сохранить как). В поле View Name (Имя представления) открывшегося диалогового окна Save (Сохранить) укажите имя создаваемого представления данных GoodsCount и нажмите кнопку ОК. 
  </li>
  <li>Просмотрите созданное представление данных, чтобы убедиться, что оно содержит требуемые данные. Для этого нажмите кнопку Run (Выполнить) на стандартной панели инструментов. 10. Закройте окно конструктора представлений. 
  </li>
</ol>
<p>&nbsp;
<a NAME="7"></a><font size="4">Настройка параметров </font> 
</P>
<P>
После того как данные подготовлены, можно приступать к формированию Web-страницы: 
</P>
<ol>
  <li>Откройте базу данных проекта, содержащую созданное локальное представление данных GoodsCount. 
  </li>
  <li>В меню Tools (Сервис) выберите команду Wizards (Мастера), а затем опцию — Web Publishing (Web-публикация). 
  </li>
  <li>На первом шаге мастера из нижнего списка области Databases and tables (Базы данных и таблицы) выберите представление GoodsCount. Затем перенесите все поля представления из списка Available fields (Доступные поля) в список Selected fields (Выбранные поля). Чтобы перейти к следующему шагу, нажмите кнопку Next (Далее). 
  </li>
  <li>Открывается окно мастера, позволяющее задать макет Web-страницы и стиль отображения объектов (см. рис. 24.3). По умолчанию из списка Data layouts (Расположение данных) выбрано значение Static List View (Статическая таблица). Оставьте данное значение. 
  </li>
  <li>Чтобы добавить на Web-страницу бегущую строку и заголовок, нажмите кнопку Advanced (Дополнительно). Открывается одноименное диалоговое окно (см. рис. 24.7). 
  </li>
  <li>Нажмите кнопку Add (Добавить), расположенную в области Additional HTML items (Добавленные HTML-элементы). 
  </li>
  <li>Из списка Туре (Тип) открывшегося диалогового окна HTML Item (HTML-элемент) выберите значение Marquee (Бегущая строка). 
  </li>
  <li>В поле Text (Текст) введите текст бегущей строки. Например, Мы рады приветствовать Вас на своем сайте!. 
  </li>
  <li>Чтобы задать наименование шрифта, нажмите кнопку с тремя точками, 
  расположенную справа от поля Font name (Наименование шрифта). Открывается диалоговое окно Pick Font (Выберите шрифт). Используя содержащийся в нем список, укажите используемый в бегущей строке шрифт и нажмите кнопку ОК. 
  </li>
  <li>С помощью списка Size (Размер) задайте размер шрифта. </li>
  <li>Используя списки Backcolor (Цвет фона) и Forecolor (Цвет надписи), укажите цвет фона и текста бегущей строки. 
  </li>
  <li>Нажмите кнопку ОК. Диалоговое окно HTML Item (HTML-элемент) закрывается, а в список Additional HTML items (Добавленные HTMLэлементы) добавляется одно значение. Бегущая строка размещена на Web-странице. Теперь добавим на страницу заголовок. 
  </li>
  <li>Снова нажмите кнопку Add (Добавить), расположенную в области Additional HTML items (Добавленные HTML-элементы). 
  </li>
  <li>В списке Туре (Тип) открывшегося диалогового окна HTML Item (HTML-элемент) оставьте установленное по умолчание значение Text (Текст). 
  </li>
  <li>В поле Text (Текст) введите текст заголовка. Например, Продажи товара за ноябрь 2001 года. 
  </li>
  <li>Из списка Heading (Заголовок) выберите размер заголовка. </li>
  <li>Используя список Forecolor (Цвет надписи), укажите цвет заголовка. </li>
  <li>Нажмите кнопку ОК. Диалоговое окно HTML Item (HTML-элемент) закрывается, а в список Additional HTML items (Добавленные HTMLэлементы) добавляется второе значение. Заголовок размещен на Webстранице. 
  </li>
  <li>Закройте диалоговое окно Advanced (Дополнительно), нажав кнопку Done (Применить). 
  </li>
  <li>Для перехода к заключительному шагу мастера нажмите кнопку Next (Далее). 
  </li>
  <li>В заключительном окне мастера установите требуемую опцию из предлагаемых и нажмите кнопку Finish (Готово). 
  </li>
  <li>В открывшемся диалоговом окне Save as (Сохранить как) укажите имя файла и папку, в которой хотите сохранить созданную Web-страницу. Создание Web-страницы завершено. 
  </li>
</ol>
<p>&nbsp;
<a NAME="8"></a><font size="4">Редактирование созданной Web-страницы </font> 
</P>
<P>
Файл с расширением НТМ, полученный в результате работы мастера Web Publishing (Web-публикация), может быть отредактирован средствами редактора программы Visual FoxPro. Для открытия данного файла в меню File (файл) выберите команду Open (Открыть), в списке Тип файлов укажите расширение НТМ, 
выберите требуемый файл на диске и нажмите кнопку ОК. После того как 
редактирование завершено, сохраните изменения, нажав на панели инструментов кнопку Save (Сохранить). Для просмотра отредактированной Web-страницы в браузере 
запустите обозреватель Internet Explorer и в строке адреса укажите местоположение и название файла. 
</P>
</BODY>
</HTML>