<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 11 
<br>
Меню приложения</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl11.html#1">Подготовка к созданию меню</a>
  <li><a href="gl11.html#2">Действия, необходимые для создания меню</a>
  <li><a href="gl11.html#3">Запуск конструктора меню </a>
  <li><a href="gl11.html#4">Создание меню</a>
  <li><a href="gl11.html#5">"Горячие" клавиши</a>
  <li><a href="gl11.html#6">Задание параметров пункта меню в диалоговом окне Prompt Options</a>
  <li><a href="gl11.html#7">Действия для пунктов меню </a>
  <li><a href="gl11.html#8">Разделители элементов меню</a>
  <li><a href="gl11.html#9">Определение параметров меню </a>
  <li><a href="gl11.html#10">Сохранение, генерация и запуск меню </a>
  <li><a href="gl11.html#11">Создание всплывающего меню</a>
</ul>

<P>
В соответствии со стандартами Windows в любом приложении рекомендуется иметь строку меню, которая в Visual FoxPro содержит команды, предназначенные для вызова форм, формирования отчетов, запросов и т. д. 
</P>
<P>
При разработке приложения вы можете создать все требуемые объекты (базу данных, входящие в нее таблицы, формы, отчеты, запросы). Затем объединить отдельные объекты с помощью меню. Можно поступить иначе. Сначала разработать и создать меню, а затем по мере создания форм и отчетов включать их запуск в меню. Второй способ более нагляден. Вы в любой момент можете запустить меню и продемонстрировать заказчику, как создаваемая система выглядит, как осуществляется вызов тех или иных программ, запустить уже созданные формы, напечатать подготовленные отчеты. 
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Подготовка к созданию меню </font> 
</P>
<P>
На начальном этапе разработки необходимо определить требования, предъявляемые к создаваемому приложению, состав информации, которая будет содержаться в проектируемой базе данных. 
</P>
<P>
После этого определяется структура таблиц и совпадающие поля для их связывания. Затем создаются сами таблицы, входящие в базу данных, определяются отношения между ними. 
</P>
<P>
Одновременно с составом информации вы должны определить те средства, которые получит в свое распоряжение пользователь при работе с вашим приложением. 
</P>
<P>
Приложение должно содержать эффективную справочную систему, содержащую 
информацию о приложении, описание его основных функций и инструкцию по работе. В среде Windows предпочтительнее всего создавать справочную систему в принятом в Windows стандарте, чтобы облегчить пользователю поиск информации в знакомой ему среде. 
</P>
<P>
После того как определена структура данных, спроектированы таблицы, входящие в базу данных, вы можете приступить к разработке структуры меню. Прежде чем описывать структуру меню в конструкторе, нарисуйте эскиз меню на бумаге, посоветуйтесь с пользователями приложения. 
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">Действия, необходимые для создания меню </font> 
</P>
<P>
Строкой меню называется горизонтальное меню, располагаемое в верхней части экрана. Примером строки меню является основное меню Visual FoxPro, а также меню программ, работающих в среде Windows. Созданное вами в конструкторе меню может замещать основное меню Visual FoxPro или добавляться к нему. 
</P>
<P>
Для создания меню необходимо выполнить следующие действия: 
</P>
<ol>
  <li>Открыть окно конструктора меню. </li>
  <li>Описать вид меню, текст, пункты меню и его атрибуты. </li>
  <li>Определить действия, которые будут выполняться при выборе пунктов меню. 
  </li>
  <li>Сгенерировать меню, используя команду Generate (Генерация) из меню Menu (Меню). При этом создается программа, которую вы в результате и запускаете на выполнение. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">На каждом шаге создания меню приложения вы можете просматривать его с помощью кнопки Preview (Просмотр) конструктора.
</font> 
</P>
<P>
Рассмотрим эти этапы более подробно. 
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Запуск конструктора меню </font> 
</P>
<P>
Для открытия окна конструктора меню воспользуйтесь одним из следующих способов: 
</P>
<ul>
  <li>В меню File (Файл) выберите команду New (Новый). В открывшемся диалоговом окне New установите опцию Menu (Меню) и нажмите кнопку New File (Новый файл). 
  </li>
  <li>В окне проекта перейдите на вкладку Other (Остальные) и выберите группу Menus (Меню). Затем нажмите кнопку New (Новый) окна проекта. 
  </li>
  <li>Находясь в группе Menus (Меню) окна проекта, нажмите кнопку New (Новый) на 
  стандартной панели инструментов Visual FoxPro. В открывшемся диалоговом окне New (Новый) установите опцию Menu (Меню) и нажмите кнопку New File (Новый файл). 
  </li>
</ul>
<P>
На экране открывается диалоговое окно New Menu (Новое меню), в котором предлагается два варианта меню (рис. 11.1). 
</P>
<ul>
  <li>Menu — меню в виде строки. </li>
  <li>Shortcut — всплывающее меню, в котором основные пункты расположены по вертикали. 
  </li>
</ul>
<IMG src="gl11-1.jpg" alt="gl11-1.jpg" ></IMG>
<P>
Рис. 11.1. Диалоговое окно New Menu 
</P>
<P>
Выберите тип создаваемого меню, нажав соответствующую кнопку. В результате запускается конструктор меню, а в основное меню Visual FoxPro добавляется новый пункт Menu (Меню) (рис. 11.2). Сначала рассмотрим создание меню в виде строки. Для этого выберите опцию Menu (Меню). 
</P>
<IMG src="gl11-2.jpg" alt="gl11-2.jpg" ></IMG>
<P>
Рис. 11.2. Конструктор меню 
</P>
<P>
Область конструктора меню, над которой размещены надписи Prompt (Приглашение), Result (Результат) и Options (Опции), предназначена для формирования меню. 
</P>
<P>
В поле Prompt (Приглашение) можно ввести наименования пунктов меню. Раскрывающийся список Result (Результат) используется для указания типа пункта меню. Кнопка Options (Опции) открывает диалоговое окно Prompt Options (Опции элемента меню), в котором можно определить дополнительные 
параметры данного элемента меню (&quot;горячие&quot; клавиши, сообщение, отображаемое в 
строке состояния при выборе пункта меню, и т. д.). В списке Menu level (Уровень меню) указывается уровень текущего меню. 
</P>
<P>
Слева в конструкторе меню размещены кнопки (табл. 11.1). 
</P>
<P>
Таблица 11.1. Назначение кнопок конструктора меню 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Insert (Вставить) 
</TD>
<TD VALIGN="TOP">
Добавляет в меню новый пункт 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Insert Bar (Вставить команды системного меню) 
</TD>
<TD VALIGN="TOP">
Открывает диалоговое окно Insert System Menu Bar, содержащее команды системного 
меню Visual FoxPro, позволяя разместить их в создаваемом пользовательском меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Delete (Удалить) 
</TD>
<TD VALIGN="TOP">
Удаляет текущий пункт меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Preview (Просмотр) 
</TD>
<TD VALIGN="TOP">
Размещает создаваемое меню на экране, позволяя просмотреть его внешний вид 
</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="4"></a><font size="4">Создание меню </font> 
</P>
<P>
После того как вы открыли конструктор, можно приступать к созданию меню. Для этого выполните следующие действия: 
</P>
<ol>
  <li>В поле Prompt (Приглашение) введите наименования первого пункта меню и нажмите клавишу &lt;Enter&gt; или &lt;ТаЬ&gt; для перехода на следующее поле. Курсор оказывается в списке Result (Результат). 
  </li>
  <li>Для определения типа пункта меню (табл. 11.2) нажмите кнопку раскрытия списка и выберите необходимое значение из тех, которые предлагает система. 
  </li>
</ol>
<P>
Таблица 11.2. Типы пунктов меню 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Тип меню 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Command (Команда) 
</TD>
<TD VALIGN="TOP">
При выборе пункта меню данного типа будет выполняться связанная с ним команда 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Pad Name
(Наименование строки меню) 
</TD>
<TD VALIGN="TOP">
При выборе пункта меню никаких действий выполняться не будет. Как правило, используется в качестве дополнительного пояснения к меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Submenu (Подменю) 
</TD>
<TD VALIGN="TOP">
При выборе пункта меню раскрывается связанное с данным пунктом ниспадающее меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Procedure
(Процедура) 
</TD>
<TD VALIGN="TOP">
При выборе пункта меню вызывается процедура, определенная для данного пункта меню 
</TD>
</TR>
</TABLE>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">При использовании значения типа Command (Команда) с правой стороны появляется поле для ввода команды, выполняемой при выборе данного пункта меню. Это может быть, например, команда вызова формы или формирования отчета. Если из списка Result (Результат) вы выбрали значение Procedure (Процедура) или Submenu (Подменю), в окне конструктора правее описания типа пункта меню появляется кнопка Create (Создать). При нажатии на эту кнопку вы переходите, соответственно, в окно создания процедуры или в окно создания ниспадающего меню для выбранного пункта меню.
</font> 
</P>
<IMG src="gl11-3.jpg" alt="gl11-3.jpg" ></IMG>
<P>
Рис. 11.3. Основное меню приложения 
</P>
<ol>
  <li value="3">Указав тип пункта меню, перейдите в следующую строку и введите информацию о втором пункте меню. 
  </li>
  <li>Введите наименования остальных пунктов меню и их типы (рис. 11.3). </li>
  <li>Для просмотра созданных пунктов меню нажмите кнопку Preview (Просмотр). Основное меню Visual FoxPro будет заменено созданным меню. Пункты меню отображаются на экране в порядке их описания. На экране также появляется диалоговое окно Preview (Просмотр), в котором отображается текст текущего пункта меню, его тип и выполняемое действие (рис. 11.4). 
  </li>
</ol>
<IMG src="gl11-4.jpg" alt="gl11-4.jpg" ></IMG>
<P>
Рис. 11.4. Просмотр созданного меню приложения 
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">&quot;Горячие&quot; клавиши </font> 
</P>
<P>
Для выбора пункта меню используются клавиши-стрелки или мышь. Помимо этого, вы можете определить для пункта меню &quot;горячую&quot; клавишу, нажатие которой вместе с клавишей &lt;Alt&gt; активизирует этот пункт. 
</P>
<P>
Для создания &quot;горячей&quot; клавиши, предоставляющей пользователю возможность ускоренного выбора пункта меню, необходимо включить в его имя
перед активизирующим символом следующие символы \&lt;. В качестве &quot;горячей&quot; клавиши можно использовать первый символ имени пункта, что, конечно, более предпочтительно, а также и любой другой символ из его имени. Символы, используемые в качестве &quot;горячей&quot; клавиши, выделяются в строке меню подчеркиванием. 
</P>
<P>
&quot;Горячие&quot; клавиши для пунктов меню назначаются Visual FoxPro по умолчанию. Для их создания используются первые буквы элементов строки меню. Если два элемента вашего меню начинаются с одинаковой буквы, то обоим элементам строки меню в качестве &quot;горячей&quot; клавиши назначается одинаковый символ. В этом случае вам нужно переопределить &quot;горячую&quot; клавишу для одного из элементов строки меню. 
</P>
<P>
Для облегчения назначения &quot;горячих&quot; клавиш можно использовать искусственный прием: перед именами пунктов меню разместить цифры и их использовать в качестве &quot;горячих&quot; клавиш (рис. 11.5). 
</P>
<IMG src="gl11-5.jpg" alt="gl11-5.jpg" ></IMG>
<P>
Рис, 11.5. Создание строки меню с назначенными &quot;горячими&quot; клавишами 
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Задание параметров пункта меню в диалоговом окне Prompt Options
</font> 
</P>
<P>
Для задания параметров пункта меню используется диалоговое окно Prompt Options 
(Опции элемента меню) (рис. 11.6). Для открытия этого окна установите в конструкторе курсор на пункт меню и нажмите появившуюся в строке кнопку Options (Опции). 
</P>
<IMG src="gl11-6.jpg" alt="gl11-6.jpg" ></IMG>
<P>
Рис. 11.6. Диалоговое окно Prompt Options 
</P>
<P>
В диалоговом окне Prompt Options (Опции элемента меню) содержится область Shortcut (Всплывающее меню) для задания клавиш быстрого вызова, а также поля ввода (табл. 11.3). 
</P>
<P>
Таблица 11.3. Назначение полей ввода диалогового окна Prompt Options 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Поле ввода 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Skip For {Пропустить для) 
</TD>
<TD VALIGN="TOP">
Позволяет заблокировать пункт меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Message (Сообщение) 
</TD>
<TD VALIGN="TOP">
Позволяет задать сообщение,  которое будет отображаться в строке состояния при выборе пункта меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Pad  Name   (Имя   пункта меню) 
</TD>
<TD VALIGN="TOP">
Задает имя пункта меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Comment (Комментарий) 
</TD>
<TD VALIGN="TOP">
Задает комментарий к пункту меню 
</TD>
</TR>
</TABLE>
<P>
Область Negotiate (Соглашение) содержит два раскрывающихся списка, имеющих следующее назначение: 
</P>
<ul>
  <li>Container (Контейнер) — определяет расположение меню при редактировании по месту OLE-объектов; 
  </li>
  <li>Object (Объект) — задает расположение меню при выполнении приложения типа Active Document в Web-браузере. 
  </li>
</ul>
<p>&nbsp;
<font size="4">Определение клавиш быстрого вызова пунктов меню </font> 
</P>
<P>
Помимо &quot;горячих&quot; клавиш, в создании которых используются только символы текста меню, в Visual FoxPro можно определить для каждого пункта меню клавиши быстрого вызова пунктов меню. В качестве такой клавиши могут использоваться символы, функциональные клавиши, комбинации клавиш. Примером клавиши ускоренного действия в программе Visual FoxPro является функциональная клавиша &lt;F1&gt;, используемая для вызова справочной системы. При нажатии на клавишу, определенную в качестве клавиши ускоренного 
действия, активизируется связанный с ней пункт меню без предварительного отображения самого меню. 
</P>
<P>
Рассмотрим последовательность действий по определению клавиши быстрого вызова пункта меню справочной системы приложения. 
</P>
<ol>
  <li>В конструкторе меню установите курсор на пункт меню Справка. </li>
</ol>
<IMG src="gl11-7.jpg" alt="gl11-7.jpg" ></IMG>
<P>
Рис. 11.7. Определение клавиши быстрого вызова для пункта меню Справка 
</P>
<ol>
  <li value="2">Нажмите кнопку Options (Опции). </li>
  <li>В открывшемся диалоговом окне Prompt Options (Опции элемента меню) в области Shortcut (Всплывающее меню) поле Key Label (Метка) содержит подсказку press the key (нажмите клавишу). Установите курсор в поле Key Label (Метка) и нажмите клавишу или комбинацию клавиш, используемую в качестве клавиши быстрого вызова, и в поле появится метка, соответствующая нажатию клавиши. В поле ввода Key Text (Пояснение) вы можете ввести краткое пояснение к определяемой клавише. Для пункта меню Справка нажмите клавишу &lt;F1&gt; клавиатуры. В поле Key Text (Пояснение) по умолчанию будет введено F1 (рис. 11.7). Оставьте это значение. 
  </li>
  <li>Нажмите кнопку ОК для закрытия диалогового окна. </li>
</ol>
<P>
<b>Формирование сообщения для пункта меню </b> 
</P>
<P>
Используя поле ввода Message (Сообщение) диалогового окна Prompt Options (Опции элемента меню), вы можете определить для пункта меню сообщение, которое будет отображаться в строке состояния при установке на него курсора. В качестве сообщения можно использовать не только строку текста, но и произвольное символьное выражение. В этом случае нажмите кнопку вызова конструктора выражения, расположенную с правой стороны поля, и в открывшемся диалоговом окне Expression Builder (Построитель выражения) создайте необходимое выражение. 
</P>
<P>
Определим сообщение для пункта меню Справка. Для этого выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку Options (Опции) для пункта меню Справка. </li>
  <li>В открывшемся диалоговом окне Prompt Options (Опции элемента меню) нажмите кнопку вызова построителя выражения для поля Message (Сообщение). 
  </li>
  <li>В поле Message (Сообщение) построителя выражений введите строку текста &quot;Вызов справочной системы приложения &quot;. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Введенную строку текста не забудьте поместить в кавычки.
</font> 
</P>
<ol>
  <li value="4">Нажмите кнопку ОК для закрытия диалогового окна Expression Builder (Построитель выражения). Вы оказываетесь в окне Prompt Options (Опции элемента меню). Введенное вами выражение размещено в поле Message (Сообщение) (рис. 11.8). 
  </li>
  <li>Нажмите кнопку ОК. </li>
</ol>
<IMG src="gl11-8.jpg" alt="gl11-8.jpg" ></IMG>
<P>
Рис. 11.8. Определение сообщения для пункта меню Справка 
</P>
<P>
Аналогичным образом вы можете определить сообщения для остальных пунктов меню. На рис. 11.9 показан результат вывода сообщения в строке состояния. 
</P>
<IMG src="gl11-9.jpg" alt="gl11-9.jpg" ></IMG>
<P>
Рис. 11.9. Отображение в строке состояния сообщения для пункта меню 
</P>
<P>
<b>Блокирование команд меню </b> 
</P>
<P>
Иногда возникает необходимость сделать какой-либо пункт меню недоступным для 
пользователя. Например, вы можете использовать условие блокировки для 
ограничения доступа определенных пользователей к отдельным пунктам меню. Или 
рассмотрим еще такую ситуацию. Ваша система уже эксплуатируется пользователями, 
но не все пункты меню завершены. При их выборе на экране появляются сообщения об 
ошибках. Пользователь начинает нервничать. В этом случае вы можете задать для незавершенных пунктов меню условие блокировки. Чтобы определить условия блокировки, выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку Options (Опции) для пункта меню, который хотите заблокировать. 
  </li>
  <li>В открывшемся диалоговом окне Prompt Options (Опции элемента меню) нажмите кнопку вызова построителя выражения для поля Skip For (Пропустить для). 
  </li>
  <li>Введите .71 в поле Skip For (Пропустить для) построителя выражений. </li>
  <li>Нажмите кнопку ОК для закрытия диалогового окна Expression Builder (Построитель выражения). Вы оказываетесь в окне Prompt Options
(Опции элемента меню). </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Задавая условия блокировки, вы можете ввести любое допустимое логическое выражение. При вводе простого выражения, не требующего использования функций конструктора выражений, введите формируемое выражение в поле Skip For (Пропустить для) диалогового окна Prompt Options (Опции элемента меню).
</font> 
</P>
<ol>
  <li value="5">Нажмите кнопку ОК для его закрытия. </li>
</ol>
<P>
Когда значение выражения, заданное в условии блокировки, является истинным, пункт меню становится недоступным. 
</P>
<P>
В режиме просмотра вы не увидите, что пункт меню заблокирован. Чтобы убедиться в правильно созданной блокировке, вам необходимо созданное в конструкторе меню сгенерировать и полученную в результате программу запустить на выполнение. 
</P>
<P>
<b>Присвоение имени пункту меню </b> 
</P>
<P>
По умолчанию при генерации программы Visual FoxPro в качестве имен пунктов меню создает уникальные имена. Для повышения читабельности программы можно определить эти имена явным образом, используя поле
ввода Pad Name (Имя пункта меню) диалогового окна Prompt Options (Опции элемента меню). 
</P>
<P>
На рис. 11.10 приведено диалоговое окно Prompt Options (Опции элемента меню) для пункта меню Справка с определенным для него именем пункта меню, сообщением в строке состояния и условием блокировки. 
</P>
<IMG src="gl11-10.jpg" alt="gl11-10.jpg" ></IMG>
<P>
Рис. 11.10. Диалоговое окно Prompt Options
для пункта меню Справка 
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Действия для пунктов меню </font> 
</P>
<P>
Основное назначение пункта меню — выполнять определенное для него действие. Результат выбора пункта меню задается его типом (табл. 11.4). 
</P>
<P>
Таблица 11.4. Типы пункта меню 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Тип пункта меню 
</TD>
<TD VALIGN="TOP">
Действие 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Submenu (Подменю) 
</TD>
<TD VALIGN="TOP">
Раскрывается связанное с данным пунктом меню ниспадающее подменю 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Procedure (Процедура) 
</TD>
<TD VALIGN="TOP">
Выполняется  процедура,   определенная  в   конструкторе меню 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Command (Команда) 
</TD>
<TD VALIGN="TOP">
Выполняется команда,  расположенная  в поле рядом с типом пункта меню 
</TD>
</TR>
</TABLE>
<P>
<b>Команда </b> 
</P>
<P>
Чтобы определить команду, которая будет выполняться при выборе пункта меню, необходимо выполнить следующие действия: 
</P>
<ol>
  <li>В столбце Result (Результат) конструктора меню выбрать из списка значение Command (Команда). 
  </li>
  <li>Ввести в поле, расположенное с правой стороны списка, команду Visual FoxPro, которая будет выполняться при выборе данного пункта меню. 
  </li>
</ol>
<P>
Обычно команды используются для вызова форм, отчетов, пользовательских процедур. Например, для запуска формы ввода списка клиентов достаточно ввести следующую команду: 
</P>
<P>
 DO FORM Client 
</P>
<P>
<b>Процедура </b> 
</P>
<P>
В том случае, если при выборе пункта меню должна выполняться некоторая последовательность команд, вам необходимо в столбце Result (Результат) окна конструктора выбрать для пункта меню тип Procedure (Процедура) и определить требуемые команды. 
</P>
<IMG src="gl11-11.jpg" alt="gl11-11.jpg" ></IMG>
<P>
Рис. 11.11. Окно редактирования процедуры для пункта меню Справка 
</P>
<P>
Для этого нажмите кнопку Create (Создать) и в открывшемся окне редактирования процедуры определите фрагмент кода, связанный с элементом строки меню. Например, для пункта меню Справка вы можете указать тип Procedure (Процедура) и в окне создания процедуры задать имя файла справки и команду вызова справочной системы (рис. 11.11). 
</P>
<P>
При вводе процедуры не используйте команду PROCEDURE, т. к. Visual FoxPro генерирует эту команду автоматически. 
</P>
<P>
Во время генерации для каждой процедуры, включенной в меню, Visual FoxPro создает уникальное имя и включает его вместе с указанием местонахождения процедуры в код, связанный с соответствующим элементом строки меню. 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">После определения текста процедуры наименование кнопки Create (Создать) изменяется на Edit (Правка).
</font> 
</P>
<P>
<b>Определение подменю </b> 
</P>
<P>
Большинство команд меню создаваемого приложения открывает подменю. Например, 
пункт меню Покупатели должен содержать команды Ввод данных, Отчеты и Запросы. Для создания данного подменю выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку Create (Создать) пункта меню Покупатели. На экране появляется пустое окно конструктора меню. Список Menu Level (Уровень меню) нового окна содержит метку текущего пункта меню. 
  </li>
  <li>Введите в поле Prompt (Приглашение) первой строки команду Ввод данных. Используя список Result (Результат), задайте тип созданного пункта меню. 
  </li>
  <li>Во второй строке введите команду Отчеты и также задайте тип. </li>
  <li>Аналогичным образом введите третью команду (рис. 11.12). </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Параметры пунктов подменю определяются аналогично определению пунктов строки меню. Для перехода в меню верхнего уровня используйте список Menu Level.
</font> 
</P>
<IMG src="gl11-12.jpg" alt="gl11-12.jpg" ></IMG>
<P>
Рис. 11.12. Окно создания подменю 
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Разделители элементов меню </font> 
</P>
<P>
Для улучшения внешнего вида, а также для объединения в группы схожие по смыслу команды в меню можно использовать разделительные линии. Разделительные линии представляют собой пункт меню, в котором в поле ввода Prompt (Приглашение) вместо наименования пункта вводятся символы \-. Рассмотрим создание разделительных линий в подменю Покупатели. Для этого выполните следующие действия: 
</P>
<ol>
  <li>Откройте файл меню в окне конструктора проекта. </li>
  <li>Перейдите в режим редактирования пункта меню Покупатели, нажав кнопку Create (Создать). 
  </li>
  <li>Вставьте новый элемент меню после пункта меню Ввод данных. Для этого установите курсор на пункт Отчеты и нажмите кнопку Insert (Вставить). 
  </li>
  <li>В поле Prompt (Приглашение) образованного подпункта меню New Item (Новый пункт) введите \-. , 
  </li>
  <li>Аналогично вставьте разделительную линию после пункта меню Отчеты. </li>
  <li>Нажмите кнопку Preview (Просмотр). Выберите пункт меню Покупатели.
На экране появится подменю с разделительными линиями (рис. 11.13). </li>
</ol>
<IMG src="gl11-13.jpg" alt="gl11-13.jpg" ></IMG>
<P>
Рис. 11.13. Создание разделителей в подменю Покупатели 
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">Определение параметров меню </font> 
</P>
<P>
Для строки меню вы можете определить процедуры, которые будут выполняться перед запуском меню, а также после выхода из него. Кроме того, вы можете указать месторасположение строки меню. Для этого используется диалоговое окно General Options (Основные параметры) (рис. 11.14), открываемое при выборе команды General Options (Основные параметры) из меню View (Вид). 
</P>
<P>
В группе Location (Размещение) этого диалогового окна можно выбрать один из вариантов размещения строки созданного меню (табл. 11.5). В поле Procedure (Процедура) вы можете ввести фрагмент программы, которая будет выполняться при активизации строки меню. 
</P>
<IMG src="gl11-14.jpg" alt="gl11-14.jpg" ></IMG>
<P>
Рис. 11.14. Диалоговое окно General Options 
</P>
<P>
Таблица 11.5. Группа переключателей Location диалогового окна
General Options 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Переключатель 
</TD>
<TD VALIGN="TOP">
Вид размещения 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Replace (Замещать) 
</TD>
<TD VALIGN="TOP">
Меню замещает основное меню Visual FoxPro 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Append (Добавить) 
</TD>
<TD VALIGN="TOP">
Меню добавляется в основное меню Visual FoxPro 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Before (Перед) 
</TD>
<TD VALIGN="TOP">
Меню вставляется перед указанным пунктом основного меню Visual FoxPro 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
After (После) 
</TD>
<TD VALIGN="TOP">
Меню размещается за указанным пунктом основного меню Visual FoxPro 
</TD>
</TR>
</TABLE>
<P>
Флажки Setup (Задать) и Cleanup (Очистить) используются для открытия окна редактирования процедуры, вызываемой при запуске сгенерированной программы с описанием меню, и процедуры, вызываемой перед завершением этой программы. 
</P>
<P>
При установленном флажке Top-Level Form (Форма высокого уровня) меню будет отображаться в отдельном окне. В противном случае меню можно использовать только в окне Visual FoxPro. 
</P>
<p>&nbsp;
<a NAME="10"></a><font size="4">Сохранение, генерация и запуск меню </font> 
</P>
<P>
Для сохранения созданного меню выберите команду Save as (Сохранить как) в меню File (Файл). В открывшемся диалоговом окне Save as (Сохранить как) из списка Папка выберите папку, в которой вы предполагаете сохранить файл, откройте ее, в поле Save Menu (Сохранить меню) введите имя сохраняемого меню. В заключение нажмите кнопку Сохранить. 
</P>
<P>
С помощью кнопки Preview (Просмотр) окна конструктора меню можно просмотреть внешний вид создаваемого меню, но нельзя его активизировать. Чтобы можно было использовать меню в приложениях,  его необходимо предварительно сгенерировать. Для этого выполните следующие действия: 
</P>
<ol>
  <li>В меню Menu (Меню) выберите команду Generate (Генерация). Откроется диалоговое окно Generate Menu (Генерация меню) (рис. 11.15). 
  </li>
  <li>В поле Output File (Внешний файл) введите имя файла, который будет создан в результате генерации. 
  </li>
  <li>Для запуска генерации описания меню нажмите кнопку Generate (Генерация). 
  </li>
</ol>
<IMG src="gl11-15.jpg" alt="gl11-15.jpg" ></IMG>
<P>
Рис. 11.15. Диалоговое окно Generate Menu 
</P>
<P>
После завершения генерации можно запустить программу меню на выполнение. Для этого выполните одно из следующих действий.</P>
<ul>
  <li>В окне проекта установите курсор на наименование созданного меню и
нажмите кнопку Run (Запустить). </li>
  <li>В меню Program (Программа) выберите команду Do (Выполнить). В открывшемся диалоговом окне Do (Выполнить) откройте папку, в которой вы сохранили файл меню, выберите файл с расширением MPR и нажмите кнопку Do (Выполнить). 
  </li>
</ul>
<P>
На экране появится созданное вами меню, которое заменит основное меню Visual FoxPro, если в диалоговом окне General Options (Основные параметры) перед генерацией была установлена опция Replace (Замещать). 
</P>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Если вам не удается восстановить на экране системное меню Visual FoxPro, введите в командном окне команду SET SYSMENU то DEFAULT.
</font> 
</P>
<p>&nbsp;
<a NAME="11"></a><font size="4">Создание всплывающего меню </font> 
</P>
<P>
В Visual FoxPro 7.0 имеется возможность создания всплывающего меню средствами конструктора меню. 
</P>
<P>
Способ создания меню данного типа аналогичен созданию горизонтального меню в виде строки. Для этого меню, как и для обычного, можно определить оперативные клавиши и опции, устанавливаемые в диалоговом окне Prompt Options (Опции элемента меню). </P>
<P>
Чтобы создать всплывающее меню, выполните следующую последовательность действий: 
</P>
<ol>
  <li>Откройте проект.</li>
  <li>Для открытия окна конструктора меню в окне проекта перейдите на вкладку Other (Остальные) и выберите группу Menus (Меню). 
  </li>
  <li>Нажмите кнопку New (Новый) окна проекта. </li>
  <li>В открывшемся диалоговом окне New Menu (Новое меню) нажмите кнопку Shortcut (Всплывающее меню). Откроется окно конструктора меню. 
  </li>
  <li>В поле Prompt (Приглашение) последовательно введите тексты пунктов меню и определите для них выполняемые действия (рис. 10.16). 
  </li>
</ol>
<IMG src="gl11-16.jpg" alt="gl11-16.jpg" ></IMG>
<P>
Рис. 11.16. Создание меню типа Shortcut 
</P>
<ol>
  <li value="6">Для генерации выберите команду Generate (Генерация) в меню Menu (Меню). 
  </li>
  <li>Запустите меню на выполнение. Вид данного меню при запуске представлен на рис. 11.17. 
  </li>
</ol>
<IMG src="gl11-17.jpg" alt="gl11-17.jpg" ></IMG>
<P>
Рис. 11.17. Меню типа Shortcut 
</P>
</BODY>
</HTML>