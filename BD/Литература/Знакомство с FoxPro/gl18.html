<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 18
<br>
Расширенные средства выборки данных </b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl18.html#1">Вывод результатов запроса</a>
  <li><a href="gl18.html#2">Просмотр результатов запроса в режиме Browse</a>
  <li><a href="gl18.html#3">Сохранение результатов запроса в курсоре</a>
  <li><a href="gl18.html#4">Сохранение результатов запроса в таблице</a>
  <li><a href="gl18.html#5">Использование результатов запроса для создания диаграммы</a>
  <li><a href="gl18.html#6">Представление результатов запроса на экране </a>
  <li><a href="gl18.html#7">Использование результатов запроса в отчете</a>
  <li><a href="gl18.html#8">Создание этикеток с использованием результатов запроса </a>
  <li><a href="gl18.html#9">Сохранение результатов запроса в формате HTML</a>
  <li><a href="gl18.html#10">Применение в программах команды Select</a>
  <li><a href="gl18.html#11">Использование переменных при формировании запросов</a>
  <li><a href="gl18.html#12">Подзапросы</a>
  <li><a href="gl18.html#13">Фраза HAVING</a>
  <li><a href="gl18.html#14">Оператор EXISTS</a>
  <li><a href="gl18.html#15">Оператор UNION</a>
</ul>

</P>
<P>
В главе 9 нами были рассмотрены основные вопросы создания запросов. Результаты запроса отображались в табличном виде на экране. В этой главе рассмотрим, как использовать результаты выполнения запроса для построения диаграмм, создания отчетов, этикеток, а также в программах. 
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Вывод результатов запроса </font> 
</P>
<P>
По умолчанию Visual FoxPro направляет результат выборки в стандартную результирующую таблицу, которая отображается на экране в режиме Browse (Обзор). Однако вы можете направить результат выборки во вновь создаваемую таблицу, в отчет или в программу Microsoft Graph. 
</P>
<P>
Для изменения направления вывода используется диалоговое окно Query Destination (Результат запроса) (рис. 18.1). Чтобы его открыть, выполните одно из следующих действий. 
</P>
<ul>
  <li>Нажмите кнопку Query Destination (Результат запроса) на панели инструментов Query Designer (Конструктор запроса). 
  </li>
  <li>В меню Query (Запрос) выберите команду Query Destination (Результаты запроса). 
  </li>
</ul>
<P>
Диалоговое окно Query Destination (Результаты запроса) содержит кнопки,
описанные в табл. 18.1. 
</P>
<P>
Таблица 18.1. Назначение кнопок диалогового окна Query Destination 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Browse (Обзор) 
</TD>
<TD VALIGN="TOP">
Сохраняет результат выборки в стандартной результирующей таблице и отображает результаты запроса в режиме Browse (Обзор) на экране 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Cursor (Курсор) 
</TD>
<TD VALIGN="TOP">
Обеспечивает временное хранение результатов запроса в виде, доступном только для чтения 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Graph (Диаграмма) 
</TD>
<TD VALIGN="TOP">
Запускает Microsoft Graph  (приложение  OLE) для создания графиков и диаграмм 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Screen (Экран) 
</TD>
<TD VALIGN="TOP">
Отображает результаты выборки в активном окне 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Table (Таблица) 
</TD>
<TD VALIGN="TOP">
Сохраняет результаты запроса в таблице 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Report (Отчет) 
</TD>
<TD VALIGN="TOP">
Отображает результат выборки в виде отчета 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Label (Этикетка) 
</TD>
<TD VALIGN="TOP">
Отображает результат выборки в виде этикетки 
</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl18-1.jpg" alt="gl18-1.jpg" width="424" height="241" ></IMG> </p>
<P>
Рис. 18.1. Диалоговое окно Query Destination 
</P>
<P>
При нажатии любой из кнопок открывается диалоговое окно, в котором определяются дополнительные параметры вывода данных запроса. 
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">Просмотр результатов запроса в режиме Browse </font> 
</P>
<P>
По умолчанию Visual FoxPro помещает результаты запроса во временную таблицу и выводит ее на экран в режиме Browse (Обзор). После закрытия окна временная таблица удаляется из памяти. Этот режим удобен в том случае, если вы хотите просто просмотреть результаты запроса. 
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Сохранение результатов запроса в курсоре </font> 
</P>
<P>
В том случае, если вы хотите ссылаться на результаты запроса из программы, вам необходимо сохранить их в курсоре. Курсор является временной таблицей, доступной только для чтения и удаляемой из памяти при закрытии курсора. 
</P>
<P>
Для направления результатов запроса в курсор в диалоговом окне Query Destination (Результаты запроса) установите опцию Cursor (Курсор), в поле Cursor name (Имя курсора) введите имя курсора и нажмите кнопку ОК. Введенное имя будет служить псевдонимом для ссылки на результаты запроса. 
</P>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для повышения быстродействия и избежания проблем, связанных с именами файлов при 
работе в сети, небольшие курсоры желательно держать в памяти или на локальном 
диске. При увеличении размера курсоров и отсутствии достаточного количества места Visual FoxPro записывает их на физический носитель.
</font> 
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Сохранение результатов запроса в таблице </font> 
</P>
<P>
Для сохранения результатов запроса в таблице предназначена кнопка Table (Таблица) диалогового окна Query Destination (Результаты запроса). При ее нажатии становится доступным поле Table name (Имя таблицы), используемое для ввода имени таблицы, в которой будут сохранены результаты. Для указания папки, в которой требуется сохранить таблицу, воспользуйтесь расположенной справа от поля кнопкой, открывающей диалоговое окно Open (Открыть). 
</P>
<P>
Таблицу с результатами запроса можно в любой момент открыть, просмотреть, ввести в нее изменения. 
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Использование результатов запроса для создания диаграммы </font> 
</P>
<P>
При выборе в диалоговом окне Query Destination (Результаты запроса) кнопки Graph (Диаграмма) строится диаграмма по результатам запроса. Рассмотрим использование данной опции для запроса из таблиц orcisaiem и ordsaied, созданного в главе 9 и содержащего итоговую сумму по заказам. 
</P>
<ol>
  <li>Откройте созданный ранее запрос. </li>
  <li>В меню Query (Запрос) выберите команду Query Destination (Результаты запроса). 
  </li>
  <li>В диалоговом окне Query Destination (Результаты запроса) выберите опцию Graph (Диаграмма) и нажмите кнопку ОК. Диалоговое окно закроется. 
  </li>
  <li>Запустите на выполнение запрос, нажав кнопку Run (Запустить) на основной панели инструментов. 
  </li>
  <li>Запускается мастер построения диаграмм. В открывшемся диалоговом окне Graph Wizard (Мастер диаграммы) (рис. 18.2) укажите заказ в качестве поля, значения которого будут использоваться в категориях диаграммы. Для заполнения рядов данных выберите поле стоимость. 
  </li>
</ol>
<blockquote>
<P>
Для переноса данных используйте мышь. Завершив установку, нажмите кнопку Next (Далее) для перехода к следующему шагу. 
</P>
</blockquote>
<IMG src="gl18-2.jpg" alt="gl18-2.jpg" width="492" height="360" ></IMG>
<P>
Рис. 18.2. Выбор расположения полей на диаграмме 
</P>
<ol>
  <li value="6">На следующем шаге укажите стиль создаваемой диаграммы, нажав на одну из двенадцати кнопок, предлагаемых Visual FoxPro (рис. 18.3). Затем нажмите кнопку Next (Далее) для перехода к следующему шагу. 
  </li>
</ol>
<IMG src="gl18-3.jpg" alt="gl18-3.jpg" width="492" height="360" ></IMG>
<P>
Рис. 18.3. Выбор стиля диаграммы 
</P>
<ol>
  <li value="7">На последнем шаге работы мастера задайте заголовок, который будет располагаться над диаграммой (рис. 18.4). В этом диалоговом окне можно нажать кнопку Preview (Просмотр) и просмотреть созданную диаграмму. 
  </li>
</ol>
<IMG src="gl18-4.jpg" alt="gl18-4.jpg" width="492" height="360" ></IMG>
<P>
Рис. 18.4. Задание заголовка для диаграммы 
</P>
<ol>
  <li value="8">Нажмите кнопку Finish (Готово). В открывшемся диалоговом окне введите имя таблицы, в которой собираетесь сохранить данные для построения диаграммы. На экране открывается созданная диаграмма (рис. 18.5). 
  </li>
</ol>
<IMG src="gl18-5.jpg" alt="gl18-5.jpg" width="482" height="473" ></IMG>
<P>
Рис. 18.5. Созданная диаграмма 
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Представление результатов запроса на экране </font> 
</P>
<P>
На рис. 18.6 показано диалоговое окно Query Destination (Результаты запроса), в котором выбрана опция Screen (Экран). 
</P>
<IMG src="gl18-6.jpg" alt="gl18-6.jpg" width="421" height="331" ></IMG>
<P>
Рис. 18.6. Диалоговое окно Query Destination
с выбранной опцией Screen 
</P>
<P>
Область Secondary output (Вторичный вывод) содержит переключатели, указывающие, куда дополнительно направляются результаты запроса. 
</P>
<ul>
  <li>None (Нет) — вывода результатов запроса не происходит. </li>
  <li>То printer (На принтер) — результаты запроса выводятся на принтер. </li>
  <li>То text file (В текстовый файл) — вывод результатов осуществляется в текстовый файл. 
  </li>
</ul>
<P>
В области Options (Параметры) диалогового окна расположены два флажка. При установке флажка Suppress column headings 
(He отображать заголовка столбцов) в отображаемом запросе не указываются 
заголовки столбцов. Установленный флажок Pause between screens (Пауза между 
экранами) указывает на необходимость делать паузу при заполнении экрана. 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Если при выдаче информации на экран делаются паузы, то при повторном выводе заголовки столбцов будут повторяться каждый раз при заполнении нового экрана.
</font> 
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Использование результатов запроса в отчете </font> 
</P>
<P>
Для использования результатов запроса в отчете в диалоговом окне Query Destination (Результаты запроса) выберите опцию Report (Отчет). 
</P>
<IMG src="gl18-7.jpg" alt="gl18-7.jpg" width="421" height="386" ></IMG>
<P>
Рис. 18.7. Диалоговое окно Query Destination
с выбранной опцией Report 
</P>
<P>
Окно примет вид, представленный на рис. 18.7. Оно содержит две кнопки следующего назначения: 
</P>
<ul>
  <li>Open Report (Открыть отчет) — открывает диалоговое окно, позволяющее выбрать отчет, в который необходимо включить результаты запроса; 
  </li>
  <li>Builder Lock (Закрепитель построителя) — запускает мастер отчетов, с помощью которого вы сможете достаточно быстро создать новый отчет. 
  </li>
</ul>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Поле, расположенное справа от кнопки Open Report (Открыть отчет), предназначено для ввода имени нового отчета.
</font> 
</P>
<P>
Кроме того, в диалоговом окне Query Destination (Результаты запроса) расположены три флажка. При установке флажка Page preview (Просмотр страницы) отчет выводится в окно просмотра. Флажок Console on (Включить консоль) дублирует вывод отчета в текущем окне, а флажок Eject page before
report (Пропускать страницу перед отчетом) указывает на необходимость печати отчета с начала страницы. 
</P>
<P>
При установке флажка Page preview (Просмотр страницы) вывод отчета на принтер или в текстовый файл запрещен. Для печати отчета или записи его в файл необходимо снова запустить запрос на выполнение. 
</P>
<P>
Переключатели области Secondary output (Вторичный вывод) указывают, куда направлять дополнительный вывод результатов запроса: 
</P>
<ul>
  <li>None — не осуществлят; </li>
  <li>То printer — на принтер; </li>
  <li>То text file — в текстовый файл. </li>
</ul>
<P>
При установке флажка Suppress column headings (He отображать заголовки столбцов) области Options (Параметры) при формировании отчета не указываются заголовки столбцов. Флажок Summary information only (Только итоговая информация) предоставляет возможность не выводить промежуточные строки, а печатать только заголовки, группы, страницы и итоговую часть отчета. 
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Создание этикеток с использованием результатов запроса </font> 
</P>
<P>
Опция Label (Этикетки) диалогового окна Query Destination (Результаты запроса) позволяет использовать результаты запроса для создания этикеток. При установке этой опции окно имеет вид, представленный на рис. 18.8. Параметры окна аналогичны опциям вывода запроса в отчет. 
</P>
<IMG src="gl18-8.jpg" alt="gl18-8.jpg" width="421" height="331" ></IMG>
<P>
Рис. 18.8. Диалоговое окно Query Destination с выбранной опцией Label 
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">Сохранение результатов запроса в формате HTML </font> 
</P>
<P>
Visual FoxPro позволяет сохранять результат выполнения запроса, как и любую другую таблицу, в формате HTML. Для этого предназначена команда Save As HTML (Сохранить как HTML файл) из меню File (Файл), открывающая 
соответствующее диалоговое окно (рис. 18.9), содержащее три переключателя, приведенных в табл. 18.2. 
</P>
<IMG src="gl18-9.jpg" alt="gl18-9.jpg" width="364" height="145" ></IMG>
<P>
Рис. 18.9. Диалоговое окно Save As HTML 
</P>
<IMG src="gl18-10.jpg" alt="gl18-10.jpg" width="500" height="301" ></IMG>
<P>
Рис. 18.10. Окно редактирования запроса в формате HTML 
</P>
<P>
Таблица 18.2. Переключатели диалогового окна Save As HTML 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Переключатели 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save file for later use (Сохранить файл) 
</TD>
<TD VALIGN="TOP">
Сохраняет   результат   запроса   на   диске   в формате файла HTML 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save and edit file (Сохранить файл и открыть для редактирования) 
</TD>
<TD VALIGN="TOP">
Сохраняет   результат  запроса   на   диске   в формате файла HTML и открывает его для редактирования (рис. 18.10} 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save file and view in web browser 
</P>
<P>
(Сохранить файл и открыть для просмотра в Web-браузере) 
</TD>
<TD VALIGN="TOP">
Сохраняет   результат   запроса   на   диске   в формате файла HTML и открывает его для просмотра в окне Web-браузера (рис. 18. 11} 
</TD>
</TR>
</TABLE>
<P>
Поле, расположенное в нижней части диалогового окна Save As HTML (Сохранить как HTML файл), позволяет указать расположение сохраняемого файла. Если хотите изменить указанный по умолчанию адрес, воспользуйтесь кнопкой открытия диалогового окна Save As (Сохранить как), расположенной справа от поля, укажите имя создаваемого файла с расширением НТМ, а также папку, в которой файл будет сохранен. 
</P>
<IMG src="gl18-11.jpg" alt="gl18-11.jpg" width="500" height="474" ></IMG>
<P>
Рис. 18.11. Просмотр HTML-файла в окне Web-браузера 
</P>
<p>&nbsp;
<a NAME="10"></a><font size="4">Применение в программах команды Select </font> 
</P>
<P>
При создании приложений для выборки данных широко применяется команда SELECT. В отличие от интерактивного режима, при программировании вы можете использовать переменные и пользовательские функции. Кроме того, в программах вы можете использовать более сложные выборки, включая вложенные запросы, кванторы существования и объединение запросов. 
</P>
<p>&nbsp;
<a NAME="11"></a><font size="4">Использование переменных при формировании запросов </font> 
</P>
<P>
При формировании выборки в программах вы можете использовать переменные для 
определения условий выборки и задания имени таблицы, в которую записываются результаты выборки. 
</P>
<P>
Рассмотрим пример создания запроса, в котором определяется итоговая сумма по 
каждому заказу. За основу возьмем аналогичный запрос, созданный ранее в интерактивном режиме. В него добавим возможность задания интервала, за который будет осуществляться выборка, а также имени результирующей таблицы. 
</P>
<ol>
  <li>Откройте новое окно редактирования программы. Для этого в меню File (Файл) выберите команду New (Новый). 
  </li>
  <li>В открывшемся диалоговом окне выберите опцию Program (Программа) и нажмите кнопку New file (Новый файл). 
  </li>
  <li>Откройте окно созданного ранее запроса, содержащего выборку из таблиц Ordsalem 
  <span lang="ru">и</span> Ordsaled <span lang="ru">с итоговой суммой по каждому 
  заказу.</span></li>
  <li>Нажмите кнопку Show the SQL Window (Показать SQL) на панели инструментов Query Designer (Конструктор запроса) или в меню Query (Запрос) выберите команду View SQL (Показать SQL). 
  </li>
  <li>В окне просмотра выделите команду SELECT и сохраните ее во временном буфере Windows. 
  </li>
  <li>Скопируйте содержимое буфера Windows в окно редактирования программы. 
  </li>
  <li>Укажите перед командой SELECT начальную и конечную даты, определяющие промежуток времени, а также значение переменной, которая задает имя результирующей таблицы: 
  </li>
</ol>
<blockquote>
<P>
 dBeg=CTOD(&quot;01.11.01&quot;) &amp;&amp; начальная дата 
</P>
<P>
 dEnd=CTOD(&quot;30.11.01&quot;) &amp;&amp; конечная дата 
</P>
<P>
 c0utput=&quot;0rds&quot; &amp;&amp; имя результирующей таблицы 
</P>
</blockquote>
<ol>
  <li value="8">Добавьте в конструкцию SELECT условие задания периода времени, используя переменные dBeg и dEnd: 
  </li>
</ol>
<blockquote>
<P>
 SELECT Ordsalem.cnDoc AS заказ,; 
</P>
<P>
 SUM(Ordsaled.nQuant*Ordsaled.nUnitPrice) AS стоимость; 
</P>
<P>
 FROM sales!ordsalem INNER JOIN saleslordsaled ; 
</P>
<P>
 ON Ordsalem.icdorder = Ordsaled.icdorder;  
</P>
<P>
 WHERE Ordsalem.dDoc BETWEEN dBeg AND dEnd; 
</P>
<P>
 GROUP BY Ordsalem.icdorder;  
</P>
<P>
 INTO TABLE ScOutput 
</P>
</blockquote>
<ol>
  <li value="9">Сохраните программу под именем Ords.prg и проверьте синтаксис. 
  </li>
  <li>Выполните программу, в результате чего в таблицу ords будет записана итоговая сумма по заказам (рис 18.12). В дальнейшем вы можете использовать эту таблицу для просмотра, печати отчета или построения графика. 
  </li>
</ol>
<IMG src="gl18-12.jpg" alt="gl18-12.jpg" width="500" height="420" ></IMG>
<P>
Рис 18.12. Программа и полученная в результате ее выполнения таблица Ords 
</P>
<p>&nbsp;
<a NAME="12"></a><font size="4">Подзапросы </font> 
</P>
<P>
При определении условия выборки можно применять вложенные запросы, которые называются подзапросами. Например, определим список наиболее дорогих товаров, цены которых ниже максимальной цены не более, чем на 10%. 
</P>
<blockquote>
<P>
 SELECT icdGoods FROM Goods    ;  
</P>
<P>
 WHERE nUnitPrice &gt;;  
</P>
<P>
 (SELECT 0.9 * MAX (nUnitPrice) ;  
</P>
<P>
 FROM Goods) 
</P>
</blockquote>
<p>&nbsp;
<a NAME="13"></a><font size="4">Фраза HAVING </font> 
</P>
<P>
Для применения условий к группам, созданным фразой GROUP BY, используется фраза HAVING, которая играет такую же роль для групп, что и фраза WHERE для записей. 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Разница между фразами WHERE и HAVING состоит в том, что WHERE применяется к строкам, в то время как HAVING применяется к группам.
</font> 
</P>
<P>
Запрос может содержать и фразу WHERE, и фразу HAVING. В этом случае первой выполняется фраза WHERE, поскольку она выполняется до разбиения на группы. 
</P>
<P>
Рассмотрим пример выборки городов, в которых имеется более десяти покупателей: 
</P>
<blockquote>
<P>
 SELECT cCountry  ;  
</P>
<P>
 FROM Customer ;  
</P>
<P>
 GROUP BY cCountry;  
</P>
<P>
 HAVING COUNT(*)&gt;10 
</P>
</blockquote>
<P>
<font color="#000080"><b><span lang="ru">Предупреждение</span></b></font></P>
<P>
<font color="#000080">Вы не можете использовать фразу HAVING отдельно от фразы GROUP BY.
</font> 
</P>
<p>&nbsp;
<a NAME="14"></a><font size="4">Оператор EXISTS </font> 
</P>
<P>
Оператор EXISTS принимает значение True (Истина), если результат выполнения подзапроса является непустым множеством. Если порожденное подзапросом множество пусто, то EXISTS принимает значение False (Ложь). Оператор NOT EXISTS 
работает в точности наоборот. Он истинен, если результат подзапроса пуст, и ложен в противном случае. 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Операторы EXISTS и NOT EXISTS всегда помещаются перед подзапросом.
</font> 
</P>
<P>
В качестве примера выберем наименования товаров, которые заказали покупатели из Новгорода: 
</P>
<blockquote>
<P>
 SELECT cNmGoods ;</P>
<P>
 FROM Goods ;</P>
<P>
 WHERE EXISTS ;</P>
<P>
 (SELECT * ;</P>
<P>
 FROM Customer, Ordsalem, Ordsaled ;  
</P>
<P>
 WHERE Ordsalem.icdOrder=Ordsaled.icdOrder ; 
</P>
<P>
 AND Ordsalem.iCdCustomer = Customer.iCdCustomer ;  
</P>
<P>
 AND Ordsaled.iCdGoods = Goods.iCdGoods ;  
</P>
<P>
 AND Customer.cCity = 'Новгород') 
</P>
</blockquote>
<p>&nbsp;
<a NAME="15"></a><font size="4">Оператор UNION </font> 
</P>
<P>
Для объединения результатов запросов используется оператор UNION. Результатом объединения является результирующее множество, состоящее из всех строк, входящих в какое-либо одно или в оба результирующих множества объединяемых запросов. 
</P>
<P>
В качестве примера выберем список покупателей, которые живут в Новгороде или покупают товар с кодом 2103: 
</P>
<blockquote>
<P>
 SELECT icdCustomer ;</P>
<P>
 FROM Customer ;  
</P>
<P>
 WHERE cCity = 'Новгород<SUP>'</SUP> ;  
</P>
<P>
 UNION ; 
</P>
<P>
 SELECT icdCustomer;  
</P>
<P>
 FROM Ordsalem, Ordsaled ; 
</P>
<P>
 WHERE Ordsalem.icdOrder=Ordsaled.icdOrder ; 
</P>
<P>
 AND icdGoods = 2103 
</P>
</blockquote>
<P>
Из результата выборки, использующей оператор UNION, исключаются повторяющиеся строки. Для отображения их в результирующей выборке используйте 
<span lang="ru">опцию</span> ALL. 
</P>
<P>
<font color="#000080"><b><span lang="ru">Предупреждение</span></b></font></P>
<P>
<font color="#000080">Фраза ORDER BY в запросе с использованием оператора UNION может входить только в последний оператор SELECT.
</font> 
</P>
</BODY>
</HTML>