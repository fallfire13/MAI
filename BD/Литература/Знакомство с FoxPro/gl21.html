<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 21
<br>
Связывание и внедрение объектов, экспорт и импорт данных </b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl21.html#1">Visual FoxPro и OLE-объекты</a>
  <li><a href="gl21.html#2">Внедрение нового OLE-объекта</a>
  <li><a href="gl21.html#3">Внедрение OLE-объекта из файла </a>
  <li><a href="gl21.html#4">Связывание OLE-объекта</a>
  <li><a href="gl21.html#5">Команда Insert Object</a>
  <li><a href="gl21.html#6">Команда Paste Special</a>
  <li><a href="gl21.html#7">Редактирование OLE-объекта</a>
  <li><a href="gl21.html#8">Удаление OLE-объекта</a>
  <li><a href="gl21.html#9">Использование объектно-ориентированного программирования</a>
  <li><a href="gl21.html#10">Передача данных в Microsoft Excel с помощью OLE</a>
  <li><a href="gl21.html#11">Передача данных из Visual FoxPro в другие приложения </a>
  <li><a href="gl21.html#12">Импорт данных</a>
  <li><a href="gl21.html#13">Использование данных из Visual FoxPro в Microsoft Word</a>
</ul>

<P>
В Visual FoxPro имеется возможность хранить в таблицах сами объекты или связь с 
объектами, которые созданы в приложении, поддерживающем механизм связывания и внедрения (OLE). 
Основное отличие между связыванием и внедрением состоит в том, каким образом 
данные запоминаются и обновляются после того, как их поместили в базу данных. 
</P>
<P>
При связывании данные обновляются, когда изменяется исходный файл. Связанные данные запоминаются в исходном файле; в базе данных сохраняются только сведения о месте расположения исходного файла. Внедренные объекты сохраняются в базе данных. Если установить на внедренный объект указатель и дважды щелкнуть мышью, откроется приложение, в котором объект был создан. В нем можно редактировать внедренный объект, при этом измененные данные записываются в базу данных. 
</P>
<P>
Объект, который внедряется или связывается, называется OLE-объектом. Исходное 
приложение, в котором был создан OLE-объект, называется приложением-сервером, а приложение, в которое внедряется или с которым связывается OLE-объект, — приложением-клиентом. 
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Visual FoxPro и OLE-объекты </font> 
</P>
<P>
В Visual FoxPro OLE-объекты могут храниться и отображаться только в полях типа General (Общий). Для внедрения OLE-объекта в таблицу Visual FoxPro выполните следующие действия: 
</P>
<ol>
  <li>Создайте в таблице, предназначенной для хранения OLE-объекта, поле типа General. 
  </li>
  <li>Откройте таблицу в режиме Browse (Обзор) (рис. 21.1), выполнив команду Browse (Обзор) из меню View (Вид) или нажав кнопку Browse (Обзор) окна проекта. Откроется окно просмотра таблицы. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Если поле типа General (Общий) пусто, то при просмотре таблицы в нем появляется пометка gen. Если поле содержит OLE-объект, то пометка принимает вид Gen.
</font> 
</P>
<IMG src="gl21-1.jpg" alt="gl21-1.jpg" width="500" height="196" ></IMG>
<P>
Рис. 21.1. Просмотр в режиме Browse таблицы, содержащей поля типа General 
</P>
<ol>
  <li value="3">Для вставки OLE-объекта дважды щелкните на поле типа General (Общий), содержащем значение gen. Откроется окно редактирования этого поля (рис. 21.2). 
  </li>
  <li>В меню Edit (Правка) выберите команду Insert Object (Вставить объект). Откроется диалоговое окно Вставка объекта (рис. 21.3). 
  </li>
  <li>Это диалоговое окно содержит два переключателя, предоставляющих два варианта включения OLE-объекта: 
  </li>
</ol>
<ul>
  <li>Создать новый — позволяет создать новый OLE-объект и вставить его в поле; 
  </li>
  <li>Создать из файла — позволяет разместить в поле таблицы OLE-объект из файла. 
  </li>
</ul>
<blockquote>
<P>
При выборе переключателя Создать новый выберите из предложенного списка Тип объекта сервер, который хотите использовать для создания объекта, и нажмите кнопку ОК. Откроется приложение, в котором создайте объект, после чего вернитесь в Visual FoxPro. 
</P>
<P>
Для использования существующего объекта выберите переключатель Создать из файла. 
Диалоговое окно примет другой вид. Воспользовавшись кнопкой Обзор, найдите 
необходимый файл и вставьте его содержимое в поле таблицы. 
</P>
</blockquote>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">В Visual FoxPro для хранения сложных текстов можно использовать поле типа General (Общий), внедрив в него или связав с ним документ текстового процессора.
</font> 
</P>
<IMG src="gl21-2.jpg" alt="gl21-2.jpg" width="500" height="220" ></IMG>
<P>
Рис. 21.2. Окно редактирования поля типа General 
</P>
<IMG src="gl21-3.jpg" alt="gl21-3.jpg" width="500" height="267" ></IMG>
<P>
Рис. 21.3. Диалоговое окно Вставка объекта 
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">Внедрение нового OLE-объекта </font> 
</P>
<P>
Рассмотрим процедуру внедрения  нового OLE-объекта на примере поля
gimage таблицы Goods. 
</P>
<ol>
  <li>В окне проекта установите курсор на таблицу Goods базы данных sales. Данная таблица содержит поле gimage типа General (Общий), в котором вы предполагаете разместить изображение товара. 
  </li>
  <li>Чтобы открыть окно просмотра, выполните команду Browse (Обзор) из меню View (Вид) или нажмите кнопку Browse (Обзор) 
  окна проекта. </li>
  <li>Для вставки OLE-объекта установите курсор на поле типа General (Общий) и дважды щелкните на нем. Откроется окно редактирования поля. 
  </li>
  <li>Выполните команду Insert Object (Вставить объект) из меню Edit (Правка). 
  </li>
  <li>В открывшемся диалоговом окне Вставка объекта в списке Тип объекта перечислены все OLE-серверы, установленные в вашей системе. В качестве примера выберите Рисунок Paintbrush. 
  </li>
  <li>Нажмите кнопку ОК. Visual FoxPro откроет указанное вами приложение и разместит его меню и панели инструментов в своем главном окне. 
  </li>
  <li>Создайте изображение товара, которое будет использовано в качестве нового OLE-объекта (рис. 21.4). 
  </li>
</ol>
<IMG src="gl21-4.jpg" alt="gl21-4.jpg" width="500" height="316" ></IMG>
<P>
Рис. 21.4. Создание изображения товара 
</P>
<ol>
  <li value="8">Закройте сервер OLE. Для этого щелкните в любом месте окна вне 
  области редактирования, после чего созданный вами объект будет размещен в поле типа General (Общий) (рис. 21.5). 
  </li>
</ol>
<IMG src="gl21-5.jpg" alt="gl21-5.jpg" width="500" height="316" ></IMG>
<P>
Рис. 21.5. Размещение в поле таблицы нового OLE-объекта 
</P>
<P>
Если вам потребуется внести изменения во встроенный OLE-объект, откройте таблицу в режиме Browse (Обзор) и дважды щелкните на требуемом значении. В результате откроется окно редактирования поля типа General (Общий). Для редактирования изображения используется команда Точечный рисунок Object (Объект) из меню Edit (Правка). 
</P>
<P>
Данная команда имеет собственное меню, которое содержит опции Изменить и Открыть, определяющие режим редактирования изображения (см. рис. 21.5). При выборе опции Изменить меню и панели инструментов OLEсервера внедряются непосредственно в Visual FoxPro (см. рис. 21.4). При выборе опции Открыть открывается приложение OLE-сервера (рис. 21.6), в котором вы можете редактировать изображение поля типа General (Общий). 
</P>
<IMG src="gl21-6.jpg" alt="gl21-6.jpg" width="367" height="400" ></IMG>
<P>
Рис. 21.6. Открытое приложение OLE-сервера для редактирования изображения 
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Внедрение OLE-объекта из файла </font> 
</P>
<P>
Для внедрения в поле таблицы OLE-объекта из файла выполните следующие действия. 
</P>
<ol>
  <li>Откройте таблицу в режиме Browse (Обзор). </li>
  <li>Установите курсор на поле типа General (Общий) и дважды щелкните кнопкой мыши. Откроется окно редактирования поля. 
  </li>
  <li>В меню Edit (Правка) выберите команду Insert Object (Вставить объект). 
  </li>
  <li>В открывшемся диалоговом окне Вставка объекта выберите переключатель Создать из файла. Окно примет вид, представленный на рис. 21.7. 
  </li>
</ol>
<IMG src="gl21-7.jpg" alt="gl21-7.jpg" width="500" height="267" ></IMG>
<P>
Рис. 21.7. Диалоговое окно Вставка объекта
при выбранном переключателе Создать из файла 
</P>
<ol>
  <li value="5">Нажмите кнопку Обзор. </li>
  <li>В открывшемся диалоговом окне Обзор (рис. 21.8) выберите файл, содержащий необходимый объект. Для установки требуемого типа объекта необходимо использовать список Тип файлов, расположенный в нижней части диалогового окна. Выбрав файл, нажмите кнопку Открыть. 
  </li>
  <li>Возвратившись в диалоговое окно Вставка объекта, нажмите кнопку ОК. OLE-объект будет размещен в поле типа General (Общий). 
  </li>
</ol>
<IMG src="gl21-8.jpg" alt="gl21-8.jpg" width="428" height="294" ></IMG>
<P>
Рис. 21.8. Диалоговое окно Обзор 
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Связывание OLE-объекта </font> 
</P>
<P>
Чтобы связать OLE-объект с основной копией объекта на сервере, можно воспользоваться командой Insert Object (Вставка объекта) или Paste Special (Специальная вставка) из меню Edit (Правка). Рассмотрим оба варианта. 
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Команда Insert Object </font> 
</P>
<P>
Для размещения в поле таблицы Visual FoxPro OLE-объекта со связью с помощью команды Insert Object (Вставить объект) выполните следующие действия: 
</P>
<ol>
  <li>Откройте таблицу Goods в режиме Browse (Обзор). </li>
  <li>Перейдите в поле типа General (Общий) и дважды щелкните на нем для его открытия. 
  </li>
  <li>Выберите в меню Edit (Правка) команду Insert Object (Вставить объект). 
  </li>
  <li>В диалоговом окне Вставка объекта выберите переключатель Создать из файла. 
  </li>
  <li>Нажмите кнопку Обзор. </li>
  <li>В открывшемся диалоговом окне Обзор выберите необходимый файл и нажмите кнопку Открыть. 
  </li>
  <li>В диалоговом окне Вставка объекта установите флажок Связь (рис. 21.9) и нажмите кнопку ОК. 
  </li>
</ol>
<IMG src="gl21-9.jpg" alt="gl21-9.jpg" width="500" height="267" ></IMG>
<P>
Рис. 21.9. Установлен флажок Связь 
</P>
<IMG src="gl21-10.jpg" alt="gl21-10.jpg" width="500" height="244" ></IMG>
<P>
Рис. 21.10. Связывание OLE-объекта 
</P>
<ol>
  <li value="8">В результате этих действий в окне просмотра поля типа General (Общий) появится значок файла (рис. 21.10). 
  </li>
  <li>Чтобы изменить размещенный OLE-объект с использованием OLEсервера, откройте окно просмотра OLE-объекта и дважды щелкните кнопкой мыши на значке. 
  </li>
</ol>
<p>&nbsp;
<a NAME="6"></a><font size="4">Команда Paste Special </font> 
</P>
<P>
Для размещения в поле типа General (Общий) OLE-объекта со связью с помощью команды Paste Special (Специальная вставка) выполните следующие действия: 
</P>
<ol>
  <li>Откройте приложение-сервер и запомните связываемый объект во временном буфере Windows. 
  </li>
  <li>Откройте окно редактирования поля типа General (Общий). </li>
  <li>В меню Edit (Правка) выберите команду Paste Special (Специальная вставка). На экране открывается диалоговое окно Специальная вставка (рис. 21.11). Объект, находящийся во временном буфере Windows, описан в диалоговом окне как Источник. В списке Как перечислены допустимые форматы для этого объекта. 
  </li>
</ol>
<IMG src="gl21-11.jpg" alt="gl21-11.jpg" width="473" height="254" ></IMG>
<P>
Рис. 21.11. Диалоговое окно Специальная вставка 
</P>
<ol>
  <li value="4">Чтобы связать объект с его оригиналом на сервере, выберите переключатель Вставить связь. 
  </li>
  <li>Выберите из списка Как формат объекта. Ссылка на объект запоминается в поле типа General (Общий). При каждом изменении оригинала объекта на сервере объект, выводимый в приложении Visual FoxPro, будет автоматически обновляться. Если в момент изменения оригинала приложение Visual FoxPro не открыто, обновление произойдет при первом же открытии приложения Visual FoxPro. 
  </li>
  <li>Нажмите кнопку ОК для закрытия диалогового окна Специальная вставка. </li>
</ol>
<blockquote>
<P>
Ссылка на OLE-объект, запоминаемая в поле типа General (Общий), содержит имя 
файла (включая путь к нему) оригинала объекта на сервере. Если вы измените имя 
этого файла, перенесете или удалите его, связь разрывается. Для восстановления связи необходимо воспользоваться командой Links (Связи) из меню Edit. 
</P>
</blockquote>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для изменения объекта в поле типа General (Общий) со 
связанного на внедренный необходимо удалить объект из поля с помощью команды Cut 
(Вырезать) из меню Edit (Правка), а после этого вставить объект обратно в поле, но без связывания.
</font> 
</P>
<P>
Если OLE-объект был размещен со связью, диалоговое окно Связи позволяет изменить или удалить установленную связь (рис. 21.12). Для его просмотра откройте требуемую таблицу, перейдите в поле со связанным объектом и в меню Edit (Правка) выберите команду Links (Связи). 
</P>
<IMG src="gl21-12.jpg" alt="gl21-12.jpg" width="500" height="277" ></IMG>
<P>
Рис. 21.12. Диалоговое окно Связи 
</P>
<P>
В списке Связи представлены все связи объекта в табличном виде с указанием пути 
и имени файла источника, а также типа объекта и режима обновления связи. 
</P>
<P>
В диалоговом окне размещены кнопки, имеющие назначение, описанное в табл. 21.1. 
</P>
<P>
Таблица 21.1. Назначение кнопок диалогового окна Связи 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Обновить сейчас 
</TD>
<TD VALIGN="TOP">
Обновляет выделенную связь 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Открыть источник 
</TD>
<TD VALIGN="TOP">
Открывает исходный файл для выделенной связи 
</TD>
</TR>

<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Сменить источник 
</TD>
<TD VALIGN="TOP">
Заменяет исходный файл для выделенной связи с помощью диалогового окна Смена источника 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Разорвать связь 
</TD>
<TD VALIGN="TOP">
Разрывает указанную связь. В результате объект становится статическим, не 
допускающим изменения или обновления 
</TD>
</TR>
</TABLE>
<P>
Переключатель Обновление определяет режим обновления связи и содержит два переключателя: Автоматическое, Вручную. При установленной опции Автоматическое обновление связанных объектов осуществляется автоматически. Если установлена опция Вручную, тогда для обновления объектов необходимо нажать кнопку Обновить сейчас. 
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Редактирование OLE-объекта </font> 
</P>
<P>
Большинство OLE-объектов можно редактировать. Для этого откройте окно редактирования поля типа General (Общий), содержащее, например, такие OLE-объекты, как электронная таблица Microsoft Excel, документ Word или рисунок Paint и дважды щелкните мышью. Откроется приложение-сервер для редактирования объекта. 
</P>
<P>
Для редактирования точечных рисунков выберите команду Растровый рисунок Object (Объект) в меню Edit (Правка), а затем команду Изменить или Открыть, которые доступны в окне редактирования поля типа General (Общий). Для редактирования документа Word в меню Edit (Правка) появляется команда Документ Object, а для редактирования электронной таблицы — Лист Object (Объект). 
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Удаление OLE-объекта </font> 
</P>
<P>
Чтобы удалить OLE-объект из поля типа General (Общий), выполните команду Clear (Очистить) из меню Edit (Правка). 
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">Использование объектно-ориентированного программирования </font> 
</P>
<P>
В Visual FoxPro для управления OLE-объектами можно использовать объектно-ориентированное программирование. 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Для создания OLE-объекта в Visual FoxPro предназначена команда CREATEOBJECT.
</font> 
</P>
<p>&nbsp;
<a NAME="10"></a><font size="4">Передача данных в Microsoft Excel с помощью OLE </font> 
</P>
<P>
В рассматриваемом примере используем данные из таблицы cntcust для построения диаграммы распределения клиентов по городам в программе Microsoft Excel с помощью OLE-объектов, 
</P>
<ol>
  <li>В меню File (Файл) выберите команду New (Новый), установите опцию Program 
(Программа) и нажмите кнопку New file (Новый файл). Откроется новое окно редактирования программ. 
  </li>
  <li>Для установления связи с Microsoft Excel, передачи в него данных и построения диаграммы введите следующие команды: 
  </li>
</ol>
<blockquote>
<P>
 *  Создание OLE-объекта 
</P>
<P>
 obj ExcelSheet=CreateObject(&quot;Excel.Sheet&quot;)  
</P>
<P>
 objExcelSheet.Application.Visible=.Т.  
</P>
<P>
 objExcelSheet = objExcelSheet.Sheets[1] 
</P>
<P>
 * Передача данных из таблицы CntCust в Excel 
</P>
<P>
 SELECT CNTCUST 
</P>
<P>
 nRow=0 
</P>
<P>
 SCAN 
</P>
<P>
 nRow=nRow+l 
</P>
<P>
 objExcelSheet.Cells(nRow,1).ValueCntCust.City 
</P>
<P>
 objExcelSheet.Cells(nRow,2).Value=CntCust.Quant 
</P>
<P>
 ENDSCAN 
</P>
<P>
 objChart = objExcelSheet.ChartObjects.Add{100, 100, 400, 200) 
</P>
<P>
 * Выделение данных и создание диаграммы 
</P>
<P>
 objExcelSheet.chartObjects(1).Chart.; 
</P>
<P>
 chartwizard(objExcelSheet.Range(objExcelSheet.Cells(1,1) ,; 
</P>
<P>
 objExcelSheet.Cells(nRow,2)),; 
</P>
<P>
 -4100,4,1,0,1,1,&quot;&quot;,&quot;&quot;,&quot;&quot;,&quot;&quot;)  
</P>
<P>
 objExcelSheet.chartObjects(1).Select  
</P>
<P>
 objExcelSheet.chartObjects(1).Copy 
</P>
<P>
 * Закрытие сервера  
</P>
<P>
 objExcelSheet.application.quit 
</P>
<P>
 release objExcelSheet 
</P>
</blockquote>
<ol>
  <li value="3">Проверьте синтаксис и запустите программу на выполнение. Результат выполнения программы представлен на рис. 21.13. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Наиболее простым способом формирования команд для выполнения действий над OLE-объектами является запись соответствующего макроса на сервере приложении и использование текста этого макроса в Visual FoxPro.
</font> 
</P>
<IMG src="gl21-13.jpg" alt="gl21-13.jpg" width="500" height="358" ></IMG>
<P>
Рис. 21.13. Создание диаграммы с помощью OLE 
</P>
<p>&nbsp;
<a NAME="11"></a><font size="4">Передача данных из Visual FoxPro в другие приложения </font> 
</P>
<P>
Используя команды Export (Экспорт) и Import (Импорт) из меню File (Файл), можно осуществлять обмен данными между Visual FoxPro и текстовыми 
файлами, а также наиболее популярными базами данных и электронными таблицами. 
</P>
<P>
Для экспорта данных из таблицы Visual FoxPro выполните команду Export (Экспорт) из меню File (Файл). Открывается диалоговое окно Export (Экспорт) (рис. 21.14), в котором из списка Туре (Тип) вам необходимо выбрать тип экспортируемого формата. Допустимые типы форматов приведены в табл. 21.2. 
</P>
<IMG src="gl21-14.jpg" alt="gl21-14.jpg" width="390" height="186" ></IMG>
<P>
Рис. 21.14. Диалоговое окно Export 
</P>
<P>
Таблица 21.2. Типы экспортируемых форматов 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Тип 
</TD>
<TD VALIGN="TOP">
Кодовое обозначение 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Visual FoxPro 3.0 (DBF) 
</TD>
<TD VALIGN="TOP">
 
</TD>
<TD VALIGN="TOP">
Копирование одной таблицы в другую 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
FoxPro для Windows 2.x (DBF) 
</TD>
<TD VALIGN="TOP">
FOX2X 
</TD>
<TD VALIGN="TOP">
Экспорт в формат FoxPro для Windows 2.x 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
FoxBASE+ (DBF) 
</TD>
<TD VALIGN="TOP">
FOXPLUS 
</TD>
<TD VALIGN="TOP">
Экспорт в формат FoxBASE+ 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
dBASE IV (DBF) 
</TD>
<TD VALIGN="TOP">
 
</TD>
<TD VALIGN="TOP">
Экспорт в формат dBASE IV 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Delimited Text 
</TD>
<TD VALIGN="TOP">
 
</TD>
<TD VALIGN="TOP">
Экспорт в текстовый файл с разделителями 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Microsoft Excel 5.0 (XLS) 
</TD>
<TD VALIGN="TOP">
XLS 
</TD>
<TD VALIGN="TOP">
Экспорт   в   формат   электронной   таблицы Microsoft Excel 5.0 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Microsoft Excel 2.0, 3.0 и 4.0 (XLS) 
</TD>
<TD VALIGN="TOP">
XLS 
</TD>
<TD VALIGN="TOP">
Экспорт   в   формат   электронных   таблиц Microsoft 2.0, 3.0 и 4.0 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Lotus 1-2-3 2.x (WK1) 
</TD>
<TD VALIGN="TOP">
WK1 
</TD>
<TD VALIGN="TOP">
Экспорт   в   формат   электронной   таблицы Lotus 1-2-3 2.x 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Lotu s 1-2-31 -A (WKS) 
</TD>
<TD VALIGN="TOP">
WKS 
</TD>
<TD VALIGN="TOP">
Экспорт   в   формат   электронной   таблицы Lotus 1-2-3 1-А 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Symphony 1.10 (WR1) 
</TD>
<TD VALIGN="TOP">
WR1 
</TD>
<TD VALIGN="TOP">
Экспорт   в   формат   электронной   таблицы Symphony 1.10 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Symphony 1.01 (WRK) 
</TD>
<TD VALIGN="TOP">
WRK 
</TD>
<TD VALIGN="TOP">
Экспорт   в   формат   электронной   таблицы Symphony 1.01 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
MultiPlan 4.01 (MOD) 
</TD>
<TD VALIGN="TOP">
MOD 
</TD>
<TD VALIGN="TOP">
Экспорт   в   формат   электронной   таблицы MultiPlan 4.01 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Data Interchange Format (DIF) 
</TD>
<TD VALIGN="TOP">
DIF 
</TD>
<TD VALIGN="TOP">
Экспорт в текстовый файл,   используемый приложением VisiCalc 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
System Data Format (SDF) 
</TD>
<TD VALIGN="TOP">
SDF 
</TD>
<TD VALIGN="TOP">
Экспорт в стандартный текстовый файл 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Symbolic Link Format 
</TD>
<TD VALIGN="TOP">
SYLK 
</TD>
<TD VALIGN="TOP">
Экспорт в текстовый  файл,   используемый электронной таблицей MultiPlan 
</TD>
</TR>
</TABLE>
<P>
В поле ввода From (Форма) диалогового окно Export (Экспорт) необходимо указать имя экспортируемой таблицы, а в поле То (В) — имя файла, в который будет записываться результат экспорта. 
</P>
<P>
После того как вы указали имя исходной таблицы, становится доступной кнопка Options (Параметры), при нажатии на которую открывается диалоговое окно Export Options (Параметры экспорта) (рис. 21.15). В этом диалоговом окне для выбора записей таблицы, экспортируемых в выходной файл, вы можете использовать кнопки Scope (Граница), For (Для), While (Пока). 
</P>
<IMG src="gl21-15.jpg" alt="gl21-15.jpg" width="321" height="166" ></IMG>
<P>
Рис. 21.15. Диалоговое окно Export Options 
</P>
<P>
С помощью кнопки Fields (Поля) можно открыть диалоговое окно Field Picker (Выбор поля), в котором выбрать поля исходной таблицы для экспорта (рис. 21.16). 
</P>
<IMG src="gl21-16.jpg" alt="gl21-16.jpg" width="391" height="221" ></IMG>
<P>
Рис. 21.16. Диалоговое окно Field Picker 
</P>
<p>&nbsp;
<a NAME="12"></a><font size="4">Импорт данных </font> 
</P>
<P>
В настоящем разделе мы обсудим импорт данных из форматов других приложений в таблицу Visual FoxPro. Для импорта данных воспользуемся услугами мастера. 
</P>
<ol>
  <li>Чтобы запустить мастера импорта данных в таблицу Visual FoxPro, в меню Tools (Сервис) выберите команду Wizards (Мастера), а затем Import (Импорт). 
  </li>
</ol>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для запуска мастера импорта вы также можете воспользоваться командой Import (Импорт) из меню File (Файл). В этом случае на экране открывается диалоговое окно Import (Импорт), в котором необходимо нажать кнопку Import Wizard (Мастер импорта).
</font> 
</P>
<ol>
  <li value="2">На первом шаге импорта данных с помощью мастера (рис. 21.17) вы указываете формат импортируемого файла, используя список File Type (Тип файла). С помощью кнопки Locate (Определить) вы задаете в поле Source File (Файл источника) имя исходного файла. Затем установкой соответствующей опции вам необходимо указать, в новую таблицу вы импортируете файл или в существующую, и задать имя таблицы. 
  </li>
</ol>
<blockquote>
<P>
Завершив установку параметров, нажмите кнопку Next (Далее). 
</P>
</blockquote>
<IMG src="gl21-17.jpg" alt="gl21-17.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.17. Первый шаг работы мастера: выбор типа импортируемого файла 
</P>
<ol>
  <li value="3">На втором шаге работы мастера вам необходимо указать, создается свободная таблица или таблица, входящая в базу данных. Установите соответствующую 
опцию. Если импортируемая таблица будет размещена в базе данных, то укажите ее название и расположение. 
  </li>
  <li>На следующих двух шагах вы можете просмотреть содержимое импортируемого файла, определить заголовки и типы создаваемых полей (рис. 21.18 и 21.19). 
  </li>
</ol>
<IMG src="gl21-18.jpg" alt="gl21-18.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.18. Определение формата данных 
</P>
<IMG src="gl21-19.jpg" alt="gl21-19.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.19. Определение заголовков и типов полей 
</P>
<ol>
  <li value="5">На пятом шаге работы мастера импорта задаются форматы отображения дат, кодовых страниц, денежных единиц и чисел (рис. 21.20). 
  </li>
  <li>После завершения установок на последнем шаге работы мастера нажмите кнопку Finish (Готово), и на основе данных импортируемого файла будет создана таблица Visual FoxPro. 
  </li>
</ol>
<IMG src="gl21-20.jpg" alt="gl21-20.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.20. Задание форматов отображения данных 
</P>
<p>&nbsp;
<a NAME="13"></a><font size="4">Использование данных
из Visual FoxPro в Microsoft Word </font> 
</P>
<P>
Данные, содержащиеся в таблицах Visual FoxPro, можно использовать в других приложениях Windows. Например, в Microsoft Word вы можете подготовить этикетки для наклейки на конверты для рассылки своим клиентам, используя для этого данные, размещенные в таблице Customer. 
</P>
<P>
Для слияния данных из Visual FoxPro и Microsoft Word необходимо использовать мастер. Чтобы его запустить, в меню Tools (Сервис) выберите команду Wizards (Мастера) и в появившемся подменю — Mail Merge (Составление писем). Слияние данных осуществляется с помощью мастера за несколько шагов. 
</P>
<ol>
  <li>На первом шаге мастер предлагает выбрать таблицу и поля, используемые для слияния (рис. 21.21). Перенесите необходимые поля в список Selected fields (Выбранные поля) и нажмите кнопку Next (Далее). 
  </li>
</ol>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Перед запуском мастера закройте базу данных. </font> 
</P>
<ol>
  <li value="2">На втором шаге необходимо указать, с каким редактором вы будете работать далее. По умолчанию установлена опция Microsoft Word. Нажмите кнопку Next (Далее) для перехода к следующему шагу (рис. 21.22). 
  </li>
</ol>
<IMG src="gl21-21.jpg" alt="gl21-21.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.21. Выбор таблицы и полей 
</P>
<IMG src="gl21-22.jpg" alt="gl21-22.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.22. Выбор текстового редактора 
</P>
<ol>
  <li value="3">На третьем шаге мастер предлагает поместить данные в новый или уже 
существующий документ (рис. 21.23). При выборе переключателя Use existing document (Существующий документ) становится доступной кнопка File (Файл), открывающая диалоговое окно Open (Открыть) для выбора ранее подготовленного документа. 
  </li>
  <li>Если вы хотите разместить данные во вновь создаваемом документе, то на четвертом шаге мастера необходимо определить тип создаваемого файла
(рис. 21.24), выбрав один из переключателей группы Select a document type (Выбор 
типа документа). В табл. 21.3 описаны переключатели группы Select a document type (Выбор типа документа) и типы создаваемых файлов. 
  </li>
</ol>
<IMG src="gl21-23.jpg" alt="gl21-23.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.23. На данном шаге вы можете выбрать созданный ранее документ 
</P>
<P>
Таблица 21.3. Переключатели группы Select a document type 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Переключатель 
</TD>
<TD VALIGN="TOP">
Тип создаваемого документа 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Form Letter 
</TD>
<TD VALIGN="TOP">
Письмо 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Label 
</TD>
<TD VALIGN="TOP">
Этикетка 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Envelope 
</TD>
<TD VALIGN="TOP">
Конверт 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Catalog 
</TD>
<TD VALIGN="TOP">
Каталог 
</TD>
</TR>
</TABLE>
<blockquote>
<P>
Выбрав необходимую опцию, нажмите кнопку Next (Далее) для перехода к последнему шагу мастера. 
</P>
</blockquote>
<ol>
  <li value="5">На последнем шаге работы мастера следует нажать кнопку Finish (Готово). Если установлен драйвер ODBC, то все завершится успешно. Запустится Microsoft Word и откроется документ Word, 
в котором будет установлена связь с выбранными данными. </li>
  <li>Разместите текст в документе. Для вставки полей установите курсор в требуемое место, нажмите кнопку Добавить поле слияния и выберите из
раскрывающегося списка то поле, которое нужно. Поясняющий текст вставляется непосредственно в область ввода. 
  </li>
</ol>
<IMG src="gl21-24.jpg" alt="gl21-24.jpg" width="492" height="360" ></IMG>
<P>
Рис. 21.24. Выбор типа создаваемого документа 
</P>
<ol>
  <li value="7">Нажмите кнопку Объединить. Откроется окно Слияние, в котором вы 
можете указать параметры слияния. В нашем примере выберите из списка Назначение 
опцию Новый документ и оставьте остальные параметры без изменения. Возможность отбора записей не представляет большого интереса, т. к. средства создания запроса в Visual FoxPro намного богаче. Для окончательного объединения данных нажмите кнопку Объединить. 
  </li>
</ol>
<P>
Результат слияния данных приведен на рис. 21.25. 
</P>
<IMG src="gl21-26.jpg" alt="gl21-26.jpg" width="500" height="242" ></IMG>
<P>
Рис. 21.25. Документ, полученный в результате слияния 
</P>
</BODY>
</HTML>