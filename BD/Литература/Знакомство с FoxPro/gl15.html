<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 15
<br>
Расширенные средства ввода данных</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl15.html#1">Отображение данных в форме в табличном виде</a>
  <li><a href="gl15.html#2">Использование построителя </a>
  <li><a href="gl15.html#3">Свойства объекта Grid</a>
  <li><a href="gl15.html#4">Создание многотабличных форм для таблиц, имеющих отношение "один-ко-многим"</a>
  <li><a href="gl15.html#5">Создание объекта Gride помощью конструктора форм</a>
  <li><a href="gl15.html#6">Создание формы с вкладками </a>
  <li><a href="gl15.html#7">Набор форм </a>
  <li><a href="gl15.html#8">Таймер</a>
  <li><a href="gl15.html#9">Создание формы с использованием таймера</a>
  <li><a href="gl15.html#10">Добавление данных в список</a>
</ul>

<P>
В главе 6 мы рассмотрели создание в конструкторе форм формы, предназначенной для ввода и просмотра данных. Но средства, предлагаемые системой Visual FoxPro, настолько разнообразны, что мы продолжим изучение возможностей ввода данных и в этой главе. 
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Отображение данных в форме в табличном виде </font> 
</P>
<P>
В Visual FoxPro для отображения в форме данных в табличном виде используется объект Grid (Таблица), который может помещаться в форму, как и любой другой объект интерфейса. 
</P>
<P>
При использовании табличного режима информация лучше воспринимается, и, кроме того, проще вводить данные, т. к. пользователь видит сразу несколько записей и может вводить информацию по аналогии. Без табличного режима трудно обойтись, когда необходимо вводить и просматривать информацию из нескольких связанных таблиц, имеющих отношение &quot;один-комногим&quot;. 
</P>
<p>&nbsp;
<a NAME="2"></a><font size="4">Использование построителя </font> 
</P>
<P>
Использование построителя ускоряет размещение объекта в форме и определение его свойств. Особенно заметным это преимущество становится при создании сложных объектов, к числу которых относится объект Grid (Таблица). Рассмотрим пример размещения объекта Grid (Таблица) с помощью построителя для таблицы Customer и изучим свойства, которыми наделен данный объект. 
</P>
<P>
Для создания формы, в которой данные будут представлены в табличном виде, выполните следующие действия: 
</P>
<ol>
  <li>Откройте Проект Sales. </li>
  <li>Выберите вкладку Documents (Документы), перейдите в группу Forms (Формы), а затем нажмите кнопку New (Новый). 
  </li>
  <li>В открывшемся диалоговом окне New Form (Новая форма) выберите опцию New Form (Новая форма). На экране открывается окно конструктора форм. 
  </li>
  <li>Откройте окно среды окружения формы Data Environment (Среда окружения), выполнив команду Environment (Окружение) из меню View (Вид). 
  </li>
  <li>Для добавления таблицы в окружение выполните команду контекстного меню Add (Добавить). 
  </li>
  <li>В открывшемся диалоговом окне Add Table or View (Добавить таблицу или представление данных) выберите таблицу customer и нажмите кнопку ОК. В окне Data Environment (Среда окружения) появилась выбранная таблица. Закройте окно окружения. 
  </li>
  <li>Нажмите кнопку Builder Lock (Закрепитель построителя) LE__i на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Выберите кнопку Grid (Таблица) И' на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Установите указатель в место предполагаемого расположения таблицы, нажмите кнопку мыши и, удерживая ее нажатой, переместите курсор по диагонали, чтобы получилась рамка требуемого размера. 
  </li>
  <li>Запускается построитель и на экране открывается диалоговое окно Grid Builder (Построитель таблицы) (рис. 15.1), позволяющее задать основные параметры объекта Grid (Таблица). 
  </li>
</ol>
<blockquote>
<P>
Диалоговое  окно  построителя  объекта Grid  (Таблица)  содержит четыре вкладки, используя которые вы можете настроить его параметры (табл. 15.1). 
</P>
</blockquote>
<P>
Таблица 15.1. Назначение вкладок окна Grid Builder 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Вкладка 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Grid   Items   (Элементы объекта Grid) 
</TD>
<TD VALIGN="TOP">
Позволяет сформировать список полей, размещаемых в создаваемом объекте 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Style (Стиль) 
</TD>
<TD VALIGN="TOP">
Позволяет задать стиль отображения таблицы, выбрав один из предложенных вариантов: Professional (Профессиональный), Standard (Стандартный), Embossed (Изысканный), Ledger (Бизнес) 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Layout (Расположение) 
</TD>
<TD VALIGN="TOP">
Позволяет переопределить заголовки столбцов объекта Grid (Таблица) и определить тип объекта, отображаемого в столбце таблицы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Relationship
(Отношения) 
</TD>
<TD VALIGN="TOP">
При создании многотабличных форм позволяет определить отношения между таблицами 
</TD>
</TR>
</TABLE>
<ol>
  <li value="11">Используя кнопки со стрелками, перенесите из списка Available fields (Имеющиеся поля) в список Selected fields (Выбранные поля) поля, которые вы хотите разместить, используя объект Grid (Таблица). 
  </li>
</ol>
<IMG src="gl15-1.jpg" alt="gl15-1.jpg" width="500" height="437" ></IMG>
<P>
Рис. 15.1. Диалоговое окно Grid Builder 
</P>
<ol>
  <li value="12">Для задания стиля отображения данных в таблице перейдите на вкладку Style (Стиль). Используя одноименный список, выберите один из вариантов оформления таблицы (рис. 15.2). 
  </li>
  <li>По умолчанию заголовки столбцов совпадают с именами полей таблицы, заданными в свойстве Caption (Надпись) конструктора таблиц. Чтобы переопределить заголовки столбцов объекта Grid (Таблица), перейдите на вкладку Layout (Расположение) (рис. 15.3). Она содержит создаваемый объект с реальными данными. При перемещении по столбцам таблицы в поле ввода Caption (Надпись) вкладки отображается наименование данного столбца. Для изменения наименования столбца скорректируйте имя, отображаемое в этом поле. 
  </li>
</ol>
<IMG src="gl15-2.jpg" alt="gl15-2.jpg" width="500" height="437" ></IMG>
<P>
Рис. 15.2. Определение стиля объекта Grid 
</P>
<IMG src="gl15-3.jpg" alt="gl15-3.jpg" width="500" height="437" ></IMG>
<P>
Рис. 15.3. Переопределение заголовков столбцов объекта Grid 
</P>
<ol>
  <li value="14">На вкладке Layout (Расположение) вы можете задать тип объекта, 
  отображаемого в столбце. Для этого воспользуйтесь раскрывающимся списком Control type (Стиль элементов управления), содержащим перечень всех типов объектов, которые могут отображаться в столбце: Textbox, 
  Editbox, Spinner, Checkbox и OLEBoundControl. Выберите из списка необходимое значение типа данных столбца. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">При использовании объекта Grid (Таблица) для создания многотабличных форм вы можете выбрать вкладку Relationship (Отношение) (рис. 15.4) и на ней задать ключевое поле главной таблицы и индекс подчиненной таблицы. Если вторая таблица не добавлена в окружение формы, нажмите кнопку, расположенную рядом со списком Key field in parent table (Ключевое поле в родительской таблице), и в открывшемся диалоговом окне Open (Открыть) выберите необходимую таблицу. Она будет добавлена построителем в окружение формы.
</font> 
</P>
<ol>
  <li value="15">После завершения определения всех параметров нажмите кнопку ОК для закрытия окна построителя. 
  </li>
</ol>
<IMG src="gl15-4.jpg" alt="gl15-4.jpg" width="500" height="437" ></IMG>
<P>
Рис. 15.4. Вкладка Relationship для установки связи между таблицами 
</P>
<ol>
  <li value="16">Используя кнопку Label (Текстовый объект) на панели инструментов Form Controls (Элементы управления формы), разместите заголовок в форме. 
  </li>
</ol>
<p>&nbsp;
<a NAME="3"></a><font size="4">Свойства объекта Grid </font> 
</P>
<P>
Построитель — очень удобное средство для быстрого создания объекта Grid (Таблица). Однако созданный с его помощью объект требует некоторой модификации внешнего вида. С этой целью рассмотрим основные свойства, характеризующие объект Grid (Таблица). 
</P>
<P>
Щелкните правой кнопкой мыши на объекте Grid (Таблица). В контекстном меню содержится команда Edit (Правка), указывающая, что объект является сложным, т. е. состоящим из нескольких входящих в него объектов. 
</P>
<P>
Такими объектами являются column (Столбец), Header (Заголовок) и Text (Текст). Выделите объект Grid (Таблица) и откройте окно свойств (рис. 15.5). Созданный объект характеризуется свойствами, относящимися ко всему объекту в целом. Помимо этого, объекты column (Столбец), Header (Заголовок) и Text (Текст) обладают своими собственными свойствами. 
</P>
<P>
Объекты, характеризующие столбцы таблицы, представлены в табл. 15.2. 
</P>
<P>
Таблица 15.2. Назначение объектов, характеризующих столбцы таблицы 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Объект 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Column (Столбец) 
</TD>
<TD VALIGN="TOP">
Определяет свойства, относящиеся к помещаемой в столбец информации 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Header (Заголовок) 
</TD>
<TD VALIGN="TOP">
Определяет свойства, характеризующие заголовок столбца 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Text (Текст) 
</TD>
<TD VALIGN="TOP">
Определяет свойства поля таблицы, когда на нем установлен фокус 
</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl15-6.jpg" alt="gl15-6.jpg" width="500" height="511" ></IMG> </p>
<P>
Рис. 15.5. Окно свойств объекта Grid 
</P>
<P>
<b>Свойства, определяющие объект Grid </b> 
</P>
<P>
Сначала обратимся  к основным  свойствам,  определяющим объект  Grid (Таблица) в целом. К числу таких свойств относятся: 
</P>
<ul>
  <li>ComumnCount —      количество столбцов в создаваемом объекте      Grid
(Таблица); </li>
  <li>GridLineWidth — толщина сетки таблицы; </li>
  <li>GridLineCoior — цвет сетки таблицы; </li>
  <li>GridLines — стиль оформления таблицы; может принимать одно из следующих значений: 
  <ul>
    <li>None (Нет) — в таблице отсутствуют горизонтальные и вертикальные линии; 
    </li>
    <li>Horizontal (Горизонтальные) — в таблице присутствуют горизонтальные линии; 
    </li>
    <li>vertical (Вертикальные) — в таблице присутствуют только вертикальные линии; 
    </li>
    <li>Both (Default) (Горизонтальные и вертикальные) — в таблице присутствуют горизонтальные и вертикальные линии; 
    </li>
  </ul>
  </li>
  <li>Recordsource — задает источник данных помещаемой в объект информации; 
  </li>
  <li>RecordSourceType — задает тип источника данных и может принимать одно из следующих значений: 
  <ul>
    <li><span lang="en-us">Table</span> (Таблица) — автоматически открывает таблицу, заданную свойством RecordSource; 
    </li>
    <li>Alias (Псевдоним) — использует заданный псевдоним таблицы; </li>
    <li>Prompt (Запрашиваемое значение) — если для формы в среде окружения не определены таблицы, запрашивается исходная таблица для отображения в объекте Grid (Таблица); 
    </li>
    <li>Query (QPR) (Запрос) — в качестве источника данных используются результаты запроса; 
    </li>
    <li>SQL statement (SQL-предложение) — в качестве источника данных используется SQL-предложение; 
    </li>
  </ul>
  </li>
  <li><span lang="en-us">C</span>hi<span lang="en-us">l</span>d<span lang="en-us">O</span>rder — задает имя индекса, используемого для установления связи между таблицами; 
  </li>
  <li>RecordMark — определяет наличие с левой стороны объекта Grid (Таблица) столбца, содержащего указатель текущей записи. 
  </li>
</ul>
<P>
<b>Свойства объекта Column </b> 
</P>
<P>
Объект column (Столбец) является составной частью объекта Grid (Таблица) и определяет информацию, выводимую в столбцах объекта Grid (Таблица). 
</P>
<P>
Используя свойства объекта column (Столбец), можно задать цвет фона столбца, а также цвет выводимой информации, тип шрифта, размер, выделив тем самым наиболее важную информацию в размещенном в форме табличном объекте. 
</P>
<P>
Объект column (Столбец) характеризуется следующими основными свойствами: 
</P>
<ul>
  <li>CoiumnOrder — задает порядок следования столбцов; </li>
  <li>Alignment — выравнивает информацию в столбце; </li>
  <li>Controisource — связывает столбец с источником данных. </li>
</ul>
<P>
<b>Свойства объекта Header </b> 
</P>
<P>
Объект Grid (Таблица) состоит из столбцов, каждый из которых имеет собственный заголовок, являющийся объектом Header (Заголовок). В Visual FoxPro заголовок каждого столбца является самостоятельным объектом. Его можно корректировать, изменяя свойства. 
</P>
<P>
Свойство caption (Надпись) объекта определяет наименование заголовка столбца, а свойство Alignment (Выравнивание) задает его расположение в столбце. 
</P>
<P>
Помимо этого, объект Header (Заголовок), как и объект column (Столбец), характеризуется свойствами, определяющими цвет фона, тип и размер шрифта заголовка. 
</P>
<P>
<b>Свойства объекта Text </b> 
</P>
<P>
Объект Text (Текст) определяет вид информации, выводимой в столбцах объекта Grid (Таблица), при установленном курсоре на текущую запись в столбце. 
</P>
<P>
Используя свойства данного объекта, можно задать цвет фона, тип и размер шрифта выводимой информации. , 
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Создание многотабличных форм для таблиц, имеющих отношение &quot;один-ко-многим&quot;
</font> 
</P>
<P>
Во всех рассмотренных нами ранее примерах по созданию форм использовались связанные таблицы с отношением между ними &quot;один-к-одному&quot; или &quot;многие-к-одному&quot;. При создании приложений очень часто возникает необходимость просмотра и редактирования данных, имеющих отношение
&quot;один-ко-многим&quot;. В этом случае при создании формы для отображения записей основной таблицы можно использовать поля формы или объект Grid (Таблица), а для отображения данных подчиненной таблицы — объект Grid (Таблица). Рассмотрим создание многотабличных форм с помощью мастера и конструктора форм. 
</P>
<P>
<b>Создание многотабличной формы с помощью мастера </b> 
</P>
<P>
Рассмотрим создание формы для связанных таблиц customer и Phoncust, имеющих отношение &quot;один-ко-многим&quot; с помощью мастера. Таблица customer содержит информацию о клиентах, таблица Phoncust — номера телефонов, по которым можно с ними связываться. 
</P>
<ol>
  <li>Откройте проект sales. </li>
  <li>Перейдите на вкладку Documents (Документы), выберите группу Forms (Формы) и нажмите кнопку New (Новый). 
  </li>
  <li>В открывшемся диалоговом окне New Form (Новая форма) выберите опцию Form Wizard (Мастер формы). 
  </li>
</ol>
<IMG src="gl15-7.jpg" alt="gl15-7.jpg" width="500" height="470" ></IMG>
<P>
Рис. 15,6. Диалоговое окно для выбора мастера многотабличной формы 
</P>
<ol>
  <li value="4">На экране открывается диалоговое окно, предназначенное для выбора мастера создания формы (рис. 15.6). Поскольку мы создаем форму для связанных таблиц, выберите опцию One-to-Many Form Wizard (Мастер формы с отношением &quot;один-ко-многим&quot;) и нажмите кнопку ОК для вызова мастера многотабличной формы. 
  </li>
  <li>В области Databases and tables (Базы данных и таблицы) выберите главную таблицу формы Customer. После выбора таблицы в списке Available fields (Имеющиеся поля) появится перечень всех полей данной таблицы. Перенесите из этого списка в список Selected fields (Выбранные поля) поля, которые вы хотите поместить в создаваемую форму из данной таблицы (рис. 15.7). Затем нажмите кнопку Next (Далее) для перехода к следующему шагу. 
  </li>
  <li>На втором шаге работы мастера выберите подчиненную таблицу и ее поля, которые будут размещены в форме в виде объекта Grid (Таблица) (рис. 15.8). Для перехода к следующему шагу нажмите кнопку Next (Далее). 
  </li>
</ol>
<IMG src="gl15-8.jpg" alt="gl15-8.jpg" width="492" height="360" ></IMG>
<P>
Рис. 15.7. Выбор полей главной таблицы 
</P>
<ol>
  <li value="7">На третьем шаге мастера необходимо установить связь между таблицами, используемыми в форме (рис. 15.9). В диалоговом окне размещены два раскрывающихся списка, содержащие индексы и поля исходных таблиц. В нашем примере для установления связи воспользуемся ключевым полем
icdcustomer Таблицы Customer и индексом icdcustomer таблицы Phoncust.
Установив связь между таблицами, нажмите кнопку Next (Далее). </li>
  <li>На четвертом шаге (рис. 15.10) необходимо установить стиль отображения объектов формы, воспользовавшись значениями из списка Style
(Стиль), и тип кнопок управления, выбрав одну из опций в группе Button type (Тип кнопки). Выберите стиль, просмотрите результат выбора в верхней части диалогового окна. Затем выберите тип отображения кнопок управления (с текстовыми надписями или с изображениями). Если вы не хотите размещать кнопки в форме, установите опцию No buttons (Без кнопок). После того как вы установили требуемые параметры, нажмите кнопку Next (Далее). 
  </li>
</ol>
<IMG src="gl15-9.jpg" alt="gl15-9.jpg" width="492" height="360" ></IMG>
<P>
Рис. 15.8. Выбор полей подчиненной таблицы, помещаемых в объект Grid 
</P>
<IMG src="gl15-10.jpg" alt="gl15-10.jpg" width="492" height="360" ></IMG>
<P>
Рис. 15.9. Установка связи между таблицами 
</P>
<IMG src="gl15-11.jpg" alt="gl15-11.jpg" width="492" height="360" ></IMG>
<P>
Рис. 15.10. Выбор стиля отображения полей и управляющих кнопок 
</P>
<ol>
  <li value="9">На следующем шаге формируется список полей, по которым будет осуществляться сортировка отображаемых в форме данных. Для переноса поля из списка Available fields or index tag (Имеющиеся поля и индексы) в список Selected fields (Выбранные поля) установите курсор на поле или индекс, по значению которого требуется упорядочивать данные, и нажмите кнопку Add (Добавить). Если вы ошибочно перенесли не то поле или индекс, удалить его из списка Selected fields (Выбранные поля) можно с помощью кнопки Remove (Удалить). Установите опцию Ascending (По возрастанию) или Descending (По убыванию), определяющую, по возрастанию или по убыванию значения выбранного поля будут упорядочиваться данные (рис. 15.11). Для перехода к следующему шагу создания формы нажмите кнопку Next (Далее). 
  </li>
  <li>На последнем, шестом шаге, в поле ввода Т^ре a title for your form (Тип заголовка формы) задайте заголовок, размещаемый в форме, и выберите один из трех вариантов продолжения работы с формой (рис. 15.12) (табл. 15.3). 
  </li>
</ol>
<P>
Таблица 15.3. Варианты продолжения работы с формой 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Опция 
</TD>
<TD VALIGN="TOP">
Действие 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save form for later use (Сохранить форму) 
</TD>
<TD VALIGN="TOP">
Созданная форма сохраняется на диске 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save and run form (Сохранить и запустить форму на выполнение) 
</TD>
<TD VALIGN="TOP">
Созданная форма сохраняется и запускается на выполнение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Save form and modify it in the Form Designer (Сохранить и открыть для модификации в конструкторе форм) 
</TD>
<TD VALIGN="TOP">
Созданная форма сохраняется и открывается в конструкторе форм для модификации 
</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl15-12.jpg" alt="gl15-12.jpg" width="492" height="360" ></IMG> </p>
<P>
Рис. 15.11. Установка критерия сортировки данных 
</P>
<P>
После установки требуемой опции нажмите кнопку Finish (Готово) для завершения создания объекта с помощью мастера. В открывшемся диалоговом окне Save as (Сохранить как) выберите папку, в которой хотите разместить форму, и введите имя созданной формы. 
</P>
<IMG src="gl15-13.jpg" alt="gl15-13.jpg" width="492" height="360" ></IMG>
<P>
Рис. 15.12. Заключительное диалоговое окно мастера 
</P>
<P>
Посмотрите на форму, созданную с помощью мастера (рис. 15.13). Надписи к полям основной таблицы созданы с использованием информации, введенной в поле Caption (Надпись) свойства таблицы. Однако при формировании
названий столбцов объекта Grid (Таблица) мастер не использовал это свойство таблицы. Для изменения наименований столбцов вам потребуется конструктор форм. 
</P>
<IMG src="gl15-14.jpg" alt="gl15-14.jpg" width="500" height="381" ></IMG>
<P>
Рис. 15.13. Многотабличная форма, созданная с помощью мастера форм 
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Создание объекта Grid
с помощью конструктора форм </font> 
</P>
<P>
Форма для таблиц, имеющих отношение &quot;один-ко-многим&quot;, с помощью мастера создается достаточно быстро. Но она требует определенной доработки в конструкторе форм. Поэтому вам необходимо уметь создавать многотабличные формы с помощью конструктора, чтобы при необходимости уметь их модифицировать. Для создания формы в конструкторе форм следует выполнить следующие действия: 
</P>
<ol>
  <li>В окне Data Environment (Среда окружения) разместите таблицы, используемые в форме. 
  </li>
  <li>Установите связи между таблицами. </li>
  <li>Разместите в форме поля главной таблицы. </li>
  <li>Создайте в форме объект Grid (Таблица) для отображения данных подчиненной таблицы. 
  </li>
</ol>
<P>
<b>Создание формы, содержащей объект Grid </b> 
</P>
<P>
Рассмотрим создание формы, с помощью которой можно просмотреть информацию о клиентах, их телефонах и сделанных ими покупках. В отчете
будем   использовать   следующие   таблицы:   Customer,    Phoncust,    Ordsalem,
ordsaied и Goods. В таблицах содержится следующая информация: 
</P>
<ul>
  <li>Сustomer — список клиентов; </li>
  <li>Phoncust — средства связи, по которым можно связаться с клиентом; </li>
  <li>Ordsalem — информация о продажах: номер заказа, дата заказа, код клиента, итоговая сумма заказа; 
  </li>
  <li><span lang="en-us">O</span>rdsaied — код, количество и стоимость проданного товара по данному заказу; 
  </li>
  <li>Goods — информация о товарах. </li>
</ul>
<P>
Отношение между таблицами customer и Phoncust определяется как &quot;одинко-многим&quot;, т. к. клиент может иметь несколько номеров телефона или факс для связи. 
</P>
<P>
Отношение между таблицами Customer и Ordsalem также &quot;один-ко-многим&quot;, поскольку каждый клиент может сделать несколько покупок. 
</P>
<P>
Приступим к созданию формы. 
</P>
<ol>
  <li>Откройте проект Sales. </li>
  <li>Откройте окно конструктора форм для создания новой формы. </li>
  <li>Откройте окно Data Environment (Среда окружения), выполнив команду Environment (Окружение) из меню View (Вид). 
  </li>
  <li>Используя команду Add (Добавить) из меню Data Environment (Среда окружения), добавьте В форму таблицы Customer, Phoncust, Ordsalem, Ordsaied и Goods. Между ними существуют следующие отношения: 
  </li>
</ol>
<ul>
  <li>customer —  родительская  по  отношению  к  таблицам   Phoncust   и
Ordsalem; </li>
  <li>Ordsalem — родительская по отношению к таблице ordsaied; </li>
  <li>ordsaied — родительская по отношению к таблице Goods. Связь между таблицами осуществляется: 
  </li>
  <li>customer и Phoncust  — по коду клиента; </li>
  <li>Customer и Ordsalem — по коду клиента; </li>
  <li>Ordsalem и Ordsaied — по коду заказа; </li>
  <li>Ordsaied и Goods — по коду товара. </li>
</ul>
<blockquote>
<P>
Данные в таблицах customer, Ordsalem и Phoncust должны быть упорядочены по коду клиента, в ordsaied — по коду заказа, а в Goods — по коду товара. 
</P>
</blockquote>
<ol>
  <li value="5">Установив все необходимые связи между таблицами и указав упорядочение данных (рис. 15.14), закройте окно Data Environment (Среда окружения). 
  </li>
</ol>
<IMG src="gl15-15.jpg" alt="gl15-15.jpg" width="500" height="426" ></IMG>
<P>
Рис. 15.14. Окно Data Environment создаваемой формы 
</P>
<ol>
  <li value="6">Используя кнопки панели инструментов Form Controls (Элементы управления формы), расположите в форме заголовок, надписи и необходимые 
  поля таблицы Customer. </li>
  <li>Выберите кнопку Grid (Таблица) на панели инструментов Form Controls
(Элементы управления формы). </li>
  <li>Установите указатель в место предполагаемого расположения объекта и, удерживая кнопку мыши нажатой, переместите курсор по диагонали, нарисовав рамку требуемого размера. 
  </li>
  <li>Для определения параметров созданного объекта выделите его и откройте окно свойств, выполнив команду Properties (Свойства) из меню View (Вид). 
  </li>
  <li>Скорректируйте свойство coiumnCount (Количество столбцов) объекта Grid (Таблица), задав количество столбцов в создаваемом объекте равным 3. 
  </li>
  <li>Если вы хотите изменить цвет сетки таблицы, определите свойство GridLineCoior (Цвет сетки таблицы) объекта Grid (Таблица). 
  </li>
  <li>Используя свойство controisource (Источник данных) каждого из трех объектов column (Столбец), входящих в объект Grid (Таблица), свяжите 
  столбцы с полями таблицы Phoncust. </li>
  <li>Используя свойство caption (Надпись) каждого из трех объектов Header (Заголовок), входящих в объект Grid (Таблица), введите заголовки столбцов Вид связи, Номер кода и Номер. Чтобы заголовки располагались по центру столбцов, скорректируйте для каждого из них свойство Alignment (Выравнивание), установив значение Middle (По середине)
Center   (По центру). 
<P>
Определение первого объекта Grid  (Таблица) завершено. Разместим в форме второй объект Grid (Таблица). 
</P>
<P>
&nbsp;</P>
  </li>
  <li>Нажмите кнопку Grid (Таблица) на панели инструментов Form Controls
(Элементы управления формы). </li>
  <li>Установите указатель в нижней части формы и, удерживая кнопку мыши в нажатом состоянии, переместите курсор по диагонали так, чтобы получилась рамка необходимого размера. 
  </li>
  <li>Для определения параметров созданного объекта выделите его и откройте окно свойств. 
  </li>
  <li>Скорректируйте свойство CoiumnCount (Количество столбцов) объекта Grid (Таблица), задав количество столбцов (6) в создаваемом объекте. 
  </li>
  <li>Если необходимо выбрать цвет сетки таблицы, определите свойство GridLineCoior (Цвет сетки таблицы) объекта Grid (Таблица). 
  </li>
  <li>Используя свойство controisource (Источник данных) каждого из пяти объектов column (Столбец), входящих в объект Grid (Таблица), выполните следующие действия: 
  </li>
</ol>
<blockquote>
  <ul>
    <li>свяжите первые два столбца с полями cndoc и ddoc таблицы Ordsaiem; </li>
    <li>свяжите третий столбец с полем cnmgoods таблицы Goods; </li>
    <li>четвертый и пятый столбцы свяжите с полями nquant    и nunitprice таблицы Ordsaled. 
    </li>
  </ul>
</blockquote>
<ol>
  <li value="20">Шестой столбец таблицы будет содержать вычисляемое поле, определяющее стоимость проданного товара. Используя свойство
Controisource      (источник данных)     для шестого объекта     Column
(Столбец), задайте выражение для вычисляемого поля:
 Ordsaled.nQuant*Ordsaled.nUnitPrice </li>
  <li>Используя свойство caption (Надпись) каждого из шести объектов Header (Заголовок), входящих в объект Grid (Таблица), введите заголовки столбцов: Номер документа, Дата, Наименование товара, Количество, Цена и Стоимость. Чтобы заголовки столбцов располагались по центру, скорректируйте для каждого из них свойство Alignment (Выравнивание), установив значение Middle (По середине) center (По центру). 
  </li>
  <li>Используя свойство ForeCoior каждого из пяти объектов Text (Текст), входящих в объект Grid (Таблица), установите цвет (например, красный) для выделения информации при установке курсора на данное поле. 
  </li>
  <li>Добавьте в создаваемую форму кнопки перемещения по записям. Полученная форма показана на рис. 15.15. 
  </li>
</ol>
<IMG src="gl15-16.jpg" alt="gl15-16.jpg" width="500" height="422" ></IMG>
<P>
Рис. 15.15. Многотабличная форма 
</P>
<ol>
  <li value="24">Сохраните созданную форму и запустите ее на выполнение. Отметьте, что при перемещении по записям таблицы customer в первом объекте Grid (Таблица) отображается список телефонных номеров, по которым можно связаться с клиентом, а во втором объекте Grid (Таблица) показывается полный список товаров, купленных данным клиентом (рис. 15.16). 
  </li>
</ol>
<IMG src="gl15-17.jpg" alt="gl15-17.jpg" width="500" height="422" ></IMG>
<P>
Рис. 15.16. Просмотр многотабличной формы 
</P>
<P>
<b>Создание формы, содержащей три объекта Grid </b> 
</P>
<P>
В рассмотренном примере мы использовали поля формы для отображения информации главной таблицы. Модифицируем созданную форму и разместим поля таблицы customer в объекте Grid (Таблица). 
</P>
<ol>
  <li>Откройте в окне конструктора форм созданную в предыдущем примере форму и сохраните ее под новым именем. 
  </li>
  <li>Удалите из формы все поля и надписи, оставив только объекты Grid (Таблица) (рис. 15.17). 
  </li>
  <li>Нажмите кнопку Grid (Таблица) на панели инструментов Form Controls
(Элементы управления формы), установите указатель в левой верхней части формы и создайте новый объект Grid (Таблица). 
  </li>
  <li>В окне свойств созданного объекта скорректируйте для объекта Grid (Таблица) свойство coiumncount (Количество столбцов), задав количество столбцов (4) в создаваемом объекте. 
  </li>
  <li>Свяжите столбцы объекта с полями ccompany, clastname, cfirstname и caddress таблицы Customer. 
  </li>
</ol>
<IMG src="gl15-18.jpg" alt="gl15-18.jpg" width="500" height="422" ></IMG>
<P>
Рис. 15.17. Удаление из формы полей ввода и надписей к ним 
</P>
<IMG src="gl15-19.jpg" alt="gl15-19.jpg" width="500" height="422" ></IMG>
<P>
Рис. 15.18. Форма с тремя объектами Grid 
</P>
<ol>
  <li value="6">Скорректируйте для вновь созданных объектов свойства, определяющие цвет сетки таблицы, расположение заголовков, цвета отображения заголовков и выводимых данных. 
  </li>
  <li>Сохраните форму и запустите ее на выполнение. Вид созданной формы показан на рис. 15.18. 
  </li>
</ol>
<p>&nbsp;
<a NAME="6"></a><font size="4">Создание формы с вкладками </font> 
</P>
<P>
Visual FoxPro позволяет создавать формы, содержащие несколько вкладок. Объекты данного типа удобно использовать в том случае, когда необходимо разместить большой объем информации или для удобства работы требуется основную, наиболее часто используемую информацию, сгруппировать в одном месте, отделив от менее важной информации. 
</P>
<P>
Чтобы создать вкладки в форме, необходимо воспользоваться кнопкой Page
Frame (Вкладка) панели инструментов Form Controls (Элементы управления формы). Созданный объект содержит в контекстном меню команду Edit (Правка), указывающую, что он является сложным объектом, в котором вкладки наделены своими собственными свойствами. Количество вкладок задается свойством Pagecount (Количество вкладок). В процессе создания формы переход с одной вкладки на другую осуществляется в режиме редактирования. 
</P>
<P>
Создание объекта типа page Frame (Вкладка) рассмотрим на примере разработки многостраничной формы для таблицы customer. Форма будет содержать две вкладки. На первой вкладке будет располагаться объект Grid (Таблица), содержащий список всех клиентов, а на второй — дополнительные данные о выбранном на первой вкладке клиенте. 
</P>
<ol>
  <li>Откройте проект Sales. </li>
  <li>Откройте окно конструктора форм для создания новой формы. Скорректируйте свойство caption (Надпись) формы, введя заголовок формы Список клиентов. 
  </li>
  <li>Откройте диалоговое окно Data Environment (Среда окружения), выполнив команду Environment (Окружение) из меню View (Вид). 
  </li>
  <li>Используя команду Add (Добавить) всплывающего меню, добавьте в форму таблицу Customer. Закройте диалоговое окно. 
  </li>
  <li>Нажмите кнопку Page Frame (Вкладка) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Установите указатель в форму и, удерживая кнопку мыши в нажатом состоянии, переместите курсор по диагонали так, чтобы получилась рамка размером с форму (рис. 15.19). 
  </li>
</ol>
<IMG src="gl15-20.jpg" alt="gl15-20.jpg" width="500" height="427" ></IMG>
<P>
Рис. 15.19. Размещение в форме объекта Page  Frame 
</P>
<ol>
  <li value="7">Откройте окно свойств созданного объекта. Убедитесь, что для свойства Pagecount, определяющего количество вкладок формы, по умолчанию установлено значение 2. 
  </li>
  <li>Скорректируйте свойство caption (Надпись) для объектов Pagei и Раде2, определяющих заголовок каждой вкладки. Для объекта Pagei введите заголовок Основная информация, а для объекта Раде2 — Дополнительная информация. 
  </li>
  <li>Для перехода в режим редактирования объекта Page Frame (Вкладка) выберите команду Edit (Правка) контекстного меню. Вокруг объекта появилась штриховая контурная рамка. 
  </li>
  <li>Убедитесь, что вы находитесь на первой вкладке объекта Page Frame (Вкладка). Для этого щелкните мышкой на вкладке Основная информация в верхней части формы. 
  </li>
  <li>Используя кнопку Grid (Таблица) на панели инструментов Form Controls (Элементы управления формы), создайте объект Grid (Таблица) для
отображения ПОЛеЙ icdcustomer, ccompany таблицы Customer. </li>
  <li>В третьем столбце таблицы для отображения фамилии, имени и отчества представителя в свойстве Control Sour се (Источник данных) введите выражение следующего вида: 
  </li>
</ol>
<blockquote>
<P>
 a lit rim (customer .cLastname) + &quot; &quot; + allt rim (customer .cFirstname)  + &quot; &quot; + alltrim(customer.cSecondname) 
</P>
</blockquote>
<ol>
  <li value="13">Определите заголовки столбцов и другие параметры созданного объекта Grid (Таблица). 
  </li>
  <li>В нижней части страницы расположите кнопки перемещения по записям таблицы и выхода из формы. 
  </li>
</ol>
<P>
На рис. 15.20 представлена первая вкладка созданной формы. 
</P>
<IMG src="gl15-21.jpg" alt="gl15-21.jpg" width="500" height="439" ></IMG>
<P>
Рис. 15.20. Первая страница многостраничной формы 
</P>
<ol>
  <li value="15">Перейдите на вторую вкладку объекта Page Frame (Вкладка). Для этого щелкните на названии вкладки Дополнительная информация в верхней части формы. 
  </li>
</ol>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Если ваша попытка перейти на вторую вкладку оказалось безуспешной, убедитесь, что объект Page  Frame (Вкладка) находится в режиме редактирования.
</font> 
</P>
<ol>
  <li value="16">На второй странице объекта расположите все поля таблицы Customer и надписи к ним. 
  </li>
  <li>При переходе на другую вкладку формы необходимо обновлять значения данных, отображаемых в ней. Для этого вы можете использовать событие Activate (Активизация) каждой вкладки объекта Page Frame (Вкладка). Откройте окно редактирования процедуры обработки данного события и введите следующую команду, использующую метод Refresh (Обновить): 
  </li>
</ol>
<blockquote>
<P>
 screen.ActiveForm.Refresh() 
</P>
<P>
Окно процедур для метода Refresh представлено на рис. 15.21. 
</P>
</blockquote>
<ol>
  <li value="18">Сохраните созданную форму и запустите ее на выполнение. </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Обратите внимание, что после ввода информации в окно процедуры в свойстве данного метода появляется значение [User Procedure].
</font> 
</P>
<IMG src="gl15-22.jpg" alt="gl15-22.jpg" width="500" height="439" ></IMG>
<p>Рис. 15.21. Окно процедуры для метода <span lang="en-us">Refresh</span></p>
<P>
Используя первую вкладку формы, вы можете, перемещаясь по записям таблицы, просмотреть весь список клиентов. Для просмотра дополнительной информации по любому из клиентов установите на него курсор и нажмите ярлык Дополнительная информация. В результате откроется вторая вкладка формы (рис. 15.22), на которой располагается дополнительная информация о выбранном клиенте. 
</P>
<IMG src="gl15-23.jpg" alt="gl15-23.jpg" width="500" height="454" ></IMG>
<P>
Рис. 15.22. Вторая вкладка формы 
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Набор форм </font> 
</P>
<P>
В Visual FoxPro вы можете объединить несколько форм в набор форм. Для этого служит команда Create Form Set (Создать набор форм) из меню Form (Форма), создающая объект FormSet. 
</P>
<P>
Создадим объект FormSet из двух форм. Первая форма содержит данные о клиентах таблицы customer, а вторая — итоговую сумму покупок клиентов. Для создания набора форм выполните следующие действия: 
</P>
<ol>
  <li>Откройте проект Sales. </li>
  <li>Откройте окно конструктора для создания новой формы. </li>
  <li>Выберите в меню Form (Форма) команду Create Form Set (Создать набор форм). 
  </li>
  <li>Откройте окно Data Environment (Среда окружения) и добавьте в окружение таблицу customer и представление данных sumcust, содержащее сведения об итоговой стоимости покупок клиентов. 
  </li>
  <li>Скорректируйте свойство caption (Надпись) для первой формы, введя заголовок Клиенты. 
  </li>
  <li>В форме создайте объект Grid (Таблица), разместив в нем необходимые поля таблицы Customer. 
  </li>
  <li>Для добавления второй формы выполните команду Add New Form (Добавить новую форму) из меню Form (Форма). В окне конструктора форм откроется вторая форма. 
  </li>
  <li>Скорректируйте свойство caption (Надпись) для второй формы, введя заголовок Итоговые суммы покупок, 
  </li>
  <li>Во второй форме создайте объект Grid (Таблица), разместив в нем поля представления данных Sumcust. 
  </li>
</ol>
<IMG src="gl15-24.jpg" alt="gl15-24.jpg" width="500" height="380" ></IMG>
<P>
Рис. 15.23. Просмотр набора форм 
</P>
<ol>
  <li value="10">Расположите формы на экране таким образом, чтобы они были удобны для поочередного просмотра. 
  </li>
  <li>Сохраните созданную форму, нажав кнопку Save (Сохранить) на стандартной панели инструментов. 
  </li>
  <li>Запустите форму на выполнение. </li>
  <li>На экране открывается две формы (рис. 15.23). Просмотрев данные в первой форме, перейдите во вторую форму. Для этого активизируйте ее, щелкнув мышью в любом ее месте. Во второй форме вы можете просмотреть итоговые суммы покупок интересующего вас клиента. 
  </li>
</ol>
<p>&nbsp;
<a NAME="8"></a><font size="4">Таймер </font> 
</P>
<P>
В Visual FoxPro существует объект, обрабатывающий данные системных часов, называемый таймером. Его можно использовать для отображения в форме системных часов, а также для выполнения определенных действий через заданный интервал времени. Например, используя объект данного типа, можно обновлять данные в таблицах. 
</P>
<P>
Для размещения в форме таймера используется кнопка Timer (Таймер) на панели инструментов Form Controls (Элементы управления формы). Объект данного типа обладает свойствами, описанными в табл. 15.4. 
</P>
<P>
Таблица 15.4. Назначение свойств объекта Timer 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Свойство 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Interval (Интервал) 
</TD>
<TD VALIGN="TOP">
Интервал активизации объекта в миллисекундах 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Enabled (Доступно) 
</TD>
<TD VALIGN="TOP">
Устанавливает режим работы таймера. Если значение свойства равно True (Истина), то таймер начинает отсчитывать время сразу же после запуска формы. В противном случае вы должны запустить таймер по какому-либо внешнему событию (например, при нажатии на кнопку) 
</TD>
</TR>
</TABLE>
<P>
Помимо вышеперечисленных свойств, для объекта Timer (Таймер) определяется событие Timer (Таймер), наступающее через каждый установленный в свойстве interval (Промежуток времени) промежуток времени. В процедуре обработки данного события необходимо определить действия, выполняемые с заданным интервалом. 
</P>
<P>
Для запуска таймера используется метод Reset (Установить), не связанный с каким-либо событием. Поэтому вы должны выполнить его при наступлении каких-либо других событий, например, при нажатии кнопки запуска таймера. 
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">Создание формы с использованием таймера </font> 
</P>
<P>
Рассмотрим пример использования таймера в форме, в которой через заданный интервал времени на экран будут выводиться данные о количестве продаж каждого товара на текущий момент времени. Форма будет отображать информацию из представления данных, содержащего наименование товара, суммарное количество проданного товара и сумму продаж по товару: 
</P>
<ol>
  <li>В Проекте Sales, ИСПОЛЬЗУЯ таблицы Goods, Ordsaled и Ordsalem, создайте представление данных, содержащее наименование товара, суммарное количество проданного товара и суммы продаж по данному товару. 
  </li>
  <li>Сгруппируйте данные по коду товара. </li>
  <li>Сохраните созданное представление данных. </li>
  <li>Откройте новое окно конструктора форм. </li>
  <li>Откройте окно среды окружения формы и добавьте в него созданное представление. 
  </li>
  <li>Создайте в форме объект Grid (Таблица), разместив в нем все поля представления данных. 
  </li>
  <li>Для отображения текущей даты и времени расположите два поля ввода curdate и curtime. Скорректируйте для данных объектов свойство Readonly (Только чтение), установив значение True (Истина). 
  </li>
  <li>Для создания объекта-таймера нажмите кнопку Timer (Таймер) на панели инструментов Form Controls (Элементы управления формы) и расположите его в форме. 
  </li>
  <li>Откройте окно процедур для метода Timer (Таймер). </li>
  <li>Для присвоения значений созданным полям curdate и curtime, а также для обновления данных о продаже товаров через заданный интервал времени введите в окне процедур следующие значения: 
<P>
 This.Parent.CurDate.Value = DATE() 
</P>
<P>
 This. Parent.CurTime.Value = TIME()</P>
<P>
 This.Parent.CurDate.Refresh() 
</P>
<P>
 This.Parent.CurTime.Refresh() 
</P>
<P>
 ThisForm.Gridl.Refresh() 
</P>
<P>
 &nbsp;</P>
  </li>
  <li>Определите интервал времени, через который необходимо производить обновление данных в таблице. Для этого воспользуйтесь свойством interval (Промежуток времени), значение которого задается в миллисекундах. Для обновления данных каждые 10 мин введите значение 600 000. 
  </li>
  <li>Форма готова. Сохраните ее и запустите на выполнение. </li>
</ol>
<IMG src="gl15-25.jpg" alt="gl15-25.jpg" width="500" height="375" ></IMG>
<P>
Рис. 15.24. Использование таймера в форме 
</P>
<IMG src="gl15-26.jpg" alt="gl15-26.jpg" width="500" height="375" ></IMG>
<P>
Рис. 15.25. Просмотр итоговых продаж через заданный промежуток времени 
</P>
<P>
При работе в сети каждый час на экране будет обновляться информация об итоговом количестве продаж товаров и их стоимости. На рис. 15.24 показан вид созданной формы, а на рис. 15.25 — просмотр данных с помощью этой формы. 
</P>
<p>&nbsp;
<a NAME="10"></a><font size="4">Добавление данных в список </font> 
</P>
<P>
В главе 6 мы рассматривали использование объектов типа ListBox (Список), которые значительно облегчают ввод данных в поля, одновременно избавляя от дополнительных ошибок, которые могут возникнуть при вводе. Список может формироваться из значений, содержащихся в поле таблицы, массива, запроса и т. п. В этой главе рассмотрим создание списка, значения которого вводятся в интерактивном режиме пользователем с использованием дополнительного поля ввода. 
</P>
<P>
Создание списка рассмотрим на примере редактирования поля, содержащего город, для таблицы Customer. Для создания формы: 
</P>
<ol>
  <li>Откройте форму для ввода списка клиентов в окне конструктора форм. </li>
  <li>Нажмите кнопку List Box (Список) на панели инструментов Form Controls (Элементы управления формы). 
  </li>
  <li>Установите указатель мыши на место предполагаемого расположения поля и, удерживая кнопку мыши в нажатом состоянии, переместите курсор по диагонали так, чтобы получилась рамка требуемого размера для поля списка. 
  </li>
  <li>Откройте окно свойств для размещенного в форме списка. </li>
  <li>Скорректируйте свойство Name (Имя) созданного объекта, присвоив ему имя IstCity. 
  </li>
  <li>Чтобы связать созданное поле с полем таблицы customer, выберите свойство controisource (Источник данных). В поле ввода значения свойства воспользуйтесь кнопкой раскрытия списка и из списка всех полей открытой таблицы Customer выберите поле ccity. 
  </li>
  <li>Скорректируйте свойство RowSourceType (Тип источника данных), которое указывает тип источника данных. Выберите из списка значение Value (Значение), поскольку список городов будет формироваться с помощью вводимых значений. 
  </li>
  <li>Используя кнопку Text Box (Поле ввода) на панели инструментов Form Controls (Элементы управления формы), создайте под списком поле редактирования. 
  </li>
  <li>Скорректируйте свойство Name (Имя) поля редактирования, присвоив ему имя txtAddText. 
  </li>
  <li>Используя окно процедур свойства Keypress (Нажатие клавиши), введите в нем следующие команды: 
  </li>
</ol>
<blockquote>
<P>
 LPARAMETERS nKeyCode, nShiftCtrlAlt 
</P>
<P>
 IF nKeyCode = 13 &amp;&amp; 13 код клавиши &lt;Enter&gt; 
</P>
<P>
 IF 1EMPTY(THIS,Value) 
</P>
<P>
 * добавляем значение в список 
</P>
<P>
 THISFORM.lstCity.Addltem (THIS.Value} 
</P>
<P>
 ENDIF 
</P>
<P>
 * очищаем поле ввода 
</P>
<P>
 THIS.Value = &quot;&quot; 
</P>
<P>
 ENDIF 
</P>
<P>
Эта процедура позволит пользователю ввести текст в поле ввода и нажатием клавиши &lt;Enter&gt; добавить значение в список, освободив окно для ввода следующей информации (рис. 15.26). 
</P>
</blockquote>
<IMG src="gl15-27.jpg" alt="gl15-27.jpg" width="500" height="363" ></IMG>
<P>
Рис. 15.26. Определение свойства KeyPress 
</P>
<P>
Теперь при запуске формы на выполнение значения, введенные в поле ввода Поле формирования списка, при нажатии клавиши &lt;Enter&gt; переносятся в список городов (рис. 15.27). 
</P>
<IMG src="gl15-28.jpg" alt="gl15-28.jpg" width="500" height="446" ></IMG>
<P>
Рис. 15.27. Формирование списка с помощью поля ввода в диалоговом режиме 
</P>
</BODY>
</HTML>