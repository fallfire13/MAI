<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 8 
<br>
Создание отчета с помощью конструктора отчетов</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl8.html#1">Окно конструктора отчетов </a>
  <li><a href="gl8.html#2">Типы полос окна конструктора отчета</a>
  <li><a href="gl8.html#3">Использование команды Quick Report для размещения полей </a>
  <li><a href="gl8.html#4">Установка среды окружения отчета</a>
  <li><a href="gl8.html#5">Размещение объектов в отчете</a>
  <li><a href="gl8.html#6">Размещение в отчете текстовой информации</a>
  <li><a href="gl8.html#7">Добавление в отчет областей заголовка и итогов</a>
  <li><a href="gl8.html#8">Создание простого отчета</a>
  <li><a href="gl8.html#9">Размещение полей</a>
  <li><a href="gl8.html#10">Размещение в отчете линий и прямоугольников</a>
  <li><a href="gl8.html#11">Панель инструментов Color Palette</a>
  <li><a href="gl8.html#12">Размещение в отчете рисунков</a>
  <li><a href="gl8.html#13">Создание отчета в свободной форме </a>
  <li><a href="gl8.html#14">Создание табличного отчета</a>
  <li><a href="gl8.html#15">Группировка данных в отчете</a>
  <li><a href="gl8.html#16">Использование группировки в отчете</a>
  <li><a href="gl8.html#17">Использование в отчете переменных</a>
  <li><a href="gl8.html#18">Разметка страницы отчета</a>
  <li><a href="gl8.html#19">Создание многоколоночного отчета</a>
</ul>
<P>
В предыдущей главе мы рассмотрели создание отчета с помощью мастера. В процессе использования отчета практически всегда возникает необходимость его модификации. Создавать сложные отчеты с помощью мастера не удается. И в этих случаях вам не обойтись без конструктора отчетов. 
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Окно конструктора отчетов </font> 
</P>
<P>
Существует несколько различных вариантов открытия окна конструктора отчетов. Если вы хотите модифицировать ранее созданный отчет, то в окне проекта установите курсор на его названии и нажмите кнопку Modify (Модификация). 
</P>
<P>
Для открытия окна конструктора отчетов при создании нового отчета выполните одно из следующих действий. 
</P>
<ul>
  <li>В меню File (Файл) выберите команду New (Новый). В открывшемся диалоговом окне New (Новый) выберите опцию Report (Отчет) и нажмите кнопку New file (Новый файл). 
  </li>
  <li>Нажмите кнопку New (Новый) в окне проекта, предварительно выбрав группу Reports (Отчеты). 
  </li>
  <li>Нажмите кнопку New (Новый) на стандартной панели инструментов; в открывшемся диалоговом окне New (Новый) установите опцию Report (Отчет) и нажмите кнопку New file (Новый файл). 
  </li>
</ul>
<P>
Для работы в конструкторе отчетов используются панели инструментов Report Designer (Конструктор отчета) и Report Controls (Элементы управления отчета), а также команды пункта Report (Отчет) (рис. 8.1), появившегося в строке основного меню при открытии конструктора. 
</P>
<P>
В табл. 8.1 приведено краткое описание кнопок панели инструментов Report Controls (Элементы управления отчета). Более подробно назначение кнопок этой панели будет рассмотрено в разделах, посвященных размещению в отчетах различных элементов управления. 
</P>
<IMG src="gl8-1.jpg" alt="gl8-1.jpg" width="500" height="390" ></IMG>
<P>
Рис. 8.1. Окно конструктора отчета 
</P>
<P>
Таблица 8.1. Кнопки панели инструментов Report Controls 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Наименование 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/110.jpg" width="11" height="17"></TD>
<TD VALIGN="TOP">
Select Objects (Выбор объектов) 
</TD>
<TD VALIGN="TOP">
Является указателем выбора объектов отчета 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/111.jpg" width="18" height="16"></TD>
<TD VALIGN="TOP">
Label (Метка) 
</TD>
<TD VALIGN="TOP">
Размещает текст 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/112.jpg" width="18" height="15"></TD>
<TD VALIGN="TOP">
Field (Поле) 
</TD>
<TD VALIGN="TOP">
Размещает поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/113.jpg" width="16" height="15"></TD>
<TD VALIGN="TOP">
Line (Линия) 
</TD>
<TD VALIGN="TOP">
Рисует линии 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/114.jpg" width="17" height="15"></TD>
<TD VALIGN="TOP">
Rectangle (Прямоугольник) 
</TD>
<TD VALIGN="TOP">
Рисует прямоугольники 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/115.jpg" width="17" height="15"></TD>
<TD VALIGN="TOP">
Rounded Rectangle (Скругленный прямоугольник) 
</TD>
<TD VALIGN="TOP">
Рисует прямоугольник со скругленными краями 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/116.jpg" width="17" height="17"></TD>
<TD VALIGN="TOP">
Picture/Act! vX Bound Control 
</P>
<P>
(Изображение/Ас1!уХ-объект) 
</TD>
<TD VALIGN="TOP">
Помещает в отчет рисунок 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/117.jpg" width="11" height="14"></TD>
<TD VALIGN="TOP">
Button Lock (Закрепитель кнопки) 
</TD>
<TD VALIGN="TOP">
Закрепляет выбор кнопки 
</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="2"></a><font size="4">Типы полос окна конструктора отчета </font> 
</P>
<P>
Вся рабочая область конструктора отчетов по умолчанию разделена на три полосы, ограничиваемые разделительными строками (см. рис. 8.1). Наименование полосы отображается на разделительной строке, находящейся непосредственно под этой полосой. При использовании в отчете группирования данных, добавлении в него титульной страницы и итоговых данных появляются дополнительные полосы. Каждая полоса может содержать элементы управления отчета, такие как текст, табличные и вычисляемые поля, линии, прямоугольники, рисунки. 
</P>
<P>
Типы возможных в отчете полос приведены в табл. 8.2. Основное назначение полосы — определять, когда и где будут печататься размещенные в полосе объекты. 
</P>
<P>
Таблица 8.2. Типы полос отчета 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Полоса 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Title (Титул) 
</TD>
<TD VALIGN="TOP">
В  этой  полосе  размещается  информация,   появляющаяся перед основным отчетом и называемая титульной. Это может быть имя отчета, сопроводительное письмо или любые данные, которые необходимо поместить на первой странице отчета 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Page Header 
</P>
<P>
(Верхний колонтитул) 
</TD>
<TD VALIGN="TOP">
Эта полоса в отчете называется верхним колонтитулом. Данные,  помещенные в полосу, печатаются в начале каждой страницы. Примерами элементов управления могут быть название отчета, текущая дата, номер страницы и т. д. 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Group Header 
</P>
<P>
(Группа сверху) 
</TD>
<TD VALIGN="TOP">
В этой полосе печатается информация, используемая при группировке. При группировке данных группа может иметь верхние полосы, печатаемые до нее. Они помогают идентифицировать информацию, содержащуюся на каждом уровне группировки 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Detail (Детали) 
</TD>
<TD VALIGN="TOP">
Эта полоса содержит данные полей из таблицы или результат вычислений над ними 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Group Footer 
</P>
<P>
(Группа снизу) 
</TD>
<TD VALIGN="TOP">
В полосе размещается итоговая информация по группе 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Page Footer (Нижний колонтитул) 
</TD>
<TD VALIGN="TOP">
В  нижнем  колонтитуле  печатается  название  отчета,  дата, номер страницы и итоговые значения по данным текущей страницы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Summary (Итоги) 
</TD>
<TD VALIGN="TOP">
В итоговой части отчета содержится информация, появляющаяся один раз после основного отчета и содержащая итоговые значения или заключительный текст 
</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="3"></a><font size="4">Использование команды Quick Report для размещения полей </font> 
</P>
<P>
В процессе создания отчета выполняются все или часть из приведенных ниже процедур: 
</P>
<ul>
  <li>определение среды окружения; </li>
  <li>размещение объектов в отчете: текста, полей, линий, прямоугольников и рисунков; 
  </li>
  <li>группирование данных в отчете; </li>
  <li>сохранение отчета; </li>
  <li>просмотр созданного отчета в окне предварительного просмотра; </li>
  <li>печать отчета. </li>
</ul>
<P>
Ускорить размещение данных в отчете можно с помощью команды Quick Report (Быстрый отчет) из меню Report (Отчет). Отчет, получаемый в результате выполнения этой команды<SUB>г</SUB> называется быстрым или стандартным отчетом. Иными словами, Quick Report (Быстрый отчет) — это средство конструктора отчетов, которое автоматически помещает выбранные поля и надписи к ним в окно конструктора отчета. После этого вы можете модифицировать полученный отчет, изменив текст надписей, порядок расположения полей, добавить в отчет группирование данных, заголовок и т. д. 
</P>
<P>
Для создания отчета с использованием команды Quick Report (Быстрый отчет) необходимо выполнить следующие действия: 
</P>
<ol>
  <li>Откройте базу данных проекта. Для этого на вкладке Data (Данные) установите курсор на ее название и нажмите кнопку Open (Открыть) окна проекта. При этом на стандартной панели инструментов в списке Databases (Базы данных) появится название открытой базы данных. 
  </li>
  <li>Откройте любым удобным для вас способом окно конструктора отчетов. </li>
  <li>Находясь в окне конструктора отчета, выберите в меню Report (Отчет) команду Quick Report (Быстрый отчет). 
  </li>
  <li>В открывшемся диалоговом окне Open (Открыть) содержится список всех таблиц открытой в проекте базы данных (рис. 8.2). Выберите таблицу, для которой создается стандартный отчет, и нажмите кнопку ОК. 
  </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Если перед созданием отчета вы не откроете базу данных, то на экране появится диалоговое окно Open (Открыть), отличающееся от представленного на рис. 8.2. Оно будет содержать не список таблиц базы данных, а окно, открывающееся в программе FoxPro для поиска на диске необходимого файла.
</font> 
</P>
<IMG src="gl8-2.jpg" alt="gl8-2.jpg" width="247" height="228" ></IMG>
<P>
Рис. 8.2. Диалоговое окно Open 
</P>
<ol>
  <li value="5">После выбора таблицы открывается диалоговое окно Quick Report (Быстрый отчет) (рис. 8.3), в котором предлагаются варианты расположения полей в отчете — в столбец или в строку (две кнопки). Выберите один из предложенных вариантов: 
  </li>
</ol>
<ul>
  <li>при нажатии левой кнопки поля будут размещены в полосе Detail (Детали) слева направо по всей странице; 
  </li>
  <li>если вы нажмете правую кнопку, поля будут размещены в полосе Detail (Детали) друг под другом. 
  </li>
</ul>
<blockquote>
<P>
Диалоговое окно Quick Report (Быстрый отчет) содержит флажки, описанные в табл. 8.3. 
</P>
</blockquote>
<P>
Таблица 8.3. Флажки диалогового окна Quick Report 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Флажок 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Titles (Заголовки) 
</TD>
<TD VALIGN="TOP">
При установке флажка в отчет помещаются поля и надписи к ним 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Add Alias (Добавить псевдоним) 
</TD>
<TD VALIGN="TOP">
Флажок определяет, указывать ли псевдоним таблицы в именах полей в окне конструктора отчета 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Add Table to Data Environment 
</P>
<P>
(Добавить таблицу в среду окружения) 
</TD>
<TD VALIGN="TOP">
При установке флажка используемая в отчете таблица помещается в среду окружения 
</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl8-3.jpg" alt="gl8-3.jpg" width="296" height="210" ></IMG> </p>
<P>
Рис. 8.3. Диалоговое окно Quick Report 
</P>
<ol>
  <li value="6">Если вы хотите разместить в отчете все поля исходной таблицы, то этот шаг пропустите и сразу нажмите кнопку ОК, чтобы закрыть диалоговое окно Quick Report (Быстрый отчет). Для выбора полей, размещаемых в отчете, нажмите кнопку Fields (Поля). Откроется диалоговое окно Field Picker (Выбор поля) (рис. 8.4). Выберите поля, которые вы собираетесь поместить в отчет, используя для этого кнопку Move (Переместить). Если в отчет нужно поместить все поля, воспользуйтесь кнопкой All (Все). 
  </li>
</ol>
<IMG src="gl8-4.jpg" alt="gl8-4.jpg" width="391" height="221" ></IMG>
<P>
Рис. 8.4. Диалоговое окно Field Picker 
</P>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Если вам нужно разместить в отчете все поля за исключением нескольких, сначала выберите все поля, а затем удалите лишние, воспользовавшись кнопкой Remove (Удалить).
</font> 
</P>
<ol>
  <li value="7">Завершив выбор полей, нажмите кнопку ОК для закрытия диалогового окна Field Picker (Выбор поля). Нажмите также кнопку ОК в окне Quick Report (Быстрый отчет). Теперь отчет содержит все необходимые поля. Кроме того, в полосе Page Footer (Нижний колонтитул) расположено поле с функцией DATE () и поле с системной переменной _PAGENO, указывающие дату и текущий номер страницы отчета соответственно. 
  </li>
</ol>
<P>
Фрагмент  отчета,   сформированного  с   помощью  команды   Quick   Report&nbsp;
(Быстрый отчет), представлен на рис. 8.5. 
</P>
<P>
Если текст и наименования полей в отчете представлены некорректно, необходимо изменить шрифт этих объектов. Для этого выполните следующие действия: 
</P>
<ol>
  <li>1. Выделите все объекты отчета, воспользовавшись командой Select All (Выбрать все) из меню Edit (Правка). 
  </li>
  <li>2. Откройте диалоговое окно Шрифт (рис. 8.6). Для этого в меню Format (Формат) выберите команду Font (Шрифт). 
  </li>
</ol>
<IMG src="gl8-5.jpg" alt="gl8-5.jpg" width="500" height="390" ></IMG>
<P>
Рис. 8.5. Фрагмент отчета, созданного с помощью команды Quick Report 
</P>
<IMG src="gl8-6.jpg" alt="gl8-6.jpg" width="462" height="345" ></IMG>
<P>
Рис. 8.6. Диалоговое окно Шрифт 
</P>
<ol>
  <li value="3">Используя список Шрифт диалогового окна Выбор шрифта, установите необходимый шрифт. 
  </li>
  <li>Задайте начертание, стиль, цвет и размер символов выделенных объектов. 
  </li>
  <li>Завершив установку параметров, нажмите кнопку ОК для закрытия диалогового окна. 
  </li>
  <li>Щелкните мышью в любом месте отчета вне выделенной области. </li>
</ol>
<p>&nbsp;
<a NAME="4"></a><font size="4">Установка среды окружения отчета </font> 
</P>
<P>
Для отчета, созданного мастером или с помощью команды Quick Report (Быстрый отчет), среда окружения отчета уже определена. Разработчику, создающему отчет с помощью конструктора отчетов, среду окружения необходимо сформировать, выполнив для этого следующие действия: 
</P>
<ol>
  <li>Разместить в окружении используемые в отчете таблицы. </li>
  <li>Установить для таблиц необходимые индексы. </li>
  <li>Установить отношения между таблицами. </li>
</ol>
<P>
Вся относящаяся к среде окружения информация хранится в файле описания отчета. 
</P>
<IMG src="gl8-7.jpg" alt="gl8-7.jpg" width="500" height="390" ></IMG>
<P>
Рис. 8.7. Диалоговое окно Data Environment  Report Designer 
</P>
<P>
Для формирования среды окружения отчета используется окно Data Environment  Report Designer (Среда окружения  Конструктор отчета) (рис. 8.7), для открытия которого можно воспользоваться одним из следующих способов. 
</P>
<ul>
  <li>В меню View (Вид) выбрать команду Data Environment (Среда окружения). 
  </li>
  <li>Выбрать пункт Data Environment (Среда окружения) контекстного меню. </li>
  <li>В среде окружения необходимо разместить все таблицы, используемые в отчете. Для добавления таблицы в окружение используется команда Add (Добавить) контекстного меню или команда Add (Добавить) из меню Data Environment (Среда окружения). Связанные таблицы базы данных переносятся в Environment  Report Designer (Среда окружения  Конструктор отчета) с сохранением связей, установленных между ними. 
  </li>
</ul>
<P>
После размещения таблиц в среде окружения отчета вам необходимо упорядочить данные, находящиеся в таблицах. Для этого выполните следующие действия: 
</P>
<ol>
  <li>Выделите таблицу, в которой хотите упорядочить данные. </li>
  <li>Откройте окно свойств таблицы. Для этого установите на нее курсор, нажмите правую кнопку мыши и выберите в появившемся контекстном меню команду Properties (Свойства). 
  </li>
  <li>Выделите свойство order (Порядок) (рис. 8.8). </li>
</ol>
<IMG src="gl8-8.jpg" alt="gl8-8.jpg" width="500" height="427" ></IMG>
<P>
Рис. 8.8. Свойство Order используется для упорядочения записей в таблице 
</P>
<ol>
  <li value="4">В поле коррекции свойства нажмите кнопку раскрытия списка. Из списка индексов таблицы выберите тот, по которому хотите упорядочить данные в отчете. 
  </li>
</ol>
<P>
Если в отчете используется несколько связанных таблиц, то вам необходимо убедиться, что связи установлены так, как требуется для создания правильного отчета. Для этого выполните следующие действия: 
</P>
<ol>
  <li>Выделите линию, соединяющую таблицы. При этом в окне свойств Properties (Свойства) будут отображаться свойства, характеризующие установленную между таблицами связь. 
  </li>
  <li>Проверьте, какая из таблиц является родительской, а какая дочерней по отношению к ней. Для этого просмотрите свойства chiidAlias (Дочерняя таблица) и ParentAiias (Родительская таблица). 
  </li>
  <li>Посмотрите выражение, по которому связаны таблицы. Для этого воспользуйтесь свойством ReiationalExpr (Выражение отношения). 
  </li>
</ol>
<P>
После размещения в окне Data Environment (Среда окружения) всех используемых в отчете таблиц, закройте его, после чего Visual FoxPro сохранит созданную вами среду окружения. 
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Размещение объектов в отчете </font> 
</P>
<P>
Любой отчет состоит из объектов: пояснительного текста, полей отчета, разделительных линий и рамок. 
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Размещение в отчете текстовой информации </font> 
</P>
<P>
Размещаемый в отчете текст является объектом, который можно выделять, перемещать, изменять его размеры, используя для этого маркеры выделения, сохранять во временном буфере Windows, копировать из буфера или удалять. 
</P>
<P>
Для ввода или редактирования текста в отчете выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку Label (Метка) на панели инструментов Report Controls
(Элементы управления отчета). </li>
  <li>Щелкните мышью в том месте окна конструктора отчета, где необходимо разместить или исправить текст. 
  </li>
  <li>Внесите необходимые добавления или изменения. </li>
  <li>Нажмите кнопку Select Objects (Выбор объектов) на панели инструментов Report Controls (Элементы управления отчета). 
  </li>
</ol>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Текст может состоять из нескольких строк. Для переноса части текста на новую
строку используйте клавишу &lt;Enter&gt;. </font> 
</P>
<P>
Для размещенного в отчете текста можно изменять параметры используемого шрифта и цвет, выполнив следующие действия: 
</P>
<ol>
  <li>Используя мышь, выделите текстовый объект. </li>
  <li>В меню Format (Формат) выберите команду Font (Шрифт). </li>
  <li>В открывшемся диалоговом окне Шрифт установите начертание, стиль, цвет и размер символов выделенного текста. Вид выбранного шрифта просмотрите в области Образец этого же диалогового окна. 
  </li>
  <li>Завершив установку параметров, нажмите кнопку ОК. Если дважды щелкнуть на текстовом объекте, откроется диалоговое окно Text (Текст) (рис. 8.9), в котором можно определить условия печати текста, его расположение в полосе, а также разместить комментарии. 
  </li>
</ol>
<IMG src="gl8-9.jpg" alt="gl8-9.jpg" width="351" height="234" ></IMG>
<P>
Рис. 8.9. Диалоговое окно Text 
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Добавление в отчет областей заголовка и итогов </font> 
</P>
<P>
Как правило, все отчеты содержат заголовок и итоговую часть отчета. Для их формирования необходимо добавить в отчет полосы Summary (Итоги) и Title (Титул), используя команду Title/Summary (Титул/Итоги) из меню Report (Отчет). В результате выполнения этой команды открывается диалоговое окно Title/Summary (Титул/Итоги), содержащее флажки, приведенные в табл. 8.10. 
</P>
<P>
Таблица 8.4. Кнопки панели инструментов Report Controls 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Флажок 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Title band (Полоса титула) 
</TD>
<TD VALIGN="TOP">
Добавляет в отчет полосу Title (Титул) для размещения заголовка в отчете 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
New page (Новая страница) области Report title (Титул отчета) 
</TD>
<TD VALIGN="TOP">
Размещает заголовок отчета на отдельной странице 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Summary band (Полоса итогов) 
</TD>
<TD VALIGN="TOP">
Добавляет в отчет полосу Summary (Итоги) для размещения в отчете итоговой части 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
New page (Новая страница) области Report summary 
</P>
<P>
(Итоги отчета) 
</TD>
<TD VALIGN="TOP">
Размещает итоговую часть отчета на отдельной странице 
</TD>
</TR>
</TABLE>
<P>
Установите необходимые флажки и нажмите ОК. В отчете появятся указанные вами полосы. В полосе Title (Титул) разместите объекты заголовка отчета, в качестве которых может выступать текст, поля и рисунки. 
</P>
<IMG src="gl8-10.jpg" alt="gl8-10.jpg" width="206" height="190" ></IMG>
<P>
Рис. 8.10. Диалоговое окно Title/Summary 
</P>
<P>
В полосе Summary (Итоги) могут размещаться итоговые значения полей отчета, а также объекты оформления отчета, такие как текст и рисунки. 
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Создание простого отчета </font> 
</P>
<P>
Мы рассмотрели основные действия, необходимые для создания простого отчета с помощью конструктора отчетов. Теперь, подводя итоги, рассмотрим последовательность действий по созданию отчета для таблицы customer, содержащей список клиентов. 
</P>
<ol>
  <li>Откройте проект Sales. </li>
  <li>Откройте базу данных проекта. Для этого на вкладке Data (Данные) установите курсор на названии базы данных и нажмите кнопку Open (Открыть) окна проекта. При этом на стандартной панели инструментов в списке Databases (Базы данных) появляется название открытой базы данных. 
  </li>
  <li>Перейдите на вкладку Documents (Документы), выберите группу Reports (Отчеты) и нажмите кнопку New (Новый). 
  </li>
  <li>В открывшемся диалоговом окне New Report (Новый отчет) выберите опцию New Report (Новый отчет). Открывается окно конструктора, предназначенное для создания нового отчета. 
  </li>
  <li>Для задания среды окружения отчета откройте диалоговое окно Data Environment (Среда окружения), выбрав команду Environment (Окружение) в меню View (Вид) или Data Environment (Среда окружения) контекстного меню. 
  </li>
  <li>Для добавления таблицы в окружение отчета в меню Data Environment (Среда окружения) выберите команду Add (Добавить). 
  </li>
  <li>В открывшемся диалоговом окне Add Table or View (Добавить таблицу или представление) выберите таблицу customer и нажмите кнопку ОК. В окне Data Environment (Среда окружения) будет отображена выбранная таблица. 
  </li>
  <li>Откройте окно свойств таблицы. Для этого установите курсор на ее названии, нажмите правую кнопку мыши и выберите из контекстного меню команду Properties (Свойства). 
  </li>
  <li>Выделите свойство order (Порядок). Для упорядочения данных в отчете по кодам клиентов в поле коррекции свойства нажмите кнопку раскрытия списка и из списка индексов таблицы выберите icdcustomer. 
  </li>
  <li>Закройте окно Data Environment (Среда окружения). </li>
  <li>Для размещения полей таблицы в отчете воспользуйтесь командой Quick Report (Быстрый отчет) в меню Report (Отчет). Открывается диалоговое окно Quick Report (Быстрый отчет). 
  </li>
  <li>Выберите вариант размещения полей по столбцам и нажмите кнопку Fields (Поля). 
  </li>
  <li>В диалоговом окне Field Picker (Выбор поля) выберите поля, помещаемые в отчет, и перенесите их в список Selected fields (Выбранные поля), используя кнопку Move (Перенести). Нажмите кнопку ОК. 
  </li>
  <li>Возвратившись в диалоговое окно Quick Report (Быстрый отчет), нажмите кнопку ОК для завершения процедуры размещения полей в отчете. 
  </li>
  <li>Используя кнопку Label (Метка) панели инструментов Report Controls
(Элементы управления отчета), скорректируйте заголовки полей. </li>
  <li>Для того чтобы придать отчету законченный вид, добавьте область заголовка отчета, выбрав в меню Report (Отчет) команду Title/Summary
(Титул/Итоги). </li>
  <li>В открывшемся диалоговом окне Title/Summary (Титул/Итоги) установите флажок 
Title Band (Полоса титула) и нажмите ОК. В отчете появляется полоса Title (Титул). Разместите в ней текст заголовка отчета с помощью кнопки Label (Метка) панели инструментов Report Controls (Элементы управления отчета). 
  </li>
</ol>
<IMG src="gl8-11.jpg" alt="gl8-11.jpg" width="500" height="410" ></IMG>
<P>
Рис. 8.11. Список клиентов 
</P>
<ol>
  <li value="18">Просмотрите внешний вид отчета (рис. 8.11), воспользовавшись командой контекстного меню Preview (Просмотр). 
  </li>
  <li>Сохраните отчет. </li>
</ol>
<p>&nbsp;
<a NAME="9"></a><font size="4">Размещение полей </font> 
</P>
<P>
Для размещения в отчете поля, которое может быть полем таблицы или вычисляемым полем, выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку Field (Поле) на панели инструментов Report Controls (Элементы управления отчета). 
  </li>
  <li>Щелкните мышью в месте предполагаемого размещения поля в окне конструктора отчета. 
  </li>
  <li>В открывшемся диалоговом окне Report Expression (Выражение отчета) (рис. 8.12) укажите для поля источник данных, формат, условие, при котором поле будет выводиться на печать. 
  </li>
  <li>Завершив установку параметров, нажмите кнопку ОК. </li>
</ol>
<IMG src="gl8-12.jpg" alt="gl8-12.jpg" width="396" height="309" ></IMG>
<P>
Рис. 8.12. Диалоговое окно Report Expression 
</P>
<P>
Диалоговое окно Report Expression (Выражение отчета) позволяет: G определить выражение, результат вычисления которого будет выводиться в данное поле; 
</P>
<ul>
  <li>задать формат отображения данных в поле; </li>
  <li>указать условие печати; </li>
  <li>установить положение поля в отчете. </li>
</ul>
<P>
В поле ввода Expression (Выражение) можно задать поле таблицы или выражение, размещаемое в отчете, а в поле Format (Формат) — формат данных, выводимых на печать. 
</P>
<P>
Используя опции диалогового окна Calculate Field (Вычисляемое поле), открываемого при нажатии кнопки Calculations (Вычисления), можно поместить в отчет статистические значения размещенных в полях данных. Поля данного типа размещаются в отчете, как правило, в колонтитулах, полосах группы и в итоговой части отчета. 
</P>
<P>
Диалоговое окно, открываемое при нажатии кнопки Print When (Условия печати), позволяет задать условия, при которых информация данного поля будет выводиться на печать. 
</P>
<P>
<b>Формирование выражения поля </b> 
</P>
<P>
Чтобы сформировать выражение для поля, размещаемого в отчете, выполните следующие действия: 
</P>
<ol>
  <li>Дважды щелкните мышью на размещенном в отчете поле. Открывается диалоговое окно Report Expression (Выражение отчета) (см. рис. 8.12). 
  </li>
  <li>Введите необходимое выражение в поле Expression (Выражение). Для задания выражения поля вы можете воспользоваться построителем, нажав расположенную справа от поля кнопку. При этом на экране открывается диалоговое окно Expression Builder (Построитель выражения), в поле Expression for Field on Report (Выражение для поля отчета) которого необходимо задать требуемое выражение. 
  </li>
</ol>
<blockquote>
<P>
Список Fields (Поля) диалогового окна Expression Builder (Построитель выражения) содержит поля помещенных в окружение отчета таблиц, список Variables (Переменные) — системные переменные Visual FoxPro. В области Functions (Функции) размещены строковые, логические, математические функции, а также функции даты и времени. Используя значения из этих списков, сформируйте необходимое выражение для создаваемого поля. 
</P>
</blockquote>
<P>
<font color="#800000"><b>Совет</b></font></P>
<P>
<font color="#800000">Для формирования выражения нет необходимости вводить информацию в поле Expression for Field on Report (Выражение для поля отчета) вручную, Достаточно выбирать требуемое значение из любого списка и щелчком мыши переносить его в это поле.
</font> 
</P>
<IMG src="gl8-13.jpg" alt="gl8-13.jpg" width="368" height="359" ></IMG>
<P>
Рис. 8.13. Определение вычисляемого поля 
</P>
<blockquote>
<P>
При создании вычисляемых полей сформируйте выражение и проверьте его правильность с помощью кнопки Verify (Проверить). Например, вы можете отобразить в отчете вместо двух полей, содержащих город и адрес клиента, одно вычисляемое поле, которое содержит полный адрес. Выражение для этого поля имеет следующий вид (рис. 8.13): 
</P>
<P>
 ALLTRIM{Customer.cCity)+&quot;, &quot;+ ALLTRIM(Customer.cAddress) 
</P>
</blockquote>
<ol>
  <li value="3">Завершив формирование выражения, нажмите кнопку OK для закрытия диалогового окна Expression Builder (Построитель выражения). 
  </li>
  <li>Закройте диалоговое окно Report Expression (Выражение отчета), также нажав кнопку ОК. 
  </li>
</ol>
<P>
<b>Задание формата данных </b> 
</P>
<P>
Диалоговое окно Report Expression (Выражение отчета) позволяет задать формат отображения поля при печати, допуская использование тех же функций форматирования, которые используются при форматировании полей формы. С помощью форматирования вы можете: 
</P>
<ul>
  <li>преобразовать весь символьный вывод в прописные буквы; </li>
  <li>выравнивать информацию; </li>
  <li>показывать в числах пробелы и десятичные запятые; </li>
  <li>переводить дату из американского формата в европейский и многое другое. 
  </li>
</ul>
<IMG src="gl8-14.jpg" alt="gl8-14.jpg" width="376" height="250" ></IMG>
<P>
Рис. 8.14. Диалоговое окно Format 
</P>
<P>
Для задания формата поля нажмите кнопку вызова построителя поля Format (Формат). Откроется диалоговое окно Format (Формат) (рис. 8.14), содержащее опции и флажки, позволяющие задать тип данных поля. 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Кнопки вызова построителя всегда располагаются справа от поля ввода.
</font> 
</P>
<P>
Перечень параметров настройки поля определяется выбором соответствующей опции для форматирования полей символьного, числового типов, а также полей дат. Список этих параметров представлен в табл. 8.5—8.7. 
</P>
<P>
Таблица 8.5. Параметры настройки символьных полей 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Параметр 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
То upper case (Верхний регистр) 
</TD>
<TD VALIGN="TOP">
Символы преобразуются в прописные буквы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
SET DATE format (В виде даты) 
</TD>
<TD VALIGN="TOP">
Данные отображаются в виде даты в формате, установленном командой SET   DATE 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Ignore input mask 
</P>
<P>
(Игнорировать маску ввода) 
</TD>
<TD VALIGN="TOP">
Отображает данные  на экране  в  соответствии  с маской ввода 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
British date (Европейская дата) 
</TD>
<TD VALIGN="TOP">
Данные отображаются в виде даты в европейском формате 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Left justify (Сдвинуть влево) 
</TD>
<TD VALIGN="TOP">
Данные выравниваются по левому краю поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Right justify (Сдвинуть вправо) 
</TD>
<TD VALIGN="TOP">
Данные выравниваются по правому краю поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Center justify (По центру) 
</TD>
<TD VALIGN="TOP">
Данные в поле центрируются 
</TD>
</TR>
</TABLE>
<P>
Таблица 8.6. Параметры настройки числовых полей 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Параметр 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Left justify (Сдвинуть влево) 
</TD>
<TD VALIGN="TOP">
Число выравнивается по левому краю поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Blank if zero (Пусто, если ноль) 
</TD>
<TD VALIGN="TOP">
Ноль не печатается 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
(Negative) (Отрицательное) 
</TD>
<TD VALIGN="TOP">
Отрицательные числа заключаются в круглые скобки 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
SET DATE format (В виде даты) 
</TD>
<TD VALIGN="TOP">
Данные отображаются в виде даты в формате, установленном <span lang="ru">
командой</span> SET   DATE 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
British date (Европейская дата) 
</TD>
<TD VALIGN="TOP">
Данные отображаются в виде даты в европейском формате 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
CR if positive (CR, если положительно) 
</TD>
<TD VALIGN="TOP">
Если число положительное, после него ставится CR (кредит) 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
DB if negative (DB, если отрицательно) 
</TD>
<TD VALIGN="TOP">
Если число отрицательное, после него ставится DB (дебет) 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Leading zeros (Незначащие нули) 
</TD>
<TD VALIGN="TOP">
Печатаются все ведущие нули 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Currency (Денежная единица) 
</TD>
<TD VALIGN="TOP">
Данные отображаются в формате денежной единицы, который задается командой SET CURRENCY 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Scientific (Экспоненциально) 
</TD>
<TD VALIGN="TOP">
Отображает число в экспоненциальном формате 
</TD>
</TR>
</TABLE>
<P>
Таблица 8.7. Параметры настройки полей типа &quot;дата&quot; 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Параметр 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
SET DATE format (В виде даты) 
</TD>
<TD VALIGN="TOP">
Дата отображается в формате, установленном командой SET DATE 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
British date (Европейская дата) 
</TD>
<TD VALIGN="TOP">
Дата отображается в европейском формате 
</TD>
</TR>
</TABLE>
<P>
<b>Задание условий печати </b> 
</P>
<P>
Для задания условий печати данных отчета используется диалоговое окно Print When (Условие печати) (рис. 8.15), открываемое из диалогового окна Report Expression (Выражение отчета) нажатием кнопки Print When (Условие печати). С помощью параметров этого окна вы можете удалить из отчета пустые строки, определить условия печати значений полей, при переходе на следующую страницу или при изменении выражения группы и т. п. 
</P>
<IMG src="gl8-15.jpg" alt="gl8-15.jpg" width="277" height="283" ></IMG>
<P>
Рис. 8.15. Диалоговое окно Print When 
</P>
<P>
Для подавления печати повторяющихся значений полей используется значение No (Нет) переключателя Print repeated values (Печатать один раз на полосу). При установленном значении Yes (Да) печатаются все значения поля. 
</P>
<P>
Область Also print (Печатать) содержит флажки (табл. 8.8). 
</P>
<P>
Таблица 8.8. Флажки области Also print 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Флажок 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
In first whole band of new page/column 
</P>
<P>
(На первой целой полосе новой страницы/ колонки) 
</TD>
<TD VALIGN="TOP">
Поле печатается в первой полосе новой страницы или колонки 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
When this group changes (При изменении группы) 
</TD>
<TD VALIGN="TOP">
Поле печатается при изменении группы, выбранной в списке групп 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
When detail overflows to new page/column 
</P>
<P>
(При переходе на новую страницу/колонку) 
</TD>
<TD VALIGN="TOP">
Поле печатается при переходе полосы Detail (Детали) на новую страницу 
</TD>
</TR>
</TABLE>
<P>
При установке флажка Remove line if blank (Удалять пустые строки) пустые строки удаляются из отчета. 
</P>
<P>
В поле Print only when expression is true (Печатать, если истинно), используя построитель выражения, можно задать выражение, вычисляемое перед печатью данного поля. Если значение выражения ложно, то значение поля печататься не будет. 
</P>
<P>
<b>Расположение поля в полосе </b> 
</P>
<P>
Диалоговое окно Report Expression (Выражение отчета) (см. рис. 8.12) содержит переключатель Field position (Положение поля), позволяющий управлять расположением поля в полосе (табл. 8.9). 
</P>
<P>
Таблица 8.9. Опции диалогового окна Report Expression 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Опция 
</TD>
<TD VALIGN="TOP">
Характеристика 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Float (Плавающее) 
</TD>
<TD VALIGN="TOP">
Позиция поля в отчете может изменяться при изменении размеров окружающих его полей 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Fix relative to top of band 
</P>
<P>
(Постоянное относительно верхней полосы) 
</TD>
<TD VALIGN="TOP">
Поле сохраняет постоянную позицию относительно верхней границы полосы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Fix relative to bottom of band 
<P>
(Постоянное относительно нижней полосы) 
</TD>
<TD VALIGN="TOP">
Поле сохраняет постоянную  позицию  относительно нижней границы полосы 
</TD>
</TR>
</TABLE>
<P>
<b>Размещение итогового поля </b> 
</P>
<P>
В колонтитулах, полосах группы, в итоговой части отчета, а также в полосе Detail (Детали) можно размещать поля, содержащие статистические значения полей отчета. 
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Итоговые поля, размещаемые в полосе Detail (Детали), предназначены для вывода значений нарастающих итогов.
</font> 
</P>
<P>
Для определения поля в качестве итогового выполните следующие действия: 
</P>
<ol>
  <li>Откройте диалоговое окно Report Expression (Выражение отчета), дважды щелкнув мышью на поле. 
  </li>
  <li>Определите выражение для поля, введя необходимую информацию в поле Expression (Выражение). 
  </li>
  <li>Нажмите кнопку Calculations (Вычисления). При этом на экране открывается диалоговое окно Calculate Field (Вычисление поля) (рис. 8.16), в котором может быть выбрана математическая операция над значением выражения, определенного для данного поля. 
  </li>
</ol>
<IMG src="gl8-16.jpg" alt="gl8-16.jpg" width="222" height="270" ></IMG>
<P>
Рис. 8.16. Диалоговое окно Calculate Field 
</P>
<blockquote>
<P>
Диалоговое окно Calculate Field (Вычисляемое поле) содержит группу переключателей Calculate, описанную в табл. 8.10. 
</P>
</blockquote>
<P>
Таблица 8.10. Опции диалогового окна Calculate Field 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Переключатель 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Nothing (Ничего) 
</TD>
<TD VALIGN="TOP">
Над полем не производится вычислений 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Count (Сосчитать) 
</TD>
<TD VALIGN="TOP">
Вычисляется количество значений поля (сами значения поля не используются) 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Sum (Сумма) 
</TD>
<TD VALIGN="TOP">
Вычисляется итоговая сумма значений поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Average   (Среднее арифметическое) 
</TD>
<TD VALIGN="TOP">
Вычисляется среднее арифметическое значений поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Lowest<P>
(Наименьшее)</TD>
<TD VALIGN="TOP">
Отображается наименьшее значение поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Highest 
</P>
<P>
(Наибольшее) 
</TD>
<TD VALIGN="TOP">
Отображается наибольшее значение поля 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Standard deviation 
</P>
<P>
(Квадратный корень из дисперсии) 
</TD>
<TD VALIGN="TOP">
Возвращается квадратный корень из дисперсии 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Variance 
</P>
<P>
(Отклонение от среднего) 
</TD>
<TD VALIGN="TOP">
Возвращается статистическая величина отклонения отдельных значений поля от среднего в группе 
</TD>
</TR>
</TABLE>
<ol>
  <li value="4">Установите требуемый переключатель и нажмите кнопку ОК. </li>
</ol>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">В верхней части диалогового окна находится раскрывающийся список Reset (Сброс), используя который, вы можете определить момент обнуления итогового поля.
</font> 
</P>
<ol>
  <li value="5">Нажмите кнопку ОК для закрытия диалогового окна Report Expression
(Выражение отчета). </li>
</ol>
<p>&nbsp;
<a NAME="10"></a><font size="4">Размещение в отчете линий и прямоугольников </font> 
</P>
<P>
Для улучшения внешнего вида отчета и повышения читабельности можно использовать линии и прямоугольники. 
</P>
<P>
Для проведения вертикальной или горизонтальной линии в отчете выполните следующие действия: 
</P>
<ol>
  <li>Нажмите кнопку Line (Линия) на панели Report Controls (Элементы управления отчета) конструктора отчетов. 
  </li>
  <li>Установите указатель в начальную точку линии. </li>
  <li>Нажмите кнопку мыши и, удерживая ее, проведите линию необходимой длины. 
  </li>
  <li>Используя опции команды Реп (Перо) из меню Format (Формат), установите атрибуты линии (толщину и тип). 
  </li>
  <li>Для задания цвета размещенной в отчете линии щелкните мышью на понравившемся цвете цветовой палитры панели Color Palette (Цветовая палитра). 
  </li>
</ol>
<P>
Для размещения в отчете прямоугольника и прямоугольника со скругленными углами 
используются кнопки Rectangle (Прямоугольник) и Rounded Rectangle (Прямоугольник 
со скругленными углами) на панели инструментов Report Controls (Элементы 
управления отчета) конструктора отчетов. Нажмите необходимую кнопку на панели инструментов, установите указатель в какой-либо угол прямоугольника и перемещайте курсор в противоположный угол до получения прямоугольника нужного размера. Затем установите необходимые атрибуты прямоугольника, используя для этого следующие опции команды Реп (Перо) из меню Format (Формат) (табл. 8.11). </P>
<P>
Таблица 8.11. Опции команды Реп из меню Format 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Опция 
</TD>
<TD VALIGN="TOP">
Атрибут объекта 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Hairline (Тонкая линия) 
</TD>
<TD VALIGN="TOP">
Контур шириной в один пиксел 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
1 Point {1 пункт) 
</TD>
<TD VALIGN="TOP">
Контур шириной в один пункт 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
2 Point (2 пункта) 
</TD>
<TD VALIGN="TOP">
Контур шириной в два пункта 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
4 Point (4 пункта) 
</TD>
<TD VALIGN="TOP">
Контур шириной в четыре пункта 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
6 Point (6 пунктов) 
</TD>
<TD VALIGN="TOP">
Контур шириной в шесть пунктов 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
None (Нет) 
</TD>
<TD VALIGN="TOP">
Выделенный объект не имеет контура 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Dotted (Пунктир) 
</TD>
<TD VALIGN="TOP">
Пунктирный контур 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Dashed (Штрих) 
</TD>
<TD VALIGN="TOP">
Контур в виде коротких штрихов 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Dash-dot (Штрих-точка) 
</TD>
<TD VALIGN="TOP">
Контур в виде чередующихся штрихов и точек 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Dash-dot-dot {Штрих-точкаточка) 
</TD>
<TD VALIGN="TOP">
Контур в виде чередующихся штрихов и пар точек 
</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="11"></a><font size="4">Панель инструментов Color Palette </font> 
</P>
<P>
Visual FoxPro предоставляет в распоряжение разработчика средства для изменения цвета размещенных в отчете объектов. Для печати такого отчета вам потребуется цветной принтер. 
</P>
<P>
Для изменения в отчете цвета объекта выполните следующие действия: 
</P>
<ol>
  <li>Разместите на экране панель инструментов Color Palette (Цветовая палитра) 
  выполнив одно из следующих действий: </li>
</ol>
<ul>
  <li>нажав кнопку Color Palette Toolbar (Панель инструментов Цветовая палитра) на панели инструментов Report Designer (Конструктор отчетов); 
  </li>
  <li>выбрав в меню View (Вид) команду Color Palette Tollbar (Панель инструментов Цветовая палитра). 
  </li>
</ul>
<blockquote>
<P>
Панель инструментов Color Palette (Цветовая палитра) (рис. 8.17) содержит шестнадцать кнопок с заданными цветами и три дополнительные кнопки (табл. 8.12). 
</P>
</blockquote>
<P>
Таблица 8.12. Кнопки панели инструментов Color Palette 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Кнопка 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/118.jpg" width="15" height="15"></TD>
<TD VALIGN="TOP">
Задает цвет объекта 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/119.jpg" width="18" height="17"></TD>
<TD VALIGN="TOP">
Задает цвет фона 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
<img border="0" src="../key/120.jpg" width="15" height="15"></TD>
<TD VALIGN="TOP">
Открывает диалоговое окно Цвет для задания цветов, отсутствующих на панели 
</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl8-17.jpg" alt="gl8-17.jpg" width="106" height="169" ></IMG> </p>
<P>
Рис. 8.17. Панель инструментов Color Palette 
</P>
<ol>
  <li value="2">Выберите в отчете объект, цвет которого вы хотите изменить. 
  </li>
  <li>Щелкните мышью на панели инструментов Color Palette (Цветовая палитра) по кнопке Foreground Color (Цвет объекта) или Background Color (Цвет фона) в зависимости от того, что вы хотите поменять, — цвет объекта или его фон. 
  </li>
  <li>Щелкните мышью на панели инструментов по любому понравившемуся цвету. 
  </li>
</ol>
<IMG src="gl8-18.jpg" alt="gl8-18.jpg" width="225" height="322" ></IMG>
<P>
Рис. 8.18. Диалоговое окно Цвет 
</P>
<P>
При создании отчетов можно использовать более широкую цветовую гамму. Для этого необходимо щелкнуть мышью на кнопке Other Colors (Другие цвета) панели инструментов Color Palette (Цветовая палитра) и в открывшемся диалоговом окне Цвет (рис. 8.18) выбрать один из 48 цветов, предлагаемых программой Visual FoxPro или использовать пользовательские цвета, расположенные в области Дополнительные цвета. 
</P>
<P>
Для создания пользовательского цвета, размещаемого в области Дополнительные цвета, выполните следующие действия: 
</P>
<ol>
  <li>В диалоговом окне Цвет нажмите кнопку Определить цвет. Открывается расширенное диалоговое окно Цвет (рис. 8.19). 
  </li>
</ol>
<IMG src="gl8-19.jpg" alt="gl8-19.jpg" width="471" height="322" ></IMG>
<P>
Рис. 8.19. Диалоговое окно Цвет для создания собственного цвета 
</P>
<ol>
  <li value="2">Выберите в правой части окна нужный цвет. Используя поля ввода, расположенные в правом нижнем углу, вы можете также задать параметры цвета с помощью чисел. 
  </li>
  <li>Если вы подобрали необходимый цвет, нажмите кнопку Добавить в набор. Выбранный цвет будет размещен в области Дополнительные цвета. 
  </li>
  <li>Нажмите кнопку ОК. </li>
</ol>
<p>&nbsp;
<a NAME="12"></a><font size="4">Размещение в отчете рисунков </font> 
</P>
<P>
В отчеты, создаваемые в программе Visual FoxPro, можно включать растровые рисунки, которые улучшат внешний вид отчета. В письмах, рассылаемых клиентам, можно, например, поместить фирменный знак или эмблему фирмы. Для подготовки изображения можно использовать графические редакторы или сканер для считывания изображения. 
</P>
<P>
Для размещения в отчете рисунка используется кнопка Picture/ActiveX Bound Control (Изображение/ActivX объект) панели инструментов Report Controls (Элементы управления отчета) конструктора отчетов. Нажмите данную кнопку, а затем установите курсор в один из углов области, в которой должен находиться рисунок, и переместите курсор в противоположный угол до образования рамки необходимого размера. При этом открывается диалоговое окно Report Picture (Изображение отчета) (рис. 8.20), в котором вы определяете источник данных рисунка и его параметры. Источником данных может быть файл, содержащий рисунок, или поле таблицы типа General. Для указания источника данных используются опции области Picture from (Изображение из) диалогового окна. 
</P>
<IMG src="gl8-20.jpg" alt="gl8-20.jpg" width="376" height="416" ></IMG>
<P>
Рис. 8.20. Диалоговое окно Report Picture 
</P>
<P>
При размещении в отчете графического изображения в диалоговом окне Report Picture (Изображение отчета) установите опцию File (Файл). Затем нажмите кнопку выбора файла, расположенную с правой стороны поля. В открывшемся диалоговом окне Open (Открыть) выберите требуемый графический файл. Если вы знаете полное имя файла, то можете ввести его непосредственно в поле ввода File (Файл) без использования диалогового окна Open (Открыть). 
</P>
<P>
В том случае, если вы хотите печатать в отчете изображения, размещенные в поле 
таблицы (в Visual FoxPro для хранения графических изображений используются поля типа General), в диалоговом окне Report Picture (Изображение отчета) установите опцию Field (Поле). Затем нажмите расположенную с правой стороны поля кнопку и в открывшемся диалоговом окне Choose Field/Variable (Выбор поля/переменной) выберите необходимое поле таблицы. </P>
<P>
Если размер выделенной для размещения изображения области и размер самого изображения не совпадают, воспользуйтесь группой переключателей If picture and frame different sizes (Если разный размер) (табл. 8.13). 
</P>
<P>
Таблица 8.13. Группа переключателей If picture and frame different sizes 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Переключатель 
</TD>
<TD VALIGN="TOP">
Режим отображения 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Clip picture (Обрезать изображение) 
</TD>
<TD VALIGN="TOP">
Рисунок фиксируется в левой верхней части рамки, сохраняя первоначальный размер 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Scale picture, retain shape 
</P>
<P>
(Масштабировать, сохраняя форму) 
</TD>
<TD VALIGN="TOP">
Рисунок полностью заполняет отведенное ему поле, сохраняя относительные пропорции растрового изображения 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Scale picture, fill the frame 
</P>
<P>
(Масштабировать, заполняя рамку) 
</TD>
<TD VALIGN="TOP">
Рисунок полностью заполняет отведенное ему поле, в случае необходимости подвергаясь вертикальному или горизонтальному искажению 
</TD>
</TR>
</TABLE>
<P>
Переключатель Object Position (Положение объекта) диалогового окна Report Picture (Изображение отчета) позволяет задать положение графического изображения в полосе при изменении размеров окружающих его полей (табл. 8.14). 
</P>
<P>
Таблица 8.14. Группа переключателей Object Position 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Переключатель 
</TD>
<TD VALIGN="TOP">
Характеристика 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Float (Плавающее) 
</TD>
<TD VALIGN="TOP">
Расположение изображения в отчете может изменяться  при  изменении  размеров  окружающих его полей 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Fix relative to top of band 
</P>
<P>
(Постоянное относительно верхней полосы) 
</TD>
<TD VALIGN="TOP">
Изображение сохраняет свое положение относительно верхней границы полосы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Fix relative to bottom of band 
</P>
<P>
(Постоянное относительно нижней полосы) 
</TD>
<TD VALIGN="TOP">
Изображение сохраняет свое положение относительно нижней границы полосы 
</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="13"></a><font size="4">Создание отчета в свободной форме </font> 
</P>
<P>
Мы рассмотрели основные этапы работ для создания отчета в конструкторе отчетов. Приступим к созданию отчета в свободной форме для рассылки прайс-листов потенциальным клиентам. 
</P>
<ol>
  <li>Откройте проект sales. </li>
  <li>Откройте базу данных проекта. Для этого на вкладке Data (Данные) установите курсор на ее название и нажмите кнопку Open (Открыть) окна проекта. При этом на стандартной панели инструментов в списке Databases (Базы данных) появляется название открытой базы данных. 
  </li>
  <li>Перейдите на вкладку Documents (Документы), выберите группу Reports (Отчеты) и нажмите кнопку New (Новый). В открывшемся диалоговом окне New Report (Новый отчет) выберите опцию New Report (Новый отчет). Открывается окно конструктора отчетов. 
  </li>
  <li>Откройте среду окружения отчета Data Environment (Среда окружения), выполнив команду Environment (Окружение) из меню View (Вид) или выбрав команду Data Environment (Среда окружения) контекстного меню. 
  </li>
  <li>Для размещения таблицы в среде окружения в меню Data Environment
(Среда окружения) выберите команду Add (Добавить). Затем в открывшемся диалоговом окне Add Table or View (Добавить таблицу или представление данных) выберите таблицу customer и нажмите кнопку ОК. Закройте среду окружения. 
  </li>
  <li>Расположите в отчете поля, воспользовавшись командой Quick Report (Быстрый отчет) из меню Report (Отчет). При создании быстрого отчета выберите размещение полей по строкам и поля с наименованием предприятия, индекса и страны. Остальную информацию вы сформируете с помощью вычисляемых полей. 
  </li>
  <li>Добавьте в полосу Detail (Детали) отчета вычисляемое поле для отображения имени представителя клиента, содержащее следующее выражение: 
<P>
 ALLTRIM(Customer.cFirstName) + &quot; &quot;+ ALLTRIM(Customer.cSecondName) 
</P>
<P>
 &nbsp;</P>
  </li>
  <li>Добавьте в отчет вычисляемое поле для вывода адреса, которое содержит следующее выражение: 
<P>
 ALLTRIM{Customer.cCity)+ &quot; &quot; +ALLTRIM(Customer.cAddress) 
</P>
<P>
 &nbsp;</P>
  </li>
  <li>Разместите в отчете текст и поля, как показано на рис. 8.21. </li>
  <li>Просмотрите внешний вид отчета с помощью команды контекстного меню Preview (Просмотр). Экран будет иметь вид, представленный на рис. 8.22. 
  </li>
  <li>Сохраните отчет. </li>
</ol>
<IMG src="gl8-21.jpg" alt="gl8-21.jpg" width="500" height="444" ></IMG>
<P>
Рис. 8.21. Отчет в свободной форме Edit 
</P>
<IMG src="gl8-22.jpg" alt="gl8-22.jpg" width="500" height="444" ></IMG>
<P>
Рис. 8.22. Отчет в свободной форме Preview 
</P>
<p>&nbsp;
<a NAME="14"></a><font size="4">Создание табличного отчета </font> 
</P>
<P>
Создадим в конструкторе отчетов табличный отчет, содержащий список заказов. При создании отчета будем использовать три таблицы. Таблица Ordsaiem содержит сведения о заказе на товары — это главная таблица, на основании которой строится отчет. Остальные две таблицы являются вспомогательными. Таблица ordsaied содержит сведения о товарах, входящих в заданный заказ (количество купленных товаров и цена товара), а таблица Customer — информацию о клиентах. Приступим к созданию отчета. 
</P>
<ol>
  <li>Откройте новое окно в конструкторе отчетов. </li>
  <li>В среду окружения отчета Data Environment (Среда окружения) добавьте поочередно таблицы Ordsaiem, customer и ordsaied. При создании связей между таблицами для данного отчета необходимо учитывать следующее: 
  </li>
</ol>
<ul>
  <li>таблица Ordsaiem является родительской по отношению к таблицам
Ordsaied и Customer; </li>
  <li>связь между таблицами Ordsaiem и customer осуществляется по коду клиента; 
  </li>
  <li>связь между таблицами Ordsaiem и ordsaied осуществляется по коду заказа; 
  </li>
  <li>данные в таблице Ordsaiem должны быть упорядочены по коду заказа, в таблице customer — по коду клиента, в таблице ordsaied — no коду заказа. 
  </li>
</ul>
<blockquote>
<P>
Установив связи между таблицами и упорядочив данные (рис. 8.23), закройте окно Data Environment (Среда окружения). 
</P>
</blockquote>
<ol>
  <li value="3">Используя   команду   Quick   Report   (Быстрый   отчет)   из   меню   Report (Отчет), разместите в отчете следующие поля: 
  </li>
</ol>
<ul>
  <li>ccompany с наименованием компании из таблицы Customer; </li>
  <li>dDoc, содержащее дату продажи из таблицы Ordsaiem; </li>
  <li>nQuant с количеством проданного товара из таблицы Ordsaied; </li>
  <li>nUnitprice с ценой товара из таблицы Ordsaied. </li>
</ul>
<ol>
  <li value="4">Создайте вычисляемое поле, которое содержит выражение для подсчета стоимости проданного товара:
 OrdSaled.nQuant * OrdSaled.nUnitPrice </li>
  <li>Добавьте в полосу Page Header (Верхний колонтитул) заголовки для размещенных полей. 
  </li>
  <li>Добавьте в отчет заголовок и итоговую часть отчета, выполнив команду Title/Summary (Титул/Итоги) из меню Report (Отчет). 
  </li>
  <li>В заголовке отчета введите Список заказов. </li>
</ol>
<IMG src="gl8-23.jpg" alt="gl8-23.jpg" width="500" height="444" ></IMG>
<P>
Рис. 8.23. Диалоговое окно Data Environment 
</P>
<IMG src="gl8-24.jpg" alt="gl8-24.jpg" width="500" height="335" ></IMG>
<P>
Рис. 8.24. Созданный отчет в окне конструктора отчетов 
</P>
<ol>
  <li value="8">В итоговой части отчета создайте поле, которое вычислит стоимость всех заказов, просуммировав стоимость проданного товара. 
  </li>
  <li>Отчет в окне конструктора отчетов будет иметь вид, представленный на рис. 8.24. Просмотрите внешний вид отчета в окне 
  предварительного просмотра (рис. 8.25). </li>
  <li>Сохраните отчет. </li>
</ol>
<IMG src="gl8-25.jpg" alt="gl8-25.jpg" width="500" height="316" ></IMG>
<P>
Рис. 8.25. Просмотр табличного отчета 
</P>
<p>&nbsp;
<a NAME="15"></a><font size="4">Группировка данных в отчете </font> 
</P>
<P>
Посмотрите на отчет, представленный на рис. 8.25. Видно, что клиент может приобрести разные товары. Сам собой возникает вопрос: а нельзя ли объединить данные в отчете таким образом, чтобы иметь краткую информацию о том, какие товары приобрел тот или иной клиент? 
</P>
<P>
Для  группировки  данных в  отчете  используется  команда  Data  Grouping Группировка  данных)   меню   Report   (Отчет)   и   команда   Data   Grouping 
</P>
<P>
Группировка данных) контекстного  меню, которые позволяют создавать до 20 уровней вложенности групп и выполнять над ними следующие операции: 
</P>
<ul>
  <li>печатать текст, идентифицирующий конкретные группы; </li>
  <li>печатать каждую группу отчета с новой страницы; </li>
  <li>при печати каждой группы начинать новую нумерацию страниц. </li>
</ul>
<IMG src="gl8-26.jpg" alt="gl8-26.jpg" width="304" height="345" ></IMG>
<P>
Рис. 8.26. Диалоговое окно Data Grouping 
</P>
<P>
При выполнении данных команд открывается диалоговое окно Data Grouping (Группировка данных) (рис. 8.26), содержащее список созданных в отчете групп. Используя расположенные в окне кнопки, можно редактировать или удалять имеющиеся в отчете группы, добавлять новые. 
</P>
<P>
Для формирования выражения, по которому будут группироваться данные в отчете, можно использовать построитель выражения или ввести требуемое выражение непосредственно в поле Group expressions (Выражение группировки). 
</P>
<P>
В диалоговом окне Data Grouping (Группировка данных) вы можете установить следующие параметры группировки данных (табл. 8.15). 
</P>
<P>
Таблица 8.15. Параметры группировки данных окна Data Grouping 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Флажок 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Start group on new column 
</P>
<P>
(Каждая группа в новой колонке) 
</TD>
<TD VALIGN="TOP">
Если флажок установлен, то  при каждом изменении группы происходит формирование новой колонки 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Start each group on a new page 
</P>
<P>
(Каждая группа на новой странице) 
</TD>
<TD VALIGN="TOP">
При установке флажка каждая группа отчета размещается на новой странице 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Reset page number to 1 for each group (Сброс нумерации страниц для каждой группы) 
</TD>
<TD VALIGN="TOP">
При установке флажка  каждая  группа отчета размещается   на   новой   странице.   Нумерация страниц группы начинается с 1 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Reprint group header on each page (Верхняя полоса группы для каждой страницы) 
</TD>
<TD VALIGN="TOP">
Если  группа занимает несколько страниц, то при установке флажка верхняя полоса группы размещается после верхнего колонтитула страницы 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Start group on new page when less than (Печатать группу с новой страницы, если) 
</TD>
<TD VALIGN="TOP">
Если под заголовком группы остается расстояние меньше указанного в данном поле, то информация группы будет перенесена на новую страницу 
</TD>
</TR>
</TABLE>
<P>
С   помощью   кнопки   Insert   (Вставить)  диалогового  окна  Data   Grouping
(Группировка данных) можно добавить в отчет новую группу. Для удаления полосы группы используется кнопка Delete (Удалить). 
</P>
<p>&nbsp;
<a NAME="16"></a><font size="4">Использование группировки в отчете </font> 
</P>
<P>
Модифицируем отчет, созданный в предыдущем примере. Добавим в него группировку по клиентам и разместим в полосах группы наименование клиента и итоговую сумму приобретенных им товаров. 
</P>
<ol>
  <li>Откройте отчет, созданный в предыдущем примере. </li>
  <li>Для группировки данных в отчете по полю icdCustomer в меню Report (Отчет) выберите команду Data Grouping (Группировка данных). 
  </li>
  <li>В поле Group expressions (Выражение группировки) открывшегося диалогового окна Data Grouping (Группировка данных) нажмите кнопку вызова построителя выражения. 
  </li>
  <li>В окне построителя сформируйте выражение группировки. Для этого в списке Fields (Поля) дважды щелкните мышью на поле icdCustomer таблицы Ordsalem. 
  </li>
  <li>Закройте окно построителя выражения. В поле Group expressions (Выражение группировки) диалогового окна Data Grouping (Группировка данных) появилось выбранное нами поле icdCustomer. 
  </li>
  <li>Закройте диалоговое окно, нажав кнопку ОК. </li>
  <li>В отчет добавились полосы группировки. Расширьте полосу Group Header
(Группа сверху). Для этого установите курсор в нижнюю часть полосы и, когда он примет вид двунаправленной стрелки, переместите вниз. 
  </li>
  <li>Перенесите в образовавшуюся область поле с наименованием клиента, а также его заголовок. 
  </li>
</ol>
<IMG src="gl8-27.jpg" alt="gl8-27.jpg" width="500" height="354" ></IMG>
<P>
Рис. 8.27. Группировка данных в отчете по коду клиента 
</P>
<IMG src="gl8-28.jpg" alt="gl8-28.jpg" width="500" height="354" ></IMG>
<P>
Рис. 8.28. Просмотр отчета с группировкой данных 
</P>
<ol>
  <li value="9">Расширьте полосу Group Footer (Группа снизу) и создайте в ней итоговое поле, которое будет показывать сумму продаж по каждому клиенту. При формировании поля укажите суммирование по следующему выражению:
 OrdSaled.nQuant * OrdSaled.nUnitPrice
Отчет в окне конструктора отчетов будет иметь вид, представленный на
рис. 8.27. </li>
  <li>Просмотрите внешний вид отчета в окне предварительного просмотра (рис. 8.28). 
  </li>
  <li>Сохраните созданный отчет. </li>
</ol>
<p>&nbsp;
<a NAME="17"></a><font size="4">Использование в отчете переменных </font> 
</P>
<P>
В отчете вы можете использовать переменные из программы, доступные в момент вызова отчета, а также переменные, определенные в конструкторе отчетов и используемые для хранения результатов вычислений, выполняемых во время печати отчета. 
</P>
<P>
Переменные отчета определяются в диалоговом окне Report Variables (Переменные отчета) (рис. 8.29), для открытия которого используется команда Variables (Переменные) из меню Report (Отчет). Кнопки Insert (Вставить) и Delete (Удалить) позволяют добавлять в отчет новые переменные и удалять существующие. 
</P>
<IMG src="gl8-29.jpg" alt="gl8-29.jpg" width="317" height="395" ></IMG>
<P>
Рис. 8.29. Диалоговое окно Report Variables 
</P>
<P>
Диалоговое окно Report Variables (Переменные отчета) содержит три поля, описанных в табл. 8.16. 
</P>
<P>
Таблица 8.16. Поля диалогового окна Report Variables 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Наименование поля 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Variables (Переменные) 
</TD>
<TD VALIGN="TOP">
Содержит наименование переменной, которое может включать в себя только буквы, цифры и символ подчеркивания и не может начинаться с цифры 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Value to store (Хранимое значение) 
</TD>
<TD VALIGN="TOP">
Значение переменной 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Initial value (Начальное значение) 
</TD>
<TD VALIGN="TOP">
Начальное значение переменной 
</TD>
</TR>
</TABLE>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Для формирования значений переменных, задаваемых в полях Value to store (Хранимое значение) и Initial value (Начальное значение), можно использовать диалоговое окно Expression Builder (Построитель выражения), открываемое при нажатии расположенных с правой стороны поля кнопок.
</font> 
</P>
<P>
При установке флажка Release after report (Освободить после отчета) после завершения печати отчета переменная очищается из памяти. 
</P>
<P>
Список Reset at (Сброс) содержит три значения, указывающие момент сброса переменной в начальное значение: в конце отчета, в конце страницы или в конце группы. 
</P>
<P>
Группа переключалей Calculate, расположенные в диалоговом окне Report Variables (Переменные отчета), позволяет задать выражения, выполняемые над переменной вычисления (табл. 9.17). 
</P>
<P>
Таблица 8.17. Назначение группы переключалей Calculate диалогового окна Report Variables 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Переключатель 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Nothing (Ничего) 
</TD>
<TD VALIGN="TOP">
Над переменной вычисления не производятся 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Count (Количество) 
</TD>
<TD VALIGN="TOP">
Вычисляется количество появлений переменной в группе, на странице, в колонке или отчете (значение переменной не используется) 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Sum (Сумма) 
</TD>
<TD VALIGN="TOP">
Вычисляется итоговая сумма значений переменной 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Average (Среднее) 
</TD>
<TD VALIGN="TOP">
Вычисляется среднее арифметическое значений переменной в группе, на странице, в колонке или отчете 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Lowest 
</P>
<P>
(Минимальное) 
</TD>
<TD VALIGN="TOP">
Отображается наименьшее значение переменной в группе, на странице, в колонке или отчете 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Highest
(Максимальное) 
</TD>
<TD VALIGN="TOP">
Отображается наибольшее значение переменной в группе, на странице, в колонке или отчете 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Std, deviation (Станд. отклонение) 
</TD>
<TD VALIGN="TOP">
Возвращается квадратный корень из дисперсии значений переменной в группе, на странице, в колонке или отчете 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Variance (Дисперсия) 
</TD>
<TD VALIGN="TOP">
Возвращается статистическая величина отклонения отдельных значений переменной от среднего в группе, на странице, в колонке или отчете 
</TD>
</TR>
</TABLE>
<P>
При использовании переменных в отчете необходимо иметь в виду следующее. 
</P>
<ul>
  <li>Переменные в отчете могут использоваться в качестве полей или в выражениях, определяющих поля. Все созданные в диалоговом окне Report Variables (Переменные отчета) переменные отображаются в списке переменных в окне построителя выражения. 
  </li>
  <li>При запуске отчета переменной присваивается начальное значение, а затем в процессе формирования отчета ее значение изменяется в соответствии с выбранным выражением. При заданных для переменной условиях она принимает свое начальное значение. 
  </li>
  <li>Для определения начального или вычисляемого значения переменной могут использоваться другие переменные, но значения этих переменных должны вычисляться до момента их использования переменной. 
  </li>
</ul>
<p>&nbsp;
<a NAME="18"></a><font size="4">Разметка страницы отчета </font> 
</P>
<P>
Для разметки страницы отчета используется диалоговое окно Page Setup (Разметка страницы) (рис. 8.30), открываемое при выборе в меню File (Файл) команды Page Setup (Разметка страницы). Оно позволяет определить количество колонок в отчете, порядок вывода записей, ширину левого поля отчета, ширину колонок и расстояние между ними, единицу измерения координат отчета и выбор режима печати. 
</P>
<P>
В области Columns (Колонки) этого диалогового окна определяются размеры колонок и их количество на странице (табл. 8.18). 
</P>
<P>
Таблица 8.18. Назначение полей области Columns диалогового окна Page Setup 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Поле 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Number (Число) 
</TD>
<TD VALIGN="TOP">
Определяет число колонок на странице 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Width (Ширина) 
</TD>
<TD VALIGN="TOP">
Определяет ширину колонок в сантиметрах или дюймах 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Spacing (Расстояние) 
</TD>
<TD VALIGN="TOP">
Определяет расстояние между колонками 
</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl8-30.jpg" alt="gl8-30.jpg" width="418" height="338" ></IMG> </p>
<P>
Рис. 8.30. Диалоговое окно Page Setup 
</P>
<P>
Опции переключателя Print area (Область печати) описаны в табл. 8.19. 
</P>
<P>
Таблица 8.19. Назначение опций переключателя Print area 
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Опция 
</TD>
<TD VALIGN="TOP">
Назначение 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Printable page 
</P>
<P>
(Печатаемая страница) 
</TD>
<TD VALIGN="TOP">
Устанавливает режим печати с полями страницы, определяемыми в соответствии с требованиями текущего драйвера печати 
</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD VALIGN="TOP">
Whole page 
</P>
<P>
(Страница в целом) 
</TD>
<TD VALIGN="TOP">
Устанавливает режим печати с минимальными полями 
</TD>
</TR>
</TABLE>
<P>
Для задания порядка вывода записей в многоколоночных отчетах используются две кнопки области Print order (Порядок печати). Расположенный ниже счетчик Left margin (Левая граница) задает ширину левого поля отчета. 
</P>
<p>&nbsp;
<a NAME="19"></a><font size="4">Создание многоколоночного отчета </font> 
</P>
<P>
Мы рассмотрели создание отчета для рассылки информации потенциальным клиентам. Используя многоколоночный отчет, подготовим данные для печати адресов, наклеиваемых на конверты для отправки клиентам. 
</P>
<ol>
  <li>Откройте конструктор отчета. </li>
  <li>Добавьте в среду окружения отчета таблицу customer, содержащую адреса клиентов. 
  </li>
  <li>Расположите в отчете требуемые для формирования адреса поля и обратный адрес. Отчет будет иметь вид, показанный на рис. 8.31. 
  </li>
</ol>
<IMG src="gl8-31.jpg" alt="gl8-31.jpg" width="500" height="377" ></IMG>
<P>
Рис. 8.31. Многоколоночный отчет 
</P>
<IMG src="gl8-32.jpg" alt="gl8-32.jpg" width="500" height="305" ></IMG>
<P>
Рис. 8.32. Многоколоночный отчет в окне предварительного просмотра 
</P>
<ol>
  <li value="4">В меню File (Файл) выберите команду Page Setup (Разметка страницы). 
  </li>
  <li>В поле Number (Число) открывшегося диалогового окна Page Setup (Разметка страницы) введите число 2, определяющее количество колонок в отчете, и нажмите кнопку ОК. 
  </li>
  <li>Просмотрите внешний вид отчета в окне предварительного просмотра с помощью команды контекстного меню Preview (Предварительный просмотр) (рис. 8.32). 
  </li>
  <li>Сохраните отчет. </li>
</ol>
</BODY>
</HTML>