<HTML>
<HEAD>
<TITLE></TITLE>
<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML; CHARSET=WINDOWS-1251">
</HEAD>
<body background="../fon.jpg">

<p><CENTER><font size="4"><b>ГЛАВА 13 
<br>
Управление проектом и создание приложения</b></font>
</center>
</P>
<br>
<br>

<ul>
  <li><a href="gl13.html#1">Определение свойств окна проекта </a>
  <li><a href="gl13.html#2">Задание параметров проекта</a>
  <li><a href="gl13.html#3">Установка основной программы проекта</a>
  <li><a href="gl13.html#4">Использование опции Exclude</a>
  <li><a href="gl13.html#5">Очистка проекта от удаленных файлов </a>
  <li><a href="gl13.html#6">Построение проекта</a>
  <li><a href="gl13.html#7">Галерея компонентов Visual FoxPro</a>
  <li><a href="gl13.html#8">Запуск Галереи компонентов</a>
  <li><a href="gl13.html#9">Настройка параметров окна Галереи компонентов</a>
  <li><a href="gl13.html#10">Каталоги Галереи компонентов</a>
  <li><a href="gl13.html#11">Представления данных</a>
  <li><a href="gl13.html#12">Работа с проектом из окна Галереи компонентов</a>
  <li><a href="gl13.html#13">Использование метода "перенести-и-оставить" для перемещения объектов</a>
  <li><a href="gl13.html#14">Создание новой формы из Галереи компонентов</a>
</ul>

<P>
Мы рассмотрели создание форм, отчетов, запросов, перекрестных таблиц,диаграмм и меню. Каждый из этих компонентов проекта можно запуститьна выполнение. Что же еще необходимо сделать, чтобы все объекты, включенные в создаваемый нами проект, функционировали как единое целое?Это мы сейчас и рассмотрим.
</P>
<p>&nbsp;
<a NAME="1"></a><font size="4">Определение свойств окна проекта
</font>
</P>
<P>
При работе с файлами, размещенными в проекте, для их открытия и запуска на выполнение мы использовали кнопки Modify (Модифицировать),Browse (Обзор) и Run (Запустить) окна проекта. Visual FoxPro позволяет дляэтих целей использовать также мышь. При этом выполняемое действие определяется параметрами, установленными на вкладке Project (Проект) диалогового окна Options (Параметры) (рис. 13.1), вызываемого командойOptions (Параметры) из меню Tools (Сервис).
</P>
<P>
Используя опции области Project double-click action (Действия, выполняемыепри двойном щелчке в проекте) этого диалогового окна, вы можете указатьдействие, выполняемое при двойном щелчке на имени компонента. Поумолчанию установлен признак модификации выбранного компонента проекта, поэтому после двойного щелчка на нем вызывается конструктор, используемый при модификации файла данного типа.
</P>
<P>
Вы можете установить опцию Run selected file (Запустить выбранный файл).В этом случае при двойном щелчке на имени файла он будет запускаться.Таблица при двойном щелчке будет открываться в режиме Browse (Обзор)для просмотра содержащихся в ней записей.
</P>
<P>
Если в диалоговом окне Options (Параметры) установлен флажок Prompt forWizard (Запрос мастеров), при создании нового компонента проекта открывается диалоговое окно с запросом об использовании мастера для его создания. Если этот флажок не установлен, то сразу будет вызываться конструктор, соответствующий создаваемому объекту.
</P>
<P>
Чтобы настроить основные параметры управления проектом, вы можете использовать флажки области Source control options (Параметры хранилища
данных), предназначенные для управления крупным проектом, выполняемым группой разработчиков. Назначение установки флажков описано втабл. 13.1.
</P>
<IMG src="gl13-1.jpg" alt="gl13-1.jpg" width="478" height="416"></IMG>
<P>
Рис. 13.1. Определение параметров окна проекта
</P>
<P>
Таблица 13.1. Назначение флажков вкладки Project
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Флажок

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Automatically add new projects tosource control (Автоматическидобавлять новые проекты в хранилище данных)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создаваемый проект автоматически помещается в хранилище данных. В противном случае выдолжны будете добавлять проект вручную

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Check out files upon modify
(Выбор файла для эксклюзивногоредактирования)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Редактируемый файл автоматически выбирается для эксклюзивного редактирования пользователем. Если файл уже выбран для эксклюзивного редактирования другим пользователем,Visual FoxPro выдает соответствующее предупреждение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Add files to source control upon
add (Добавлять данные в хранилище)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Файлы автоматически добавляются в хранилище данных проекта. Если флажок не установлен, то файлы будут добавляться только в проект (в файл с расширением PJX), но не будутдобавляться в хранилище. Следовательно, вамбудет необходимо размещать файл в хранилище вручную

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Remove files from source controlupon removal from project
(Удалять файлы из хранилища приудалении из проекта)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Удаляемый   из   проекта   файл   автоматическиудаляется из хранилища данных. Если флажокснят,  то при удалении файла из  проекта информация о файле сохраняется  в хранилищеданных. При этом, если файл не был удален сжесткого диска, к нему можно получить доступ,используя систему совместной разработки внеVisual FoxPro

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Display dialog box for shortcutmenu commands (Открывать диалоговое окно из всплывающегоменю команд)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

При   выборе   элемента   проекта   с   помощьюкоманды   всплывающего   меню   проекта   VisualFoxPro открывает диалоговое окно,  позволяющее для  работы с данной  командой  выбратьболее одного файла

</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="2"></a><font size="4">Задание параметров проекта </font>
</P>
<P>
Можно задать параметры, которые будут использоваться в процессе построения каждого проекта. Это информация о разработчике, месте расположения проекта, параметры генерации приложения и значок для выполняемого файла приложения. Чтобы задать параметры проекта, выполнитеследующие действия:
</P>
<ol>
  <li>В меню Project (Проект) выберите команду Project Info (Параметры проекта). Открывается диалоговое окно Project Information (Параметры проекта),содержащее вкладки Project (Проект), Files (Файлы) и Servers (Серверы). 
  </li>
  <li>На вкладке Project (Проект) (рис. 13.2) в полях Author (Автор), Company(Фирма), Address (Адрес), City (Город), Country (Страна), State (Область)и Postal Code (Почтовый индекс) укажите информацию о разработчикахпроекта. 
  </li>
  <li>Поле ввода Ноте (Домашний каталог) вкладки Project (Проект) используется для задания места расположения проекта. Для изменения папки, указанной в поле, используется диалоговое окно Select Directory (Выбор каталога) (рис. 13.3), которое вызывается при нажатии кнопки, расположеннойсправа от поля ввода. Выберите из открывшегося диалогового окна папку,в которой размещен проект, и нажмите кнопку Select (Выбор). 
  </li>
  <li>Если вы хотите создать значок, при щелчке на котором будет запускатьсявыполняемый файл проекта, то установите флажок Attach icon (Определить значок). 
  </li>
</ol>
<IMG src="gl13-2.jpg" alt="gl13-2.jpg" width="413" height="364"></IMG>
<P>
Рис. 13.2. Диалоговое окно Project Information
</P>
<IMG src="gl13-3.jpg" alt="gl13-3.jpg" width="334" height="377"></IMG>
<P>
Рис. 13.3. Диалоговое окно Select Directory
</P>
<ol>
  <li value="5">В открывшемся диалоговом окне Open (Открыть) найдите на диске файлы с расширением ICO, которые можно использовать в качестве значкадля создаваемого приложения. Например, просмотрите предлагаемыеVisual FoxPro значки из папки Graphics (Графика) (рис. 13.4). Установивфлажок Preview (Просмотр) диалогового окна Open (Открыть), вы можетепросмотреть вид значка в области Picture (Изображение). Выбрав значок,нажмите кнопку ОК для закрытия окна. 
  </li>
</ol>
<IMG src="gl13-4.jpg" alt="gl13-4.jpg" width="500" height="249"></IMG>
<P>
Рис. 13.4. Выбор значка для проекта
</P>
<ol>
  <li value="6">Просмотрите информацию в поле Last built (Последнее построение). Этополе содержит дату последнего построения проекта. 
  </li>
  <li>Для включения отладочной информации в исполняемый код установитефлажок Debug info (Информация об отладке). Эта информация поможетпри отладке программы и исправлении ошибок, возникших на компьютере конечного пользователя. 
  </li>
</ol>
<P>
<b><font color="#000080">Предупреждение</font></b></P>
<P>
<font color="#000080">Используйте флажок Debug info (Информация об отладке) только в случае необходимости, т. к. его установка может привести к декомпиляции программы.
</font>
</P>
<ol>
  <li value="8">Чтобы сохранить права на интеллектуальную собственность разработанного проекта, используйте флажок Encrypted (Шифровать). Установитеэтот флажок, если хотите, чтобы Visual FoxPro зашифровал исполняемыйкод проекта, повышая тем самым степень защиты вашей программы отдекомпиляции. 
  </li>
  <li>Нажмите кнопку ОК для закрытия диалогового окна. </li>
</ol>
<P>
Вкладка Files (Файлы) диалогового окна Project Information (Параметрыпроекта) содержит в табличном виде список файлов, входящих в проект(рис. 13.5). Просмотрите этот список. Для удобства просмотра информации,содержащейся в таблице, данные можно упорядочить по параметрам, представленным в табл. 13.2.
</P>
<P>
Таблица 13.2. Параметры упорядочения
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Наименование столбца

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Тип упорядочения

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Туре (Тип)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

По типам файлов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Name (Имя)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

По именам файлов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Last Modified (Последняя модификация)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

По дате последней модификации файлов

</TD>
</TR>
</TABLE>
<P>
Для упорядочения данных необходимо щелкнуть на заголовке соответствующего столбца. Столбец Included (Включен) указывает, включен ли текущийфайл в исполняемый файл. Просмотрите список файлов. Отметку в этомстолбце не имеют только свободные таблицы, не входящие в базу данных.
</P>
<IMG src="gl13-5.jpg" alt="gl13-5.jpg" width="413" height="364"></IMG>
<P>
Рис. 13.5. Вкладка Files диалогового окна Project Information
</P>
<p>&nbsp;
<a NAME="3"></a><font size="4">Установка основнойпрограммы проекта </font>
</P>
<P>
Проект обязательно должен содержать программу, которая запускает приложение и управляет его работой. Такой файл называется основной программой иим чаще всего является меню приложения. Вы можете также определить вкачестве основной программы созданную вами программу управления приложением, содержащую установку основных параметров, используемых глобальных переменных и т. д.
</P>
<P>
Чтобы сделать компонент проекта основным, выполните следующие действия:</P>
<ol>
  <li>Выберите в окне проекта файл, который хотите сделать основным. </li>
  <li>В меню Project (Проект) выберите команду Set Main (Основная программа) или выберите команду контекстного меню файла Set Main(Основная программа). 
  </li>
</ol>
<P>
В окне проекта имя файла выделяется жирным шрифтом, указывая, чтоданный компонент является основной программой (рис. 13.6).
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Для установки основной программы проекта вы можете также воспользоватьсядиалоговым окном Project Information (Параметры проекта). На вкладке Files(Файлы) выделите необходимый файл, нажмите правую кнопку мыши и из контекстного меню выберите команду Set Main (Основная программа).
</font>
</P>
<IMG src="gl13-6.jpg" alt="gl13-6.jpg" width="500" height="391"></IMG>
<P>
Рис. 13.6. Установка основной программы в окне проекта
</P>
<p>&nbsp;
<a NAME="4"></a><font size="4">Использование опции Exclude </font>
</P>
<P>
Выполняемые компоненты проекта (программы, формы, меню) при создании приложения с помощью проекта объединяются для создания кода приложения. Невыполняемые компоненты, такие как таблицы, индексы включаются в приложение доступными только для чтения. Вы можете разрешить
конечному пользователю  модифицировать компоненты,  исключив  их  изпроекта.
</P>
<P>
Чтобы исключить компонент из проекта можно воспользоваться следующими средствами:
</P>
<ul>
  <li>Командой контекстного меню Exclude (Исключить).</li>
  <li>Командой Exclude (Исключить) из меню Project (Проект).</li>
</ul>
<P>
Рядом с исключенным компонентом в окне проекта появляется кружок, перечеркнутый линией.
</P>
<P>
Исключенные из проекта компоненты остаются в списке проекта, но невключаются в состав приложения при его построении. Поэтому вам необходимо самостоятельно отслеживать их наличие и доступ к ним из приложения.Для включения в проект исключенного компонента необходимо воспользоваться командой контекстного меню Include (Включить) или командойInclude (Включить) из меню Project (Проект).
</P>
<p>&nbsp;
<a NAME="5"></a><font size="4">Очистка проекта от удаленных файлов </font>
</P>
<P>
Вся информация о проекте хранится в системной таблице Visual FoxPro.При разработке приложения после удаления компонента из проекта в этойтаблице ставится лишь метка об его удалении. Чтобы окончательно удалитьиз проекта информацию обо всех помеченных на удаление компонентов,необходимо таблицу проекта упаковать, воспользовавшись командой CleanUp Project (Упаковать проект) из меню Project (Проект).
</P>
<p>&nbsp;
<a NAME="6"></a><font size="4">Построение проекта </font>
</P>
<P>
При построении проекта Visual FoxPro просматривает все компоненты, перечисленные в нем, и формирует проект. Например, в проект должнывключаться все программы, формы и отчеты, которые вызываются при выборе пунктов меню. Если какие-либо компоненты вызывают в свою очередьдругие компоненты, то они также включаются в проект.Для создания проекта нажмите кнопку Build (Построить) в окне проектаили выберите команду Build (Построить) из меню Project (Проект). На экране открывается диалоговое окно Build Options (Опции построения)(рис. 13.7), содержащее пять опций следующего назначения:</P>
<ul>
  <li>Rebuild project (Перестроить проект) — собирает проект, проверяя наличие в нем всех необходимых файлов; 
  </li>
  <li>Application (app) (Приложение) — создает исполняемое приложение срасширением АРР. Данный файл может запускаться на выполнение вVisual FoxPro командой Do (Выполнить) из меню Program (Программа); 
  </li>
  <li>Win32 executable/COM server (exe) (Исполняемый файл) — создает исполняемое приложение с расширением ЕХЕ. Данный файл может запускаться на выполнение как в главном окне Visual FoxPro, так и вне егопри наличии соответствующих библиотек; 
  </li>
  <li>Single-threaded COM serve (dll) (Однопоточный СОМ-сервер) — создаетоднопоточную динамическую библиотеку (Dynamic Link Library) с расширением DLL; 
  </li>
  <li>Multi-threaded COM server (dll) (Многопоточный СОМ-сервер) — создаетмногопоточную динамическую библиотеку (Dynamic Link Library) с расширением DLL. 
  </li>
</ul>
<IMG src="gl13-7.jpg" alt="gl13-7.jpg" width="351" height="257"></IMG>
<P>
Рис. 13.7. Диалоговое окно Build Options
</P>
<P>
В диалоговом окне Build Options (Опции построения) расположены флажки,позволяющие задать параметры создаваемого проекта:
</P>
<ul>
  <li>Recompile All Files (Обновлять все файлы) — устанавливается для обновления всех компонентов проекта. По умолчанию обновляются только текомпоненты проекта, которые были изменены после предыдущего построения; 
  </li>
  <li>Display Errors (Показывать ошибки) — при установке флажка после завершения построения проекта на экране появляется диалоговое окно(рис. 13.8), сообщающее об ошибках, встретившихся в процессе построения. Если флажок не установлен, ошибки построения можно просмотреть, выполнив команду Errors (Ошибки) из меню Project (Проект); 
  </li>
  <li>Run After Build (Запустить после построения) — флажок устанавливается втом случае, если необходимо запустить приложение сразу после создания; 
  </li>
  <li>Regenerate Component IDs (Перестроить идентификаторы Automation-серверов) — флажок устанавливается в том случае, если необходимо установить и регистрировать Automation-серверы, содержащиеся в проекте. 
  </li>
</ul>
<P>
Кнопка Version (Версия) открывает одноименное диалоговое окно, в котором можно указать информацию о номере и типе версии приложения.
</P>
<P>
<font color="#008000"><b>Замечание</b></font></P>
<P>
<font color="#008000">Флажок Regenerate Component IDs (Перестроить идентификаторы Automation-серверов) доступен только при установленной опции Win32 executable/COMserver (Исполняемый файл), Single-threaded COM server (ОднопоточныйСОМ-сервер) Multi-threaded COM server (Многопоточный СОМ-сервер).
</font>
</P>
<IMG src="gl13-8.jpg" alt="gl13-8.jpg" width="500" height="315"></IMG>
<P>
Рис. 13.8. Диалоговое окно, сообщающее об ошибках,возникших при построении приложения
</P>
<P>
Для построения проекта выберите опцию Rebuild Project (Перестроить проект) и нажмите кнопку ОК. В появившемся запросе о необходимости сохранения проекта выберите значение Yes (Да).
</P>
<P>
Если в процессе построения проекта диспетчер проектов обнаружит компонент, не описанный в проекте, на экране появится диалоговое окно LocateFile (Определение файла), содержащее имя ненайденного файла.Для поиска компонента нажмите кнопку Locate (Определить) и найдите надиске необходимый файл. Вы можете проигнорировать данную ошибку.В этом случае нажмите кнопку Ignore (Игнорировать).
</P>
<P>
Список всех обнаруженных ошибок сохраняется в файле, имя которого совпадает с именем файла проекта и имеет расширение ERR.
</P>
<P>
Когда все требуемые компоненты включены в проект, вы можете создать исполняемый файл, установив в диалоговом окне Build Options (Опции построения) опции Application (Приложение) или Win32 executable/COM server (exe)(Исполняемый файл). Для создания файла с расширением АРР, который может запускаться на выполнение из программы Visual FoxPro, необходимо использовать опцию Application (Приложение). В том случае, если вы хотитесоздать файл с расширением ЕХЕ, который может запускаться автономно, воспользуйтесь опцией Win32 executable/COM server (exe) (Исполняемый файл).
</P>
<P>
После создания приложения с установленной опцией Build Options опцииApplication (Приложение) или Win32 executable/COM server (exe) (Исполняемый файл) вы можете запустить его, используя команду DO, введенную вокне Command Visual FoxPro или командой Do (Выполнить) из менюProgram (Программа). При выполнении этой команды открывается диалоговое окно Do (Выполнить). Откройте в нем нужную папку, в списке файловвыберите созданный вами файл проекта, имеющий расширение АРР, и нажмите кнопку Do (Выполнить).
</P>
<P>
Для выполнения приложения, созданного с опцией Win32 executable/COM
server (exe) (Исполняемый файл), вы должны иметь доступ к динамическимбиблиотекам Vfp7.dll и Vfp7enu.dll.
</P>
<p>&nbsp;
<a NAME="7"></a><font size="4">Галерея компонентов Visual FoxPro </font>
</P>
<P>
Галерея компонентов является средством организации разработки в VisualFoxPro, позволяющим разработчику группировать и упорядочивать компоненты, такие как используемые в работе проекты, библиотеки, классы,формы, отчеты, кнопки и т. п. Созданное вами упорядочение можно динамически изменять, что позволит использовать разные подходы к классификации компонентов разработки.
</P>
<P>
В Галерее компонентов для работы можно разместить различные элементыVisual 
FoxPro, локальные и удаленные документы, файлы или папки, Automation-серверы, например, Microsoft Excel, Microsoft Word и HTML-файлы.В ней содержатся также новые базовые классы Visual FoxPro.
</P>
<P>
Галерея компонентов призвана создать рабочую среду и являться хранилищем данных, используемым для быстрой разработки приложений. В нейможно разместить не только компоненты, из которых создается приложение, но и созданные вами или сторонними организациями проекты, статьии другие документы, содержащие информацию, полезную для разработки. Вокне Галереи компонентов можно также хранить ссылки на используемыепри разработке Web-страницы.
</P>
<P>
Галерея компонентов располагает средствами для создания новых проектов,форм, а также для изменения свойств объектов и классов. Объекты, размещенные в Галерее компонентов, можно переносить в проекты и формы (инаоборот) с помощью метода &quot;перенести-и-оставить&quot;.
</P>
<p>&nbsp;
<a NAME="8"></a><font size="4">Запуск Галереи компонентов </font>
</P>
<P>
Для запуска Галереи компонентов выполните одно из следующих действий:
</P>
<ul>
  <li>Выберите в меню Tools (Сервис) команду Component Gallery (Галереякомпонентов). 
  </li>
</ul>
<IMG src="gl13-10.jpg" alt="gl13-10.jpg" width="452" height="368"></IMG>
<P>
Рис. 13.9. Галерея компонентов</P>
<ul>
  <li>В командном окне введите следующую команду: </li>
</ul>
<blockquote>
<P>
DO   (_GALLERY)
</P>
<P>
При этом на экране открывается окно Галереи компонентов (рис. 13.9).Оно разделено на две области. В левой области размещен иерархическийсписок каталогов, в правой — содержимое каталога, выбранного в левойобласти.
</P>
</blockquote>
<P>
В верхней части окна Галереи компонентов находится панель инструментов,кнопки которой позволяют настроить параметры окна Галереи компонентов,найти нужный объект, а также управляют отображением объектов в окне.
</P>
<p>&nbsp;
<a NAME="9"></a><font size="4">Настройка параметров окнаГалереи компонентов </font>
</P>
<P>
На панели инструментов окна Галереи компонентов расположена кнопкаOptions (Параметры), при нажатии которой открывается диалоговое окноComponent Gallery Options (Параметры галереи компонентов) (рис. 13.10).Оно содержит три вкладки, назначение которых описано в табл. 13.3.
</P>
<P>
Таблица 13.3. Назначение вкладок диалогового окна
Component Gallery Options
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Вкладка

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Standard (Стандартные)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

На данной вкладке можно определить общие параметры настройки Галереи компонентов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Catalogs (Каталоги)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Позволяет добавить в Галерею компонентов новыекаталоги

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Dynamic Views
(Динамические представления)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Позволяет  добавлять,   изменять   и   удалять   типыпредставлений данных

</TD>
</TR>
</TABLE>
&nbsp;<p>
<IMG src="gl13-11.jpg" alt="gl13-11.jpg" width="384" height="329"></IMG> </p>
<P>
Рис. 13.10. Вкладка Standard диалогового окнаComponent Gallery Options
</P>
<P>
Вкладка Standard (Стандартные) диалогового окна Component Gallery Options
(Параметры галереи компонентов) предназначена для настройки параметровокна Галереи компонентов. В области Global defaults (Общие установки)данной вкладки расположены флажки. Действия, выполняемые при установке этих флажков, описаны в табл. 13.4.
</P>
<P>
Таблица 13.4. Назначение флажков диалогового окна
</P>
<P>
Component Gallery Options
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Флажок

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Enable item renaming (Возможностьпереименования объекта)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Разрешается   изменять   имена  каталогов   иобъектов в окне Галереи компонентов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

FFC Builder Lock (Закреплениепостроителя)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Для объекта, помещаемого в форму, будетавтоматически запускаться построитель

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Drag and drop to desktop (Перенестии оставить на рабочем столе)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Объекты из Галереи компонентов можно переносить на Рабочий стол Visual FoxPro

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Advanced editing enabled
(Возможность дополнительногоредактирования)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

В диалоговое окно свойств Properties объектов Галереи  компонентов добавляются дополнительные вкладки Type, Scripts, Views иComments

</TD>
</TR>
</TABLE>
<P>
Переключатель Item default behavior (Действие объекта по умолчанию)вкладки Standard (Стандартные) позволяет определить, какое действие будетосуществляться при двойном щелчке на объекте Галереи компонентов. Еслиустановлена опция Modify item file (Модифицировать файл), при двойномщелчке на объекте автоматически запускается построитель для данного объекта. При установленной опции Run item file (Запускать файл) двойнойщелчок на объекте приводит к запуску объекта на выполнение.
</P>
<p>&nbsp;
<a NAME="10"></a><font size="4">Каталоги Галереи компонентов </font>
</P>
<P>
При первом открытии Галереи компонентов в левой части окна отображаются стандартные каталоги, содержащие объекты, которые будут полезныпри разработке приложений. Список стандартных каталогов Visual FoxProприведен в табл. 13.5.
</P>
<P>
Таблица 13.5. Назначение каталогов Галереи компонентов
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Каталог

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Назначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Visual FoxPro Catalog
{Каталог Visual FoxPro)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит базовые классы Visual FoxPro, шаблоны приложений, форм, отчетов, а также другие полезные дляразработки приложений средства

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Favorites (Избранное)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Предназначен для хранения наиболее важных объектов

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

My Base Classes
(Мои базовые классы)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит подклассы базовых классов Visual FoxPro

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

ActiveX Catalog (КаталогActiveX-компонентов)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Динамический каталог, содержащий зарегистрированные объекты ActiveX

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

World Wide Web
(Всемирная паутина)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит список адресов Web-страниц, &gt;икоторых вы найдете информацию о программных продуктах Microsoft

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Multimedia Catalog
(Каталог мультимедиа)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит список рисунков, звуков и видеоизображенийкоторые можно использовать в приложениях

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Visual FoxPro Samples
(Примеры Visual FoxPro)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Содержит примеры приложений, входящих в поставкуVisual FoxPro

</TD>
</TR>
</TABLE>
&nbsp;<P>
На вкладке Catalogs (Каталоги) (рис. 13.11) диалогового окна ComponentGallery 
Options (Параметры галереи компонентов) расположен список каталогово, входящих в 
Галерею компонентов. Используя кнопку New (Новый), в
этот список можно добавить новый каталог. Флажки, расположенные подкнопкой, определяют свойства выбранного в списке каталога.
</P>
<IMG src="gl13-13.jpg" alt="gl13-13.jpg" width="384" height="329"></IMG>
<P>
Рис. 13.11. Вкладка Catalogs диалогового окнаComponent Gallery Options
</P>
<p>&nbsp;
<a NAME="11"></a><font size="4">Представления данных </font>
</P>
<P>
На панели инструментов Галереи компонентов расположен раскрывающийся список View Type (Тип представления), содержащий по умолчанию несколько значений, управляющих видом отображения данных в окне. Используя вкладку Dynamic Views (Динамические представления) (рис. 13.12)диалогового окна Component Gallery Options (Параметры галереи компонентов), можно добавить в данный список дополнительные значения, изменитьили удалить значения, добавленные пользователями.
</P>
<P>
Чтобы добавить в список View Type (Тип представления) новое значение,выполните следующие действия:
</P>
<ol>
  <li>Нажмите кнопку Options (Параметры) на панели инструментов Галереикомпонентов. 
  </li>
  <li>Выберите вкладку Dynamic Views (Динамические представления). </li>
  <li>Нажмите кнопку New (Новый). </li>
  <li>В открывшемся диалоговом окне Edit View (Редактирование представления) введите параметры нового типа представления данных. 
  </li>
  <li>Нажмите кнопку Save (Сохранить). </li>
</ol>
<P>
Расположенные на вкладке Dynamic Views (Динамические представления)кнопки Edit 
(Редактировать) и Remove (Удалить) предназначены для изме
нения параметров типа представления данных и удаления представленияданных из списка соответственно.
</P>
<IMG src="gl13-14.jpg" alt="gl13-14.jpg" width="384" height="329"></IMG>
<P>
Рис. 13.12. Вкладка Dynamic Views диалогового окнаComponent Gallery Options
</P>
<p>&nbsp;
<a NAME="12"></a><font size="4">Работа с проектом из окнаГалереи компонентов </font>
</P>
<P>
В окне Галереи компонентов можно создавать новые проекты с помощьюшаблонов, построителей и мастеров. Для этого предназначен значок NewApplication (Новое приложение) каталога Catalogs (Каталоги).
</P>
<P>
При щелчке на значке New Application (Новое приложение) на экране появляется диалоговое окно Enter Project Name (Введите имя проекта), являющееся первым шагом в создании проекта (рис. 13.13).
</P>
<IMG src="gl13-15.jpg" alt="gl13-15.jpg" width="347" height="222"></IMG>
<P>
Рис. 13.13. Диалоговое окно Enter Project Name
</P>
<P>
Введите в поле Project name (Имя проекта) имя создаваемого проекта, а вполе Project file (Файл проекта) — его расположение. Используя флажок
Create project directory structure (Создать структуру каталогов проекта), можно указать, создавать ли для проекта структуру каталогов. При установкефлажка Add to Favorites catalog (Добавить в избранное) значок созданногопроекта будет добавлен в каталог Favorites (Избранное).
</P>
<P>
Установив в диалоговом окне Enter Project Name (Задать имя проекта) параметры, нажмите кнопку ОК для запуска мастера создания нового проекта.Кнопка Cancel (Отмена) позволяет отменить работу мастера.
</P>
<p>&nbsp;
<a NAME="13"></a><font size="4">Использование метода&quot;перенести-и-оставить&quot;для перемещения объектов
</font>
</P>
<P>
Объекты, расположенные в окне Галереи компонентов, можно переноситьна Рабочий стол Visual FoxPro, в открытый проект или форму. При этомперемещаемые в окно проекта объекты помещаются в соответствующие разделы окна конструктора проекта.
</P>
<P>
Чтобы переместить объект из Галереи компонентов с помощью метода&quot;перенести-и-оставить&quot;, выполните следующие действия:
</P>
<ol>
  <li>Выделите объект, который хотите перенести. Значок Move (Переместить), расположенный в верхнем левом углу окна Галереи компонентов, изменит свой рисунок в соответствии со значком выбранного вамиобъекта. 
  </li>
  <li>Установите курсор на значок Move (Переместить). </li>
  <li>Нажмите кнопку мыши и, удерживая ее нажатой, перенесите объект наРабочий стол, в проект или в форму. 
  </li>
  <li>Завершив перемещение, отпустите кнопку мыши. </li>
</ol>
<P>
В табл. 13.6 отображены все возможные результаты выполнения операции&quot;перенести-и-оставить&quot;, а назначение цифр — в табл. 13.7.
</P>
<P>
Таблица 13.6. Возможные результаты операции перемещения объектов
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Тип объекта

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Проект

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Форма

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Рабочий стол

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Объект

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Class   (   Classltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

6

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

File   (_FileItem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

URL   (_UrlItem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

1

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Form   (_FormItem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

9

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

11

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Report   (__ReportItem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

9

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

11

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Program   (   Programltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

11

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Menu ( Menultem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

10

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

11

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Image ( Imageltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

2

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

7

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

2

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Sound ( Soundltera)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

3

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Video ( Videoltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

3

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

ActiveX ( ActiveXItem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Data ( Dataltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

4

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Template ( Templateltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

5

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Catalog ( Catalogltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

8

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Sample ( Sampleltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Project ( Projectltem)

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

— </TD>
<TD ALIGN="LEFT" VALIGN="TOP">

11

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

—

</TD>
</TR>
</TABLE>
<P>
Таблица 13.7. Назначение цифр
</P>
<TABLE BORDER="1">
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

Цифра

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Обозначение

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

1

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет класс Hyperlink

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

2

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет класс Image или устанавливает свойства изображения

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

3

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет класс мультимедиа

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

4

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет класс таблицы Grid

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

5

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает новый файл и добавляет его в проект

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

6

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Создает объект на экране

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

7

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Устанавливает на Рабочем столе Visual FoxPro узор

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

8

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает новое окно Галереи компонентов с каталогом

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

9

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет класс кнопки для вызова формы или отчета

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

10

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Добавляет всплывающее меню в форму

</TD>
</TR>
<TR ALIGN="LEFT" VALIGN="TOP">
<TD ALIGN="LEFT" VALIGN="TOP">

11

</TD>
<TD ALIGN="LEFT" VALIGN="TOP">

Открывает конструктор для модификации

</TD>
</TR>
</TABLE>
<p>&nbsp;
<a NAME="14"></a><font size="4">Создание новой формыиз Галереи компонентов </font>
</P>
<P>
Из окна Галереи компонентов можно создавать новые и редактировать существующие формы.
</P>
<P>
Для создания новой формы можно воспользоваться одним из следующихспособов.
</P>
<ul>
  <li>Щелкнуть на шаблоне или выбрать пункт меню New Form (Новая форма)(рис. 13.14) из контекстного меню любого шаблона в папке Forms(Формы) Галереи компонентов. 
  </li>
  <li>Вызвать мастера форм с помощью щелчка мышью на значке Form Wizard(Мастер формы) (рис. 13.14) в папке Forms (Формы) Галереи компонентов. 
  </li>
</ul>
<IMG src="gl13-16.jpg" alt="gl13-16.jpg" width="500" height="463"></IMG>
<P>
Рис. 13.14. Каталог Галереи компонентов,из которого можно создавать новые формы
</P>
</BODY>
</HTML>